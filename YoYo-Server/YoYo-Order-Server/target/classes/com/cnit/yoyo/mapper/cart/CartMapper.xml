<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cnit.yoyo.dao.cart.CartMapper" >
  <resultMap id="BaseResultMap" type="com.cnit.yoyo.model.cart.Cart" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    <id column="cart_id" property="cartId" jdbcType="INTEGER" />
    <result column="member_id" property="memberId" jdbcType="INTEGER" />
    <result column="goods_id" property="goodsId" jdbcType="INTEGER" />
    <result column="product_id" property="productId" jdbcType="INTEGER" />
    <result column="company_id" property="companyId" jdbcType="INTEGER" />
    <result column="spec_value_id" property="specValueId" jdbcType="VARCHAR" />
    <result column="quantity" property="quantity" jdbcType="INTEGER" />
    <result column="time" property="time" jdbcType="INTEGER" />
    <result column="store_id" property="storeId" jdbcType="INTEGER" />
    <result column="appointment" property="appointment" jdbcType="VARCHAR" />
    <result column="appointment_index" property="appointmentIndex" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    cart_id, member_id, goods_id, product_id, company_id, store_id, spec_value_id, quantity, time
  </sql>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.cnit.yoyo.model.cart.CartExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_cart_objects
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    from t_cart_objects
    where cart_id = #{cartId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    delete from t_cart_objects
    where cart_id = #{cartId,jdbcType=INTEGER}
  </delete>
  <delete id="deleteByExample" parameterType="com.cnit.yoyo.model.cart.CartExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    delete from t_cart_objects
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.cnit.yoyo.model.cart.Cart" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    insert into t_cart_objects (cart_id, member_id, goods_id, 
      product_id, company_id, store_id, spec_value_id, 
      quantity, time,appointment,appointment_index)
    values (#{cartId,jdbcType=INTEGER}, #{memberId,jdbcType=INTEGER}, #{goodsId,jdbcType=INTEGER}, 
      #{productId,jdbcType=INTEGER}, #{companyId,jdbcType=INTEGER}, #{storeId,jdbcType=INTEGER}, #{specValueId,jdbcType=VARCHAR}, 
      #{quantity,jdbcType=INTEGER}, #{time,jdbcType=INTEGER},#{appointment},#{appointmentIndex})
  </insert>
  <insert id="insertSelective" parameterType="com.cnit.yoyo.model.cart.Cart" useGeneratedKeys="true" keyProperty="cart_id">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    insert into t_cart_objects
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <!-- <if test="cartId != null" >
        cart_id,
      </if> -->
      <if test="memberId != null" >
        member_id,
      </if>
      <if test="goodsId != null" >
        goods_id,
      </if>
      <if test="productId != null" >
        product_id,
      </if>
      <if test="companyId != null" >
        company_id,
      </if>
      <if test="storeId != null" >
        store_id,
      </if>
      <if test="specValueId != null" >
        spec_value_id,
      </if>
      <if test="quantity != null" >
        quantity,
      </if>
      <if test="time != null" >
        time,
      </if>
      <if test="appointment != null and appointment != ''">
      	appointment,
      </if>
      <if test="appointmentIndex != null and appointmentIndex != ''">
      	appointment_index,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <!-- <if test="cartId != null" >
        #{cartId,jdbcType=INTEGER},
      </if> -->
      <if test="memberId != null" >
        #{memberId,jdbcType=INTEGER},
      </if>
      <if test="goodsId != null" >
        #{goodsId,jdbcType=INTEGER},
      </if>
      <if test="productId != null" >
        #{productId,jdbcType=INTEGER},
      </if>
      <if test="companyId != null" >
        #{companyId,jdbcType=INTEGER},
      </if>
      <if test="storeId != null" >
        #{storeId,jdbcType=INTEGER},
      </if>
      <if test="specValueId != null" >
        #{specValueId,jdbcType=VARCHAR},
      </if>
      <if test="quantity != null" >
        #{quantity,jdbcType=INTEGER},
      </if>
      <if test="time != null" >
        #{time,jdbcType=INTEGER},
      </if>
      <if test="appointment != null and appointment !=''" >
        #{appointment,jdbcType=INTEGER},
      </if>
       <if test="appointmentIndex != null and appointmentIndex !=''" >
        #{appointmentIndex,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.cnit.yoyo.model.cart.CartExample" resultType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    select count(*) from t_cart_objects
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    update t_cart_objects
    <set >
      <if test="record.cartId != null" >
        cart_id = #{record.cartId,jdbcType=INTEGER},
      </if>
      <if test="record.memberId != null" >
        member_id = #{record.memberId,jdbcType=INTEGER},
      </if>
      <if test="record.goodsId != null" >
        goods_id = #{record.goodsId,jdbcType=INTEGER},
      </if>
      <if test="record.productId != null" >
        product_id = #{record.productId,jdbcType=INTEGER},
      </if>
      <if test="record.companyId != null" >
        company_id = #{record.companyId,jdbcType=INTEGER},
      </if>
      <if test="record.storeId != null" >
        company_id = #{record.storeId,jdbcType=INTEGER},
      </if>
      <if test="record.specValueId != null" >
        spec_value_id = #{record.specValueId,jdbcType=VARCHAR},
      </if>
      <if test="record.quantity != null" >
        quantity = #{record.quantity,jdbcType=INTEGER},
      </if>
      <if test="record.time != null" >
        time = #{record.time,jdbcType=INTEGER},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    update t_cart_objects
    set cart_id = #{record.cartId,jdbcType=INTEGER},
      member_id = #{record.memberId,jdbcType=INTEGER},
      goods_id = #{record.goodsId,jdbcType=INTEGER},
      product_id = #{record.productId,jdbcType=INTEGER},
      company_id = #{record.companyId,jdbcType=INTEGER},
      store_id = #{record.storeId,jdbcType=INTEGER},
      spec_value_id = #{record.specValueId,jdbcType=VARCHAR},
      quantity = #{record.quantity,jdbcType=INTEGER},
      time = #{record.time,jdbcType=INTEGER}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.cnit.yoyo.model.cart.Cart" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    update t_cart_objects
    <set >
      <if test="memberId != null" >
        member_id = #{memberId,jdbcType=INTEGER},
      </if>
      <if test="goodsId != null" >
        goods_id = #{goodsId,jdbcType=INTEGER},
      </if>
      <if test="productId != null" >
        product_id = #{productId,jdbcType=INTEGER},
      </if>
      <if test="companyId != null" >
        company_id = #{companyId,jdbcType=INTEGER},
      </if>
      <if test="storeId != null" >
        store_id = #{storeId,jdbcType=INTEGER},
      </if>
      <if test="specValueId != null" >
        spec_value_id = #{specValueId,jdbcType=VARCHAR},
      </if>
      <if test="quantity != null" >
        quantity = #{quantity,jdbcType=INTEGER},
      </if>
      <if test="time != null" >
        time = #{time,jdbcType=INTEGER},
      </if>
      <if test="appointment != null and appointment != ''">
      	appointment = #{appointment,jdbcType=INTEGER},
      </if>
      <if test="appointmentIndex != null and appointmentIndex != ''">
      	appointment_index = #{appointmentIndex,jdbcType=INTEGER},
      </if>
    </set>
    where cart_id = #{cartId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.cnit.yoyo.model.cart.Cart" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:14:22 CST 2015.
    -->
    update t_cart_objects
    set member_id = #{memberId,jdbcType=INTEGER},
      goods_id = #{goodsId,jdbcType=INTEGER},
      product_id = #{productId,jdbcType=INTEGER},
      company_id = #{companyId,jdbcType=INTEGER},
      store_id = #{storeId,jdbcType=INTEGER},
      spec_value_id = #{specValueId,jdbcType=VARCHAR},
      quantity = #{quantity,jdbcType=INTEGER},
      time = #{time,jdbcType=INTEGER}
    where cart_id = #{cartId,jdbcType=INTEGER}
  </update>
  
  <resultMap id="CartListResultMap" extends="BaseResultMap" type="com.cnit.yoyo.model.cart.dto.CartListDTO">
		<result column="COMPANY_NAME" jdbcType="VARCHAR" property="companyName" />
		<result column="STORE_NAME" jdbcType="VARCHAR" property="storeName" />
		<result column="NAME" jdbcType="VARCHAR" property="productName" />
		<result column="PRICE" jdbcType="DECIMAL" property="goodsPrice" />
		<result column="MID_PIC" jdbcType="VARCHAR" property="goodsImage" />
		<result column="STORE" jdbcType="DECIMAL" property="store" />
		<result column="BN" jdbcType="VARCHAR" property="bn" />
		<result column="COST" jdbcType="DECIMAL" property="cost" />
		<result column="WEIGHT" jdbcType="DECIMAL" property="weight" />
		<result column="SPEC_INFO" jdbcType="VARCHAR" property="specInfo" />
		<result column="GOODS_TYPE" jdbcType="VARCHAR" property="goodsType" />
		<result column="IDENTIFIER" jdbcType="VARCHAR" property="identifier" />
		<result column="SPEC_DESC" jdbcType="VARCHAR" property="specDesc" />
		<result column="SCORE" jdbcType="DECIMAL" property="score" />
		<result column="G_MARKETABLE" jdbcType="VARCHAR" property="gMarketable" />
		<result column="G_DISABLED" jdbcType="VARCHAR" property="gDisabled" />
		<result column="P_MARKETABLE" jdbcType="VARCHAR" property="pMarketable" />
		<result column="P_DISABLED" jdbcType="VARCHAR" property="pDisabled" />
		<result column="limit_goodsdown" property="limitGoodsdown" jdbcType="VARCHAR" />
		<result column="limit_store" property="limitStore" jdbcType="VARCHAR" />
		<result column="limit_storedown" property="limitStoredown" jdbcType="VARCHAR" />
		<result column="store_shopstatus" property="shopStatus" jdbcType="VARCHAR" />
		<result column="store_status" property="status" jdbcType="VARCHAR" />
		<result column="store_disabled" property="disabled" jdbcType="VARCHAR" />
		<result column="quantity" property="quantity" jdbcType="VARCHAR" />
		<result column="appointment" property="appointment" jdbcType="VARCHAR" />
		<result column="appointment_index" property="appointmentIndex" jdbcType="INTEGER" />
	</resultMap>
	<select id="selectCartListByAccountId" parameterType="INTEGER" resultMap="CartListResultMap">
		<!-- 关联查询 -->
	
		SELECT 
			C.CART_ID,
			C.MEMBER_ID,
			C.GOODS_ID,
			C.PRODUCT_ID,
			C.COMPANY_ID,
			C.SPEC_VALUE_ID,
			C.QUANTITY,
			C.TIME,
			C.appointment,
			COMP.company_NAME,
			P. NAME,
			(case when G.CAR_ID>0 then p.cost ELSE p.price end)as price,
			G.MID_PIC,
			P.STORE,
			P.BN,
			P.COST,
			P.WEIGHT,
			P.SPEC_INFO,
			P.SPEC_DESC,
			P.GOODS_TYPE,
			G.MARKETABLE AS G_MARKETABLE,
			G.DISABLED AS G_DISABLED,
			P.MARKETABLE AS P_MARKETABLE,
			P.DISABLED AS P_DISABLED,
			S.STORE_ID,
			S.STORE_NAME
		FROM T_CART_OBJECTS C
		LEFT JOIN T_COMPANY COMP ON C.company_id = COMP.company_id
		LEFT JOIN T_GOODS G ON C.GOODS_ID = G.GOODS_ID 
		LEFT JOIN T_PRODUCTS P ON C.product_id = P.product_id
		LEFT JOIN T_MEMBERS M ON C.MEMBER_ID = M.MEMBER_ID
		LEFT JOIN t_business_storemanger S ON g.store_id = S.STORE_ID 
		
		WHERE  M.ACCOUNT_ID=#{accountId}
	
		ORDER BY C.COMPANY_ID
	</select>
  
  
	  <update id="updateQuantityByProAndMem" parameterType="com.cnit.yoyo.model.cart.Cart" >
	    update t_cart_objects
	    set quantity = #{quantity,jdbcType=INTEGER}
	    where member_id=#{memberId,jdbcType=INTEGER} and product_id=#{productId,jdbcType=INTEGER}
	  </update>
	  
	  <select id="selectCartListByProIdList" parameterType="java.util.Map" resultMap="CartListResultMap">
		SELECT  	
			G.GOODS_ID,
			P.PRODUCT_ID,
			G.COMPANY_ID,
			COMP.COMPANY_NAME,
			P. NAME,			
			(case when G.CAR_ID>0 then p.cost ELSE p.price end)as price,
			G.MID_PIC,
			P.STORE,
			P.BN,
			P.COST,
			P.WEIGHT,
			P.SPEC_INFO,
			P.GOODS_TYPE,
			GC.IDENTIFIER,
			P.SPEC_DESC,
			G.SCORE,
			G.MARKETABLE AS G_MARKETABLE,
			G.DISABLED AS G_DISABLED,
			P.MARKETABLE AS P_MARKETABLE,
			P.DISABLED AS P_DISABLED,
			s.store_id,
			s.store_name,
			s.limit_goodsdown,
			s.limit_store,
			s.limit_storedown,
			s.shopstatus AS store_shopstatus,
			s. STATUS AS store_status,
			s.disabled AS store_disabled,
			cart.appointment,
			cart.appointment_index,
			cart.quantity
		FROM T_PRODUCTS P
		LEFT JOIN t_cart_objects cart ON p.product_id=cart.product_id
		left join t_goods g on p.goods_id = g.goods_id 
		left join T_COMPANY COMP on g.COMPANY_ID = COMP.company_id
		left join T_GOODS_CAT GC on GC.CAT_ID=G.CAT_ID
		left join t_business_storemanger s on s.store_id = if(substring_index(p.spec_desc,'|分店:',-1) = p.spec_desc or p.spec_desc is null or p.spec_desc ='', g.store_id, substring_index(substring_index(p.spec_desc,'|分店:',-1),'|',1))

		WHERE  P.PRODUCT_ID IN 
		<foreach item="item" index="index" collection="proIdList" open="(" separator="," close=")">
	    #{item}  
		</foreach>
		<if test="memberId!=null">
		AND cart.member_id=#{memberId}
		</if>
	
		ORDER BY G.COMPANY_ID
		
	  </select>
	  
	  <select id="selectCartListByProIdAndMem" resultMap="CartListResultMap">
		SELECT 
			C.*, P. NAME,			
			(case when G.CAR_ID>0 then p.cost ELSE p.price end)as price,
			P.STORE,
			P.BN,			
			P.WEIGHT,
			P.SPEC_INFO,
			p.spec_desc,
			P.GOODS_TYPE,
			P.MARKETABLE AS P_MARKETABLE,
			P.DISABLED AS P_DISABLED,
			G.MID_PIC,
			G.MARKETABLE AS G_MARKETABLE,
			G.DISABLED AS G_DISABLED,
			COMP.COMPANY_NAME,
			S.STORE_NAME,
			GC.IDENTIFIER
		FROM T_CART_OBJECTS C
		left join t_products p on c.product_id = p.product_id
		left join t_goods g on c.goods_id = g.goods_id
		left join t_company comp on comp.company_id= c.company_id
		left join t_business_storemanger s on c.store_id = s.store_id
		left join t_goods_cat gc on g.CAT_ID = gc.cat_id
		WHERE C.MEMBER_ID=#{memberId,jdbcType=INTEGER} AND P.PRODUCT_ID IN 
		<foreach item="item" index="index" collection="list" open="(" separator="," close=")">
	    	#{item}
		</foreach>
		ORDER BY C.COMPANY_ID
			
	  </select>
	  
	  <select id="selectHasAddCart" parameterType="com.cnit.yoyo.model.cart.Cart" resultMap="BaseResultMap">
		SELECT
			<include refid="Base_Column_List" />
		FROM
			t_cart_objects cart
		WHERE
			cart.member_id = ${memberId}
		<if test="goodsId != null">	
			AND cart.goods_id = ${goodsId}
		</if>
		<if test="goodsId != null">
			AND cart.product_id = ${productId}
		</if>
		<if test="companyId != null">
			AND cart.company_id = ${companyId}
		</if>
		<if test="storeId != null">
			AND cart.store_id = ${storeId}
		</if>
	  </select>
	  
	  <delete id="delectCartByProIdAndMemberId"  >
		   delete from t_cart_objects
		   where member_id = #{memberId} and product_id in 
		   <foreach item="item" index="index" collection="list" open="(" separator="," close=")">
		    	#{item}  
		   </foreach>
	  </delete>
	  
	  <resultMap type="com.cnit.yoyo.model.cart.dto.CartDTO" id="CartListResult">
	  	<result column="shop_name" property="store.shopName" jdbcType="VARCHAR" />
	  	<result column="store_name" property="store.storeName" jdbcType="VARCHAR" />
	  	<result column="STORE_ID" property="goods.companyId" jdbcType="INTEGER" />
	  	<result column="STORE_ID" property="store.storeId" jdbcType="INTEGER" />
	  	<result column="company_id" property="store.companyId" jdbcType="INTEGER" />
	  	<collection property="cartProducts" ofType="com.cnit.yoyo.model.cart.dto.CartProductDTO">
	  		<result column="goods_id" property="goodsId"/>
	  		<result column="product_id" property="productId"/>
	  		<result column="picture_path" property="picturePath"/>
	  		<result column="name" property="name"/>
	  		<result column="spec_info" property="specInfo"/>
	  		<result column="spec_desc" property="specDesc"/>
	  		<result column="price" property="price"/>
	  		<result column="mktprice" property="mktprice"/>
	  		<result column="disabled" property="disabled"/>
	  		<result column="marketable" property="marketable"/>
	  		<result column="quantity" property="quantity"/>
	  		<result column="store" property="store"/>
	  		<result column="appointment" property="appointment"/>
	  		<result column="appointment_index" property="appointmentIndex"/>
	  	</collection>
	  </resultMap>
	  
	  <select id="selectGoodsByProductIds" parameterType="java.util.Map" resultMap="CartListResult">
	  	SELECT
			store.shop_name,
			store.store_name,
			store.company_id,
			store.STORE_ID,
			product.goods_id,
			product.product_id,
			product.picture_path,
			product.`name`,
			product.spec_desc,
			product.spec_info,
			(case when goods.CAR_ID>0 then product.cost ELSE product.price end)as price,
			product.store,
			product.mktprice,
			product.disabled,
			product.marketable
		FROM
			t_business_storemanger store
		LEFT JOIN t_goods goods ON goods.STORE_ID = store.store_id
		LEFT JOIN t_products product ON product.goods_id = goods.GOODS_ID
		WHERE product.product_id IN 
		<foreach item="item" index="index" collection="productIds" open="(" separator="," close=")">
	    	#{item}  
	   </foreach>
	  </select>
	  
	  <select id="selectMemberCart" parameterType="java.util.Map" resultMap="CartListResult">
	  	SELECT
			store.shop_name,
			store.store_name,
			store.company_id,
			store.STORE_ID,
			product.goods_id,
			product.product_id,
			product.picture_path,
			product.`name`,
			product.spec_desc,
			product.spec_info,
			(case when goods.CAR_ID>0 then product.cost ELSE product.price end)as price,
			product.mktprice,
			product.disabled,
			product.marketable,
			product.store,
			cart.quantity,
			cart.appointment,
			cart.appointment_index
		FROM
			t_business_storemanger store
		LEFT JOIN t_goods goods ON goods.STORE_ID = store.store_id
		LEFT JOIN t_products product ON product.goods_id = goods.GOODS_ID
		LEFT JOIN t_cart_objects cart ON cart.product_id=product.product_id
		WHERE cart.member_id=${memberId}
		<if test="productIds != null">
		AND product.product_id IN <foreach item="item" index="index" collection="productIds" open="(" separator="," close=")">#{item}</foreach>
	   </if>
	  </select>
</mapper>
