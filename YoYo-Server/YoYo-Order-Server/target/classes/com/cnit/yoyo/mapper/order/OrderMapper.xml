<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cnit.yoyo.dao.order.OrderMapper">
  <resultMap id="BaseResultMap" type="com.cnit.yoyo.model.order.Order">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 13 16:49:11 CST 2015.
    -->
    <id column="order_id" jdbcType="BIGINT" property="orderId" />
    <result column="company_id" jdbcType="BIGINT" property="companyId" />
    <result column="store_id" jdbcType="BIGINT" property="storeId" />
    <result column="MEMBER_ID" jdbcType="INTEGER" property="memberId" />
    <result column="total_amount" jdbcType="DECIMAL" property="totalAmount" />
    <result column="final_amount" jdbcType="DECIMAL" property="finalAmount" />
    <result column="ship_status" jdbcType="VARCHAR" property="shipStatus" />
    <result column="pay_status" jdbcType="VARCHAR" property="payStatus" />
    <result column="is_delivery" jdbcType="VARCHAR" property="isDelivery" />
    <result column="discount_value" jdbcType="DECIMAL" property="discountValue" />
    <result column="createtime" jdbcType="TIMESTAMP" property="createtime" />
    <result column="last_modified" jdbcType="TIMESTAMP" property="lastModified" />
    <result column="payment" jdbcType="VARCHAR" property="payment" />
    <result column="payment_id" jdbcType="INTEGER" property="paymentId" />
    <result column="shipping" jdbcType="VARCHAR" property="shipping" />
    <result column="status" jdbcType="VARCHAR" property="status" />
    <result column="confirm" jdbcType="VARCHAR" property="confirm" />
    <result column="ship_area" jdbcType="VARCHAR" property="shipArea" />
    <result column="ship_name" jdbcType="VARCHAR" property="shipName" />
    <result column="weight" jdbcType="DECIMAL" property="weight" />
    <result column="tostr" jdbcType="VARCHAR" property="tostr" />
    <result column="itemnum" jdbcType="INTEGER" property="itemnum" />
    <result column="ip" jdbcType="VARCHAR" property="ip" />
    <result column="ship_addr" jdbcType="VARCHAR" property="shipAddr" />
    <result column="ship_zip" jdbcType="VARCHAR" property="shipZip" />
    <result column="ship_tel" jdbcType="VARCHAR" property="shipTel" />
    <result column="ship_email" jdbcType="VARCHAR" property="shipEmail" />
    <result column="ship_time" jdbcType="VARCHAR" property="shipTime" />
    <result column="ship_mobile" jdbcType="VARCHAR" property="shipMobile" />
    <result column="cost_item" jdbcType="DECIMAL" property="costItem" />
    <result column="is_coupons" jdbcType="INTEGER" property="isCoupons" />
    <result column="cost_tax" jdbcType="DECIMAL" property="costTax" />
    <result column="tax_company" jdbcType="VARCHAR" property="taxCompany" />
    <result column="is_protect" jdbcType="VARCHAR" property="isProtect" />
    <result column="cost_protect" jdbcType="DECIMAL" property="costProtect" />
    <result column="cost_payment" jdbcType="DECIMAL" property="costPayment" />
    <result column="currency" jdbcType="VARCHAR" property="currency" />
    <result column="cur_rate" jdbcType="DECIMAL" property="curRate" />
    <result column="score_u" jdbcType="DECIMAL" property="scoreU" />
    <result column="score_g" jdbcType="DECIMAL" property="scoreG" />
    <result column="discount" jdbcType="DECIMAL" property="discount" />
    <result column="pmt_goods" jdbcType="DECIMAL" property="pmtGoods" />
    <result column="pmt_order" jdbcType="DECIMAL" property="pmtOrder" />
    <result column="payed" jdbcType="DECIMAL" property="payed" />
    <result column="memo" jdbcType="VARCHAR" property="memo" />
    <result column="disabled" jdbcType="VARCHAR" property="disabled" />
    <result column="mark_type" jdbcType="VARCHAR" property="markType" />
    <result column="mark_text" jdbcType="VARCHAR" property="markText" />
    <result column="cost_freight" jdbcType="DECIMAL" property="costFreight" />
    <result column="extend" jdbcType="VARCHAR" property="extend" />
    <result column="order_refer" jdbcType="VARCHAR" property="orderRefer" />
    <result column="addon" jdbcType="VARCHAR" property="addon" />
    <result column="source" jdbcType="VARCHAR" property="source" />
    <result column="confirm_time" jdbcType="TIMESTAMP" property="confirmTime" />
    <result column="comments_count" jdbcType="INTEGER" property="commentsCount" />
    <result column="refund_status" jdbcType="VARCHAR" property="refundStatus" />
    <result column="act_id" jdbcType="INTEGER" property="actId" />
    <result column="order_type" jdbcType="VARCHAR" property="orderType" />
    <result column="is_extend" jdbcType="VARCHAR" property="isExtend" />
    <result column="order_kind" jdbcType="VARCHAR" property="orderKind" />
    <result column="parent_order_id" jdbcType="BIGINT" property="parentOrderId" />
    <result column="is_display" jdbcType="INTEGER" property="isDisplay" />
	
  </resultMap>
  
  <resultMap id="DTOResultMap" type="com.cnit.yoyo.model.order.dto.OrderDTO" extends="BaseResultMap">
        <result column="memberName" jdbcType="VARCHAR" property="memeberName" />
        <result column="shopName" jdbcType="VARCHAR" property="shopName" />
        <result column="MOBILE" jdbcType="VARCHAR" property="memeberPhone" />
        <result column="payObject" jdbcType="INTEGER" property="payObject" />
  </resultMap>
  
  <resultMap id="DTODetailMap" type="com.cnit.yoyo.model.order.dto.OrderDetailDTO" extends="BaseResultMap">
  		<result column="LOGIN_NAME" jdbcType="VARCHAR" property="loginName" />
        <result column="memberName" jdbcType="VARCHAR" property="memeberName" />
        <result column="MOBILE" jdbcType="VARCHAR" property="memeberPhone" />
        <result column="AREA" jdbcType="VARCHAR" property="area" />
        <result column="EMAIL" jdbcType="VARCHAR" property="email" />
        <result column="memo" jdbcType="VARCHAR" property="memo" />
        <result column="mark_text" jdbcType="VARCHAR" property="markText" />
        <result column="remark" jdbcType="VARCHAR" property="remark" />
        <!-- <collection property="orderitems" ofType="com.cnit.yoyo.model.order.OrderItems">  
		    <id column="item_id" property="itemId" jdbcType="INTEGER" />
		    <result column="product_id" property="productId" jdbcType="INTEGER" />
		    <result column="name" property="name" jdbcType="VARCHAR" />
		    <result column="price" property="price" jdbcType="DECIMAL" />
		    <result column="amount" property="amount" jdbcType="DECIMAL" />
		    <result column="nums" property="nums" jdbcType="REAL" />
		    <result column="sendnum" property="sendnum" jdbcType="REAL" />
      </collection>  -->
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 13 16:49:11 CST 2015.
    -->
    order_id, company_id, store_id, MEMBER_ID, total_amount, final_amount, pay_status,ship_status, 
    is_delivery, discount_value, createtime, last_modified, payment, payment_id, 
    shipping, status, confirm, ship_area, ship_name, weight, tostr, itemnum, ip, ship_addr, 
    ship_zip, ship_tel, ship_email, ship_time, ship_mobile, cost_item, is_coupons, cost_tax, 
    tax_company, is_protect, cost_protect, cost_payment, currency, cur_rate, score_u, 
    score_g, discount, pmt_goods, pmt_order, payed, memo, disabled, mark_type, mark_text, 
    cost_freight, extend, order_refer, addon, source, confirm_time, comments_count, refund_status, 
    act_id, order_type, is_extend, order_kind,parent_order_id
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 13 16:49:11 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    from t_orders
    where order_id = #{orderId,jdbcType=BIGINT}
  </select>
  
  <select id="selectCountByPrimaryKey" parameterType="java.lang.Long" resultType="java.lang.Integer">
    select count(order_id) from t_orders
    where order_id = #{orderId,jdbcType=BIGINT}
  </select>
  
  <select id="selectOrderByParam" parameterType="map" resultMap="DTOResultMap">
    SELECT
	t_orders.last_modified,
	t_orders.`status`,
	t_orders.mark_text,
	t_orders.order_id,
	<!-- t_members.`NAME` as memberName,
	case when t_company.shop_name is not null then t_company.shop_name
	else (select t_business_storemanger.shop_name from t_business_storemanger where t_business_storemanger.store_id = t_orders.store_id) 
	end as shopName,
	t_members.MOBILE,
	t_order_bills.pay_object, -->
	t_orders.createtime,
	t_orders.pay_status,
	t_orders.payment,
	t_orders.order_type,
	t_orders.source,
	t_orders.refund_status,
	t_orders.final_amount
	FROM
	t_orders
	<!-- JOIN t_members ON t_orders.MEMBER_ID = t_members.MEMBER_ID
	JOIN t_company ON t_company.company_id = t_orders.company_id
	JOIN t_order_bills ON t_order_bills.order_id = t_orders.order_id -->
	where t_orders.disabled='0' and t_orders.is_display=1 
        <if test="orderId != null and orderId !='' and orderId !=-1">  
            and t_orders.order_id = #{orderId}  
        </if>  
        <if test="payStatus != null and payStatus !='' and payStatus !='-1' ">  
            and t_orders.pay_status = #{payStatus}  
        </if> 
        <if test="status != null and status !='' and status !='-1' ">  
            and t_orders.status = #{status}  
        </if> 
        <if test="shipStatusQ != null and shipStatusQ !='' and shipStatusQ !='-1' ">  
            and t_orders.ship_status = #{shipStatusQ}  
        </if> 
        <if test="payment != null and payment !='' and payment !='-1' ">  
            and t_orders.payment = #{payment}  
        </if>
        <if test="orderType != null and orderType !='' and orderType !='-1' ">  
            and t_orders.order_type = #{orderType,jdbcType=VARCHAR}  
        </if>
        <if test="source != null and source !='' and source !='-1' ">  
            and t_orders.source = #{source,jdbcType=VARCHAR}  
        </if>
        <if test="refundStatus != null and refundStatus !='' and refundStatus !='-1' ">  
            and t_orders.refund_status = #{refundStatus}  
        </if>
         <!-- 排序规则 -->
		<if test="orderStmt != null">
			ORDER BY ${orderStmt}
		</if>
  </select>
  
    <select id="selectOrderDetail" parameterType="java.lang.Long" resultMap="DTODetailMap">
    SELECT
	t_orders.order_id,
	t_orders.cost_item,
	t_orders.final_amount,
	t_orders.cost_payment,
	t_orders.weight,
	t_orders.payment,
	t_orders.score_g,
	t_orders.memo,
	t_orders.mark_text,
	t_pam_account.LOGIN_NAME,
	t_members.`NAME` as memeberName,
	t_members.MOBILE,
	t_members.AREA,
	t_members.EMAIL,
	t_members.remark
	FROM
	t_orders
	JOIN t_members ON t_members.MEMBER_ID = t_orders.MEMBER_ID
	JOIN t_pam_account ON t_members.ACCOUNT_ID = t_pam_account.ACCOUNT_ID
    where t_orders.order_id = #{orderId,jdbcType=BIGINT}
  </select>
  
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 13 16:49:11 CST 2015.
    -->
    delete from t_orders
    where order_id = #{orderId,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.cnit.yoyo.model.order.Order">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 13 16:49:11 CST 2015.
    -->
    insert into t_orders (order_id, company_id, store_id, 
      MEMBER_ID, total_amount, final_amount, 
      pay_status, is_delivery, 
      discount_value, createtime, last_modified, 
      payment, payment_id, shipping, 
      status, confirm, ship_area, 
      ship_name, weight, tostr, 
      itemnum, ip, ship_addr, 
      ship_zip, ship_tel, ship_email, 
      ship_time, ship_mobile, cost_item, 
      is_coupons, cost_tax, tax_company, 
      is_protect, cost_protect, cost_payment, 
      currency, cur_rate, score_u, 
      score_g, discount, pmt_goods, 
      pmt_order, payed, memo, 
      disabled, mark_type, mark_text, 
      cost_freight, extend, order_refer, 
      addon, source, confirm_time, 
      comments_count, refund_status, act_id, 
      order_type, is_extend, order_kind
      )
    values (#{orderId,jdbcType=BIGINT}, #{companyId,jdbcType=BIGINT}, #{storeId,jdbcType=BIGINT}, 
      #{memberId,jdbcType=INTEGER}, #{totalAmount,jdbcType=DECIMAL}, #{finalAmount,jdbcType=DECIMAL}, 
      #{payStatus,jdbcType=VARCHAR}, #{isDelivery,jdbcType=VARCHAR}, 
      #{discountValue,jdbcType=DECIMAL}, #{createtime,jdbcType=TIMESTAMP}, #{lastModified,jdbcType=TIMESTAMP}, 
      #{payment,jdbcType=VARCHAR}, #{paymentId,jdbcType=INTEGER}, #{shipping,jdbcType=VARCHAR}, 
      #{status,jdbcType=VARCHAR}, #{confirm,jdbcType=VARCHAR}, #{shipArea,jdbcType=VARCHAR}, 
      #{shipName,jdbcType=VARCHAR}, #{weight,jdbcType=DECIMAL}, #{tostr,jdbcType=VARCHAR}, 
      #{itemnum,jdbcType=INTEGER}, #{ip,jdbcType=VARCHAR}, #{shipAddr,jdbcType=VARCHAR}, 
      #{shipZip,jdbcType=VARCHAR}, #{shipTel,jdbcType=VARCHAR}, #{shipEmail,jdbcType=VARCHAR}, 
      #{shipTime,jdbcType=VARCHAR}, #{shipMobile,jdbcType=VARCHAR}, #{costItem,jdbcType=DECIMAL}, 
      #{isCoupons,jdbcType=INTEGER}, #{costTax,jdbcType=DECIMAL}, #{taxCompany,jdbcType=VARCHAR}, 
      #{isProtect,jdbcType=VARCHAR}, #{costProtect,jdbcType=DECIMAL}, #{costPayment,jdbcType=DECIMAL}, 
      #{currency,jdbcType=VARCHAR}, #{curRate,jdbcType=DECIMAL}, #{scoreU,jdbcType=DECIMAL}, 
      #{scoreG,jdbcType=DECIMAL}, #{discount,jdbcType=DECIMAL}, #{pmtGoods,jdbcType=DECIMAL}, 
      #{pmtOrder,jdbcType=DECIMAL}, #{payed,jdbcType=DECIMAL}, #{memo,jdbcType=VARCHAR}, 
      #{disabled,jdbcType=VARCHAR}, #{markType,jdbcType=VARCHAR}, #{markText,jdbcType=VARCHAR}, 
      #{costFreight,jdbcType=DECIMAL}, #{extend,jdbcType=VARCHAR}, #{orderRefer,jdbcType=VARCHAR}, 
      #{addon,jdbcType=VARCHAR}, #{source,jdbcType=VARCHAR}, #{confirmTime,jdbcType=TIMESTAMP}, 
      #{commentsCount,jdbcType=INTEGER}, #{refundStatus,jdbcType=VARCHAR}, #{actId,jdbcType=INTEGER}, 
      #{orderType,jdbcType=VARCHAR}, #{isExtend,jdbcType=VARCHAR}, #{orderKind,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.cnit.yoyo.model.order.Order"  useGeneratedKeys="true" keyProperty="orderId">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 13 16:49:11 CST 2015.
    -->
    insert into t_orders
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="orderId != null">
        order_id,
      </if>
      <if test="companyId != null">
        company_id,
      </if>
      <if test="storeId != null">
        store_id,
      </if>
      <if test="memberId != null">
        MEMBER_ID,
      </if>
      <if test="totalAmount != null">
        total_amount,
      </if>
      <if test="finalAmount != null">
        final_amount,
      </if>
      <if test="payStatus != null">
        pay_status,
      </if>
      <if test="isDelivery != null">
        is_delivery,
      </if>
      <if test="discountValue != null">
        discount_value,
      </if>
      <if test="createtime != null">
        createtime,
      </if>
      <if test="lastModified != null">
        last_modified,
      </if>
      <if test="payment != null">
        payment,
      </if>
      <if test="paymentId != null">
        payment_id,
      </if>
      <if test="shipping != null">
        shipping,
      </if>
      <if test="status != null">
        status,
      </if>
      <if test="confirm != null">
        confirm,
      </if>
      <if test="shipArea != null">
        ship_area,
      </if>
      <if test="shipName != null">
        ship_name,
      </if>
      <if test="weight != null">
        weight,
      </if>
      <if test="tostr != null">
        tostr,
      </if>
      <if test="itemnum != null">
        itemnum,
      </if>
      <if test="ip != null">
        ip,
      </if>
      <if test="shipAddr != null">
        ship_addr,
      </if>
      <if test="shipZip != null">
        ship_zip,
      </if>
      <if test="shipTel != null">
        ship_tel,
      </if>
      <if test="shipEmail != null">
        ship_email,
      </if>
      <if test="shipTime != null">
        ship_time,
      </if>
      <if test="shipMobile != null">
        ship_mobile,
      </if>
      <if test="costItem != null">
        cost_item,
      </if>
      <if test="isCoupons != null">
        is_coupons,
      </if>
      <if test="costTax != null">
        cost_tax,
      </if>
      <if test="taxCompany != null">
        tax_company,
      </if>
      <if test="isProtect != null">
        is_protect,
      </if>
      <if test="costProtect != null">
        cost_protect,
      </if>
      <if test="costPayment != null">
        cost_payment,
      </if>
      <if test="currency != null">
        currency,
      </if>
      <if test="curRate != null">
        cur_rate,
      </if>
      <if test="scoreU != null">
        score_u,
      </if>
      <if test="scoreG != null">
        score_g,
      </if>
      <if test="discount != null">
        discount,
      </if>
      <if test="pmtGoods != null">
        pmt_goods,
      </if>
      <if test="pmtOrder != null">
        pmt_order,
      </if>
      <if test="payed != null">
        payed,
      </if>
      <if test="memo != null">
        memo,
      </if>
      <if test="disabled != null">
        disabled,
      </if>
      <if test="markType != null">
        mark_type,
      </if>
      <if test="markText != null">
        mark_text,
      </if>
      <if test="costFreight != null">
        cost_freight,
      </if>
      <if test="extend != null">
        extend,
      </if>
      <if test="orderRefer != null">
        order_refer,
      </if>
      <if test="addon != null">
        addon,
      </if>
      <if test="source != null">
        source,
      </if>
      <if test="confirmTime != null">
        confirm_time,
      </if>
      <if test="commentsCount != null">
        comments_count,
      </if>
      <if test="refundStatus != null">
        refund_status,
      </if>
      <if test="actId != null">
        act_id,
      </if>
      <if test="orderType != null">
        order_type,
      </if>
      <if test="isExtend != null">
        is_extend,
      </if>
      <if test="orderKind != null">
        order_kind,
      </if>
      <if test="parentOrderId != null">
        parent_order_id,
      </if>
      <if test="isDisplay != null">
        is_display,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="orderId != null">
        #{orderId,jdbcType=BIGINT},
      </if>
      <if test="companyId != null">
        #{companyId,jdbcType=BIGINT},
      </if>
      <if test="storeId != null">
        #{storeId,jdbcType=BIGINT},
      </if>
      <if test="memberId != null">
        #{memberId,jdbcType=INTEGER},
      </if>
      <if test="totalAmount != null">
        #{totalAmount,jdbcType=DECIMAL},
      </if>
      <if test="finalAmount != null">
        #{finalAmount,jdbcType=DECIMAL},
      </if>
      <if test="payStatus != null">
        #{payStatus,jdbcType=VARCHAR},
      </if>
      
      <if test="isDelivery != null">
        #{isDelivery,jdbcType=VARCHAR},
      </if>
      <if test="discountValue != null">
        #{discountValue,jdbcType=DECIMAL},
      </if>
      <if test="createtime != null">
        #{createtime,jdbcType=TIMESTAMP},
      </if>
      <if test="lastModified != null">
        #{lastModified,jdbcType=TIMESTAMP},
      </if>
      <if test="payment != null">
        #{payment,jdbcType=VARCHAR},
      </if>
      <if test="paymentId != null">
        #{paymentId,jdbcType=INTEGER},
      </if>
      <if test="shipping != null">
        #{shipping,jdbcType=VARCHAR},
      </if>
      <if test="status != null">
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="confirm != null">
        #{confirm,jdbcType=VARCHAR},
      </if>
      <if test="shipArea != null">
        #{shipArea,jdbcType=VARCHAR},
      </if>
      <if test="shipName != null">
        #{shipName,jdbcType=VARCHAR},
      </if>
      <if test="weight != null">
        #{weight,jdbcType=DECIMAL},
      </if>
      <if test="tostr != null">
        #{tostr,jdbcType=VARCHAR},
      </if>
      <if test="itemnum != null">
        #{itemnum,jdbcType=INTEGER},
      </if>
      <if test="ip != null">
        #{ip,jdbcType=VARCHAR},
      </if>
      <if test="shipAddr != null">
        #{shipAddr,jdbcType=VARCHAR},
      </if>
      <if test="shipZip != null">
        #{shipZip,jdbcType=VARCHAR},
      </if>
      <if test="shipTel != null">
        #{shipTel,jdbcType=VARCHAR},
      </if>
      <if test="shipEmail != null">
        #{shipEmail,jdbcType=VARCHAR},
      </if>
      <if test="shipTime != null">
        #{shipTime,jdbcType=VARCHAR},
      </if>
      <if test="shipMobile != null">
        #{shipMobile,jdbcType=VARCHAR},
      </if>
      <if test="costItem != null">
        #{costItem,jdbcType=DECIMAL},
      </if>
      <if test="isCoupons != null">
        #{isCoupons,jdbcType=INTEGER},
      </if>
      <if test="costTax != null">
        #{costTax,jdbcType=DECIMAL},
      </if>
      <if test="taxCompany != null">
        #{taxCompany,jdbcType=VARCHAR},
      </if>
      <if test="isProtect != null">
        #{isProtect,jdbcType=VARCHAR},
      </if>
      <if test="costProtect != null">
        #{costProtect,jdbcType=DECIMAL},
      </if>
      <if test="costPayment != null">
        #{costPayment,jdbcType=DECIMAL},
      </if>
      <if test="currency != null">
        #{currency,jdbcType=VARCHAR},
      </if>
      <if test="curRate != null">
        #{curRate,jdbcType=DECIMAL},
      </if>
      <if test="scoreU != null">
        #{scoreU,jdbcType=DECIMAL},
      </if>
      <if test="scoreG != null">
        #{scoreG,jdbcType=DECIMAL},
      </if>
      <if test="discount != null">
        #{discount,jdbcType=DECIMAL},
      </if>
      <if test="pmtGoods != null">
        #{pmtGoods,jdbcType=DECIMAL},
      </if>
      <if test="pmtOrder != null">
        #{pmtOrder,jdbcType=DECIMAL},
      </if>
      <if test="payed != null">
        #{payed,jdbcType=DECIMAL},
      </if>
      <if test="memo != null">
        #{memo,jdbcType=VARCHAR},
      </if>
      <if test="disabled != null">
        #{disabled,jdbcType=VARCHAR},
      </if>
      <if test="markType != null">
        #{markType,jdbcType=VARCHAR},
      </if>
      <if test="markText != null">
        #{markText,jdbcType=VARCHAR},
      </if>
      <if test="costFreight != null">
        #{costFreight,jdbcType=DECIMAL},
      </if>
      <if test="extend != null">
        #{extend,jdbcType=VARCHAR},
      </if>
      <if test="orderRefer != null">
        #{orderRefer,jdbcType=VARCHAR},
      </if>
      <if test="addon != null">
        #{addon,jdbcType=VARCHAR},
      </if>
      <if test="source != null">
        #{source,jdbcType=VARCHAR},
      </if>
      <if test="confirmTime != null">
        #{confirmTime,jdbcType=TIMESTAMP},
      </if>
      <if test="commentsCount != null">
        #{commentsCount,jdbcType=INTEGER},
      </if>
      <if test="refundStatus != null">
        #{refundStatus,jdbcType=VARCHAR},
      </if>
      <if test="actId != null">
        #{actId,jdbcType=INTEGER},
      </if>
      <if test="orderType != null">
        #{orderType,jdbcType=VARCHAR},
      </if>
      <if test="isExtend != null">
        #{isExtend,jdbcType=VARCHAR},
      </if>
      <if test="orderKind != null">
        #{orderKind,jdbcType=VARCHAR},
      </if>
      <if test="parentOrderId != null">
        #{parentOrderId,jdbcType=VARCHAR},
      </if>
      <if test="isDisplay != null">
        #{isDisplay,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.cnit.yoyo.model.order.Order">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 13 16:49:11 CST 2015.
    -->
    update t_orders
    <set>
      <if test="companyId != null">
        company_id = #{companyId,jdbcType=BIGINT},
      </if>
      <if test="storeId != null">
        store_id = #{storeId,jdbcType=BIGINT},
      </if>
      <if test="memberId != null">
        MEMBER_ID = #{memberId,jdbcType=INTEGER},
      </if>
      <if test="totalAmount != null">
        total_amount = #{totalAmount,jdbcType=DECIMAL},
      </if>
      <if test="finalAmount != null">
        final_amount = #{finalAmount,jdbcType=DECIMAL},
      </if>
      <if test="payStatus != null">
        pay_status = #{payStatus,jdbcType=VARCHAR},
      </if>
      <if test="isDelivery != null">
        is_delivery = #{isDelivery,jdbcType=VARCHAR},
      </if>
      <if test="discountValue != null">
        discount_value = #{discountValue,jdbcType=DECIMAL},
      </if>
      <if test="createtime != null">
        createtime = #{createtime,jdbcType=TIMESTAMP},
      </if>
      <if test="lastModified != null">
        last_modified = #{lastModified,jdbcType=TIMESTAMP},
      </if>
      <if test="payment != null">
        payment = #{payment,jdbcType=VARCHAR},
      </if>
      <if test="paymentId != null">
        payment_id = #{paymentId,jdbcType=INTEGER},
      </if>
      <if test="shipping != null">
        shipping = #{shipping,jdbcType=VARCHAR},
      </if>
      <if test="status != null">
        status = #{status,jdbcType=VARCHAR},
      </if>
      <if test="confirm != null">
        confirm = #{confirm,jdbcType=VARCHAR},
      </if>
      <if test="shipArea != null">
        ship_area = #{shipArea,jdbcType=VARCHAR},
      </if>
      <if test="shipName != null">
        ship_name = #{shipName,jdbcType=VARCHAR},
      </if>
      <if test="weight != null">
        weight = #{weight,jdbcType=DECIMAL},
      </if>
      <if test="tostr != null">
        tostr = #{tostr,jdbcType=VARCHAR},
      </if>
      <if test="itemnum != null">
        itemnum = #{itemnum,jdbcType=INTEGER},
      </if>
      <if test="ip != null">
        ip = #{ip,jdbcType=VARCHAR},
      </if>
      <if test="shipAddr != null">
        ship_addr = #{shipAddr,jdbcType=VARCHAR},
      </if>
      <if test="shipZip != null">
        ship_zip = #{shipZip,jdbcType=VARCHAR},
      </if>
      <if test="shipTel != null">
        ship_tel = #{shipTel,jdbcType=VARCHAR},
      </if>
      <if test="shipEmail != null">
        ship_email = #{shipEmail,jdbcType=VARCHAR},
      </if>
      <if test="shipTime != null">
        ship_time = #{shipTime,jdbcType=VARCHAR},
      </if>
      <if test="shipMobile != null">
        ship_mobile = #{shipMobile,jdbcType=VARCHAR},
      </if>
      <if test="costItem != null">
        cost_item = #{costItem,jdbcType=DECIMAL},
      </if>
      <if test="isCoupons != null">
        is_coupons = #{isCoupons,jdbcType=INTEGER},
      </if>
      <if test="costTax != null">
        cost_tax = #{costTax,jdbcType=DECIMAL},
      </if>
      <if test="taxCompany != null">
        tax_company = #{taxCompany,jdbcType=VARCHAR},
      </if>
      <if test="isProtect != null">
        is_protect = #{isProtect,jdbcType=VARCHAR},
      </if>
      <if test="costProtect != null">
        cost_protect = #{costProtect,jdbcType=DECIMAL},
      </if>
      <if test="costPayment != null">
        cost_payment = #{costPayment,jdbcType=DECIMAL},
      </if>
      <if test="currency != null">
        currency = #{currency,jdbcType=VARCHAR},
      </if>
      <if test="curRate != null">
        cur_rate = #{curRate,jdbcType=DECIMAL},
      </if>
      <if test="scoreU != null">
        score_u = #{scoreU,jdbcType=DECIMAL},
      </if>
      <if test="scoreG != null">
        score_g = #{scoreG,jdbcType=DECIMAL},
      </if>
      <if test="discount != null">
        discount = #{discount,jdbcType=DECIMAL},
      </if>
      <if test="pmtGoods != null">
        pmt_goods = #{pmtGoods,jdbcType=DECIMAL},
      </if>
      <if test="pmtOrder != null">
        pmt_order = #{pmtOrder,jdbcType=DECIMAL},
      </if>
      <if test="payed != null">
        payed = #{payed,jdbcType=DECIMAL},
      </if>
      <if test="memo != null">
        memo = #{memo,jdbcType=VARCHAR},
      </if>
      <if test="disabled != null">
        disabled = #{disabled,jdbcType=VARCHAR},
      </if>
      <if test="markType != null">
        mark_type = #{markType,jdbcType=VARCHAR},
      </if>
      <if test="markText != null">
        mark_text = #{markText,jdbcType=VARCHAR},
      </if>
      <if test="costFreight != null">
        cost_freight = #{costFreight,jdbcType=DECIMAL},
      </if>
      <if test="extend != null">
        extend = #{extend,jdbcType=VARCHAR},
      </if>
      <if test="orderRefer != null">
        order_refer = #{orderRefer,jdbcType=VARCHAR},
      </if>
      <if test="addon != null">
        addon = #{addon,jdbcType=VARCHAR},
      </if>
      <if test="source != null">
        source = #{source,jdbcType=VARCHAR},
      </if>
      <if test="confirmTime != null">
        confirm_time = #{confirmTime,jdbcType=TIMESTAMP},
      </if>
      <if test="commentsCount != null">
        comments_count = #{commentsCount,jdbcType=INTEGER},
      </if>
      <if test="refundStatus != null">
        refund_status = #{refundStatus,jdbcType=VARCHAR},
      </if>
      <if test="actId != null">
        act_id = #{actId,jdbcType=INTEGER},
      </if>
      <if test="orderType != null">
        order_type = #{orderType,jdbcType=VARCHAR},
      </if>
      <if test="isExtend != null">
        is_extend = #{isExtend,jdbcType=VARCHAR},
      </if>
      <if test="orderKind != null">
        order_kind = #{orderKind,jdbcType=VARCHAR},
      </if>
    </set>
    where order_id = #{orderId,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.cnit.yoyo.model.order.Order">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 13 16:49:11 CST 2015.
    -->
    update t_orders
    set company_id = #{companyId,jdbcType=BIGINT},
      store_id = #{storeId,jdbcType=BIGINT},
      MEMBER_ID = #{memberId,jdbcType=INTEGER},
      total_amount = #{totalAmount,jdbcType=DECIMAL},
      final_amount = #{finalAmount,jdbcType=DECIMAL},
      pay_status = #{payStatus,jdbcType=VARCHAR},
      is_delivery = #{isDelivery,jdbcType=VARCHAR},
      discount_value = #{discountValue,jdbcType=DECIMAL},
      createtime = #{createtime,jdbcType=TIMESTAMP},
      last_modified = #{lastModified,jdbcType=TIMESTAMP},
      payment = #{payment,jdbcType=VARCHAR},
      payment_id = #{paymentId,jdbcType=INTEGER},
      shipping = #{shipping,jdbcType=VARCHAR},
      status = #{status,jdbcType=VARCHAR},
      confirm = #{confirm,jdbcType=VARCHAR},
      ship_area = #{shipArea,jdbcType=VARCHAR},
      ship_name = #{shipName,jdbcType=VARCHAR},
      weight = #{weight,jdbcType=DECIMAL},
      tostr = #{tostr,jdbcType=VARCHAR},
      itemnum = #{itemnum,jdbcType=INTEGER},
      ip = #{ip,jdbcType=VARCHAR},
      ship_addr = #{shipAddr,jdbcType=VARCHAR},
      ship_zip = #{shipZip,jdbcType=VARCHAR},
      ship_tel = #{shipTel,jdbcType=VARCHAR},
      ship_email = #{shipEmail,jdbcType=VARCHAR},
      ship_time = #{shipTime,jdbcType=VARCHAR},
      ship_mobile = #{shipMobile,jdbcType=VARCHAR},
      cost_item = #{costItem,jdbcType=DECIMAL},
      is_coupons = #{isCoupons,jdbcType=INTEGER},
      cost_tax = #{costTax,jdbcType=DECIMAL},
      tax_company = #{taxCompany,jdbcType=VARCHAR},
      is_protect = #{isProtect,jdbcType=VARCHAR},
      cost_protect = #{costProtect,jdbcType=DECIMAL},
      cost_payment = #{costPayment,jdbcType=DECIMAL},
      currency = #{currency,jdbcType=VARCHAR},
      cur_rate = #{curRate,jdbcType=DECIMAL},
      score_u = #{scoreU,jdbcType=DECIMAL},
      score_g = #{scoreG,jdbcType=DECIMAL},
      discount = #{discount,jdbcType=DECIMAL},
      pmt_goods = #{pmtGoods,jdbcType=DECIMAL},
      pmt_order = #{pmtOrder,jdbcType=DECIMAL},
      payed = #{payed,jdbcType=DECIMAL},
      memo = #{memo,jdbcType=VARCHAR},
      disabled = #{disabled,jdbcType=VARCHAR},
      mark_type = #{markType,jdbcType=VARCHAR},
      mark_text = #{markText,jdbcType=VARCHAR},
      cost_freight = #{costFreight,jdbcType=DECIMAL},
      extend = #{extend,jdbcType=VARCHAR},
      order_refer = #{orderRefer,jdbcType=VARCHAR},
      addon = #{addon,jdbcType=VARCHAR},
      source = #{source,jdbcType=VARCHAR},
      confirm_time = #{confirmTime,jdbcType=TIMESTAMP},
      comments_count = #{commentsCount,jdbcType=INTEGER},
      refund_status = #{refundStatus,jdbcType=VARCHAR},
      act_id = #{actId,jdbcType=INTEGER},
      order_type = #{orderType,jdbcType=VARCHAR},
      is_extend = #{isExtend,jdbcType=VARCHAR},
      order_kind = #{orderKind,jdbcType=VARCHAR}
    where order_id = #{orderId,jdbcType=BIGINT}
  </update>
  
  
  <sql id="Items_Column_List" >
    t_order_items.item_id,t_order_items.order_id,t_order_items.product_id,t_order_items.bn,t_order_items.name,t_order_items.price,t_order_items.g_pric,t_order_items.cost,t_order_items.amount,t_order_items.score,t_order_items.weight,t_order_items.nums,t_order_items.sendnum,t_order_items.item_type,t_order_items.appointment 
  </sql>
  
  <sql id="Order_Column_List">
	t_orders.order_id,t_orders.company_id,t_orders.store_id,t_orders.MEMBER_ID,t_orders.total_amount,t_orders.final_amount,t_orders.pay_status,
    t_orders.is_delivery,t_orders.discount_value,t_orders.createtime,t_orders.last_modified,t_orders.payment,t_orders.payment_id,t_orders.
    shipping,t_orders.status,t_orders.confirm,t_orders.ship_area,t_orders.ship_name,t_orders.weight,t_orders.tostr,t_orders.itemnum,t_orders.ip,t_orders.ship_addr,t_orders.
    ship_zip,t_orders.ship_tel,t_orders.ship_email,t_orders.ship_time,t_orders.ship_mobile,t_orders.cost_item,t_orders.is_coupons,t_orders.cost_tax,t_orders.
    tax_company,t_orders.is_protect,t_orders.cost_protect,t_orders.cost_payment,t_orders.currency,t_orders.cur_rate,t_orders.score_u,t_orders.
    score_g,t_orders.discount,t_orders.pmt_goods,t_orders.pmt_order,t_orders.payed,t_orders.memo,t_orders.disabled,t_orders.mark_type,t_orders.mark_text,t_orders.
    cost_freight,t_orders.extend,t_orders.order_refer,t_orders.addon,t_orders.source,t_orders.confirm_time,t_orders.comments_count,t_orders.refund_status,t_orders.
    act_id,t_orders.order_type,t_orders.is_extend,t_orders.order_kind
  </sql>
  
  <sql id="Product_Column_List">
	  t_products.picture_path,t_products.product_id,t_products.goods_id,t_products.barcode,t_products.title,t_products.bn as product_bn,t_products.price,t_products.cost,t_products.mktprice,t_products.name as product_name,t_products.weight,t_products.unit,t_products.store,t_products.store_place,t_products.freez,t_products.goods_type,t_products.last_modify,t_products.uptime,t_products.disabled,t_products.marketable
  </sql>
  
  <sql id="Log_Column_List" >
    t_order_log.log_id,t_order_log.order_id,t_order_log.rel_id,t_order_log.op_id,t_order_log.op_name,t_order_log.alttime,t_order_log.bill_type,t_order_log.behavior,t_order_log.result,t_order_log.log_text, t_order_log.addon
  </sql>
  
  <sql id="Member_Column_List">
  	t_members.member_id,t_members.member_lv_id,t_members.account_id,t_members.nick_name,t_members.name as member_name,t_members.idcard,t_members.first_name,t_members.last_name,t_members.
    b_year,t_members.b_month,t_members.b_day,t_members.sex,t_members.mobile,t_members.tel,t_members.email,t_members.area,t_members.addr,t_members.zip,t_members.wedlock,t_members.education,t_members.
    vocation,t_members.cur,t_members.lang,t_members.advance,t_members.advance_freeze,t_members.experience,t_members.point_summation,t_members.point_useable,t_members.
    point_used,t_members.point_disrate,t_members.settled_time,t_members.biz_money,t_members.refer_id,t_members.refer_url,t_members.info_integrity,t_members.
    state,t_members.order_num
  </sql>
  
  <sql id="Goods_Column_List">
		goods.CAT_ID,goods.BRAND_ID,goods.PROMPT_ID,goods.COMPANY_ID,goods.STORE_ID,goods.FBN,goods.DBN,goods.NAME,goods.MARKETABLE,goods.SCORE,
		goods.COST,goods.PRICE,goods.MKT_PRICE,
		goods.STORE,goods.STORE_FREEZE,goods.NOTIFY_NUM,goods.DOWN_TIME,goods.UP_TIME,goods.LAST_MODIFY,goods.MIN_BUY,
		goods.UNIT,goods.WEIGHT,goods.BRIEF,goods.GOODS_KIND,
		goods.GOODS_TYPE,goods.UDF_IMG,goods.IMAGE_DEFAULT_ID,goods.THUMBNAIL_PIC,goods.SMALL_PIC,
		goods.MID_PIC,goods.BIG_PIC,goods.STORE_PLACE,goods.GOODS_COND,
		goods.SCORE_SETTING,goods.NOSTORE_SELL,goods.DISABLED,goods.BUY_COUNT,
		goods.BUY_W_COUNT,goods.BUY_M_COUNT,goods.VIEW_W_COUNT,goods.VIEW_M_COUNT,goods.RANK_COUNT,
		goods.COMMENTS_COUNT,goods.VIEW_COUNT,
		goods.FAV_COUNT,goods.MARKETABLE_ALLOW,goods.MARKETABLE_CONTENT,goods.AVG_POINT,goods.FREIGHT_BEAR,goods.PACKAGE_SCALE,
		PACKAGE_UNIT,goods.PACKAGE_USE,goods.S_ORDER,goods.D_ORDER,goods.ACC_ID,goods.CAR_ID
	</sql>
  
  
  <resultMap id="Trade_Order_Info" type="com.cnit.yoyo.model.order.Order" extends="BaseResultMap">
  	<result column="order_member_name" jdbcType="VARCHAR" property="orderMemberName" />
  	<association property="member" column="member_id" javaType="com.cnit.yoyo.model.member.Member">
  		<result column="member_lv_id" jdbcType="INTEGER" property="memberLvId" />
	    <result column="account_id" jdbcType="INTEGER" property="accountId" />
	    <result column="nick_name" jdbcType="VARCHAR" property="nickName" />
	    <result column="member_name" jdbcType="VARCHAR" property="name" />
	    <result column="idcard" jdbcType="VARCHAR" property="idcard" />
	    <result column="first_name" jdbcType="VARCHAR" property="firstName" />
	    <result column="last_name" jdbcType="VARCHAR" property="lastName" />
	    <result column="b_year" jdbcType="VARCHAR" property="bYear" />
	    <result column="b_month" jdbcType="VARCHAR" property="bMonth" />
	    <result column="b_day" jdbcType="VARCHAR" property="bDay" />
	    <result column="sex" jdbcType="CHAR" property="sex" />
	    <result column="mobile" jdbcType="VARCHAR" property="mobile" />
	    <result column="tel" jdbcType="VARCHAR" property="tel" />
	    <result column="email" jdbcType="VARCHAR" property="email" />
	    <result column="area" jdbcType="VARCHAR" property="area" />
	    <result column="addr" jdbcType="VARCHAR" property="addr" />
	    <result column="zip" jdbcType="VARCHAR" property="zip" />
	    <result column="wedlock" jdbcType="CHAR" property="wedlock" />
	    <result column="education" jdbcType="VARCHAR" property="education" />
	    <result column="vocation" jdbcType="VARCHAR" property="vocation" />
	    <result column="cur" jdbcType="VARCHAR" property="cur" />
	    <result column="lang" jdbcType="VARCHAR" property="lang" />
	    <result column="advance" jdbcType="DECIMAL" property="advance" />
	    <result column="advance_freeze" jdbcType="DECIMAL" property="advanceFreeze" />
	    <result column="experience" jdbcType="DECIMAL" property="experience" />
	    <result column="point_summation" jdbcType="DECIMAL" property="pointSummation" />
	    <result column="point_useable" jdbcType="DECIMAL" property="pointUseable" />
	    <result column="point_used" jdbcType="DECIMAL" property="pointUsed" />
	    <result column="point_disrate" jdbcType="DECIMAL" property="pointDisrate" />
	    <result column="settled_time" jdbcType="VARCHAR" property="settledTime" />
	    <result column="biz_money" jdbcType="DECIMAL" property="bizMoney" />
	    <result column="refer_id" jdbcType="VARCHAR" property="referId" />
	    <result column="refer_url" jdbcType="VARCHAR" property="referUrl" />
	    <result column="info_integrity" jdbcType="DECIMAL" property="infoIntegrity" />
	    <result column="state" jdbcType="VARCHAR" property="state" />
	    <result column="order_num" jdbcType="INTEGER" property="orderNum" />
	    <result column="channel" jdbcType="VARCHAR" property="channel" />
  	</association>
  	<collection property="orderItems" ofType="com.cnit.yoyo.model.order.OrderItems" column="order_id">
			<id column="item_id" property="itemId" jdbcType="INTEGER" />
		    <result column="order_id" property="orderId" jdbcType="BIGINT" />
		    <result column="product_id" property="productId" jdbcType="INTEGER" />
		    <result column="bn" property="bn" jdbcType="VARCHAR" />
		    <result column="product_name" property="name" jdbcType="VARCHAR" />
		    <result column="price" property="price" jdbcType="DECIMAL" />
		    <result column="g_pric" property="gPric" jdbcType="DECIMAL" />
		    <result column="cost" property="cost" jdbcType="DECIMAL" />
		    <result column="amount" property="amount" jdbcType="DECIMAL" />
		    <result column="score" property="score" jdbcType="INTEGER" />
		    <result column="weight" property="weight" jdbcType="INTEGER" />
		    <result column="nums" property="nums" jdbcType="REAL" />
		    <result column="sendnum" property="sendnum" jdbcType="REAL" />
		    <result column="item_type" property="itemType" jdbcType="INTEGER" />
		    <result column="appointment" property="appointment" jdbcType="VARCHAR" />
		    
		    <association property="product" column="product_id" javaType="com.cnit.yoyo.model.goods.Product">  
	            <id column="product_id" property="productId" jdbcType="INTEGER" />
			    <result column="goods_id" property="goodsId" jdbcType="INTEGER" />
			    <result column="barcode" property="barcode" jdbcType="VARCHAR" />
			    <result column="title" property="title" jdbcType="VARCHAR" />
			    <result column="product_bn" property="bn" jdbcType="VARCHAR" />
			    <result column="price" property="price" jdbcType="DECIMAL" />
			    <result column="cost" property="cost" jdbcType="DECIMAL" />
			    <result column="mktprice" property="mktprice" jdbcType="DECIMAL" />
			    <result column="product_name" property="name" jdbcType="VARCHAR" />
			    <result column="weight" property="weight" jdbcType="DECIMAL" />
			    <result column="unit" property="unit" jdbcType="VARCHAR" />
			    <result column="store" property="store" jdbcType="DECIMAL" />
			    <result column="store_place" property="storePlace" jdbcType="VARCHAR" />
			    <result column="freez" property="freez" jdbcType="INTEGER" />
			    <result column="goods_type" property="goodsType" jdbcType="VARCHAR" />
			    <result column="last_modify" property="lastModify" jdbcType="TIMESTAMP" />
			    <result column="uptime" property="uptime" jdbcType="TIMESTAMP" />
			    <result column="disabled" property="disabled" jdbcType="VARCHAR" />
			    <result column="marketable" property="marketable" jdbcType="VARCHAR" />
				<result column="picture_path" property="picturePath" jdbcType="VARCHAR" />	
	        </association>
	        <association property="goods" javaType="com.cnit.yoyo.model.goods.Goods" column="goods_id">
	        	<result column="GOODS_ID" jdbcType="INTEGER" property="goodsId" />
				<result column="CAT_ID" jdbcType="INTEGER" property="catId" />
				<result column="BRAND_ID" jdbcType="INTEGER" property="brandId" />
				<result column="PROMPT_ID" jdbcType="INTEGER" property="promptId" />
				<result column="COMPANY_ID" jdbcType="INTEGER" property="companyId" />
				<result column="STORE_ID" jdbcType="INTEGER" property="storeId" />
				<result column="FBN" jdbcType="VARCHAR" property="fbn" />
				<result column="DBN" jdbcType="VARCHAR" property="dbn" />
				<result column="NAME" jdbcType="VARCHAR" property="name" />
				<result column="MARKETABLE" jdbcType="VARCHAR" property="marketable" />
				<result column="SCORE" jdbcType="DECIMAL" property="score" />
				<result column="COST" jdbcType="DECIMAL" property="cost" />
				<result column="PRICE" jdbcType="DECIMAL" property="price" />
				<result column="MKT_PRICE" jdbcType="DECIMAL" property="mktPrice" />
				<result column="STORE" jdbcType="DECIMAL" property="store" />
				<result column="STORE_FREEZE" jdbcType="DECIMAL" property="storeFreeze" />
				<result column="NOTIFY_NUM" jdbcType="INTEGER" property="notifyNum" />
				<result column="DOWN_TIME" jdbcType="VARCHAR" property="downTime" />
				<result column="UP_TIME" jdbcType="VARCHAR" property="upTime" />
				<result column="LAST_MODIFY" jdbcType="VARCHAR" property="lastModify" />
				<result column="MIN_BUY" jdbcType="INTEGER" property="minBuy" />
				<result column="UNIT" jdbcType="VARCHAR" property="unit" />
				<result column="WEIGHT" jdbcType="DECIMAL" property="weight" />
				<result column="BRIEF" jdbcType="VARCHAR" property="brief" />
				<result column="GOODS_KIND" jdbcType="VARCHAR" property="goodsKind" />
				<result column="GOODS_TYPE" jdbcType="VARCHAR" property="goodsType" />
				<result column="UDF_IMG" jdbcType="VARCHAR" property="udfImg" />
				<result column="IMAGE_DEFAULT_ID" jdbcType="VARCHAR" property="imageDefaultId" />
				<result column="THUMBNAIL_PIC" jdbcType="VARCHAR" property="thumbnailPic" />
				<result column="SMALL_PIC" jdbcType="VARCHAR" property="smallPic" />
				<result column="MID_PIC" jdbcType="VARCHAR" property="midPic" />
				<result column="BIG_PIC" jdbcType="VARCHAR" property="bigPic" />
				<result column="STORE_PLACE" jdbcType="VARCHAR" property="storePlace" />
				<result column="GOODS_COND" jdbcType="VARCHAR" property="goodsCond" />
				<result column="SCORE_SETTING" jdbcType="VARCHAR" property="scoreSetting" />
				<result column="NOSTORE_SELL" jdbcType="VARCHAR" property="nostoreSell" />
				<result column="DISABLED" jdbcType="VARCHAR" property="disabled" />
				<result column="BUY_COUNT" jdbcType="INTEGER" property="buyCount" />
				<result column="BUY_W_COUNT" jdbcType="INTEGER" property="buyWCount" />
				<result column="BUY_M_COUNT" jdbcType="INTEGER" property="buyMCount" />
				<result column="VIEW_W_COUNT" jdbcType="INTEGER" property="viewWCount" />
				<result column="VIEW_M_COUNT" jdbcType="INTEGER" property="viewMCount" />
				<result column="RANK_COUNT" jdbcType="INTEGER" property="rankCount" />
				<result column="COMMENTS_COUNT" jdbcType="INTEGER" property="commentsCount" />
				<result column="VIEW_COUNT" jdbcType="INTEGER" property="viewCount" />
				<result column="FAV_COUNT" jdbcType="INTEGER" property="favCount" />
				<result column="MARKETABLE_ALLOW" jdbcType="VARCHAR" property="marketableAllow" />
				<result column="MARKETABLE_CONTENT" jdbcType="VARCHAR" property="marketableContent" />
				<result column="AVG_POINT" jdbcType="DECIMAL" property="avgPoint" />
				<result column="FREIGHT_BEAR" jdbcType="VARCHAR" property="freightBear" />
				<result column="PACKAGE_SCALE" jdbcType="DECIMAL" property="packageScale" />
				<result column="PACKAGE_UNIT" jdbcType="VARCHAR" property="packageUnit" />
				<result column="PACKAGE_USE" jdbcType="VARCHAR" property="packageUse" />
				<result column="INTRO" jdbcType="VARCHAR" property="intro" />
				<result column="S_ORDER" jdbcType="INTEGER" property="sOrder" />
				<result column="D_ORDER" jdbcType="INTEGER" property="dOrder" />
				<result column="ACC_ID" jdbcType="INTEGER" property="accId" />
				<result column="CAR_ID" jdbcType="INTEGER" property="carId" />
	        </association>
		</collection>
		
		<collection property="orderLogs" ofType="com.cnit.yoyo.model.order.OrderLog" column="order_id">
			<id column="log_id" property="logId" jdbcType="INTEGER" />
		    <result column="order_id" property="orderId" jdbcType="BIGINT" />
		    <result column="rel_id" property="relId" jdbcType="BIGINT" />
		    <result column="op_id" property="opId" jdbcType="INTEGER" />
		    <result column="op_name" property="opName" jdbcType="VARCHAR" />
		    <result column="alttime" property="alttime" jdbcType="TIMESTAMP" />
		    <result column="bill_type" property="billType" jdbcType="INTEGER" />
		    <result column="behavior" property="behavior" jdbcType="INTEGER" />
		    <result column="result" property="result" jdbcType="INTEGER" />
		    <result column="log_text" property="logText" jdbcType="LONGVARCHAR" />
	   		<result column="addon" property="addon" jdbcType="LONGVARCHAR" />
		</collection>
  </resultMap>
  
  
  <select id="selectOrderIdsListInfo" parameterType="com.cnit.yoyo.model.order.dto.OrderQryDTO" resultType="java.lang.Long">
    select 
	  t_orders.order_id
	from 
		t_orders  	
	left join t_order_items on t_orders.order_id = t_order_items.order_id
	left join t_members on t_members.member_id=t_orders.member_id
	left join t_pam_account on t_pam_account.account_id=t_members.account_id
	left join t_products on t_order_items.product_id = t_products.product_id
	left join t_goods on t_products.goods_id = t_products.goods_id
	where
		t_orders.parent_order_id IS NOT NULl
		and t_orders.company_id=#{companyId,jdbcType=BIGINT}
	<if test="orderId != null and orderId != ''">
		and  t_orders.order_id LIKE CONCAT('%', #{orderId,jdbcType=VARCHAR},'%')
	</if>
	
	<if test="goodsName != null and goodsName != ''">
		and t_products.name LIKE CONCAT('%', REPLACE(REPLACE(#{goodsName,jdbcType=VARCHAR},'_','\_'),'%','\%'),'%')
	</if>
	
	<if test="goodsBn != null and goodsBn != ''">
		and t_goods.DBN LIKE CONCAT('%', #{goodsBn,jdbcType=VARCHAR},'%')
	</if>
	
	<if test="status != null and status != ''">
		and t_orders.status=#{status,jdbcType=VARCHAR}
	</if>
	<if test="payStatus != null and payStatus != ''">
	    and t_orders.pay_status=#{payStatus,jdbcType=VARCHAR}
	</if>
	
	<if test="orderTime != null and orderTime != ''">
		<if test="orderTime !='13Y'">
			<![CDATA[
			  and DATE_FORMAT(t_orders.createtime, '%Y-%m-%d') >=  DATE_FORMAT(#{dateCondition}, '%Y-%m-%d')
			]]>
		</if>
		<if test="orderTime =='13Y'">
			<![CDATA[
			  and DATE_FORMAT(t_orders.createtime, '%Y-%m-%d') <  DATE_FORMAT(#{dateCondition}, '%Y-%m-%d')
			]]>
		</if>
	</if>
	group by t_orders.order_id
	order by t_orders.createtime desc
  </select>  
  
  
  <select id="selectOrderListInfo" parameterType="com.cnit.yoyo.model.order.dto.OrderQryDTO" resultMap="Trade_Order_Info">
    select 
	   <include refid="Order_Column_List" />
	   ,
	   <include refid="Items_Column_List" />
	   ,
	   <include refid="Product_Column_List" />
	   ,
	   <include refid="Goods_Column_List" />
	   ,
	   <include refid="Member_Column_List" />
	   ,
	   t_pam_account.login_name as order_member_name
	from 
		t_orders  	
	left join t_order_items on t_orders.order_id = t_order_items.order_id
	left join t_members on t_members.member_id=t_orders.member_id
	left join t_pam_account on t_pam_account.account_id=t_members.account_id
	left join t_products on t_order_items.product_id = t_products.product_id
	left join t_goods goods on t_products.goods_id = goods.goods_id
	where
		t_orders.parent_order_id IS NOT NULl
	and t_orders.company_id=#{companyId,jdbcType=BIGINT}
	and t_orders.order_id in
	<foreach collection="orderIds" item="id" index="index" open="(" close=")" separator=",">
		#{id}
	</foreach>
	<if test="orderId != null and orderId != ''">
		and  t_orders.order_id LIKE CONCAT('%', #{orderId,jdbcType=VARCHAR},'%')
	</if>
	
	<if test="goodsName != null and goodsName != ''">
		and t_products.name LIKE CONCAT('%', REPLACE(REPLACE(#{goodsName,jdbcType=VARCHAR},'_','\_'),'%','\%'),'%')
	</if>
	
	<if test="goodsBn != null and goodsBn != ''">
		and goods.DBN LIKE CONCAT('%', #{goodsBn,jdbcType=VARCHAR},'%')
	</if>
	
	<if test="status != null and status != ''">
		and t_orders.status=#{status,jdbcType=VARCHAR}
	</if>
	<if test="payStatus != null and payStatus != ''">
	    and t_orders.pay_status=#{payStatus,jdbcType=VARCHAR}
	</if>
	
	<if test="orderTime != null and orderTime != ''">
		<if test="orderTime !='13Y'">
			<![CDATA[
			  and DATE_FORMAT(t_orders.createtime, '%Y-%m-%d') >=  DATE_FORMAT(#{dateCondition}, '%Y-%m-%d')
			]]>
		</if>
		<if test="orderTime =='13Y'">
			<![CDATA[
			  and DATE_FORMAT(t_orders.createtime, '%Y-%m-%d') <  DATE_FORMAT(#{dateCondition}, '%Y-%m-%d')
			]]>
		</if>
	</if>
	order by t_orders.createtime desc
  </select>  
  
   <select id="selectOrderByOrderId" parameterType="java.lang.Long" resultMap="Trade_Order_Info">
    select 
	   <include refid="Order_Column_List" />
	   ,
	   <include refid="Items_Column_List" />
	   ,
	   <include refid="Product_Column_List" />
	   ,
	   <include refid="Goods_Column_List" />
	   ,
	   <include refid="Log_Column_List" />
	   ,
	   <include refid="Member_Column_List" />
	   ,
	   t_pam_account.login_name as order_member_name
	from 
		t_orders  
	left join t_orders oo on t_orders.order_id = oo.parent_order_id
	left join t_order_items on (oo.order_id = t_order_items.order_id or t_orders.order_id = t_order_items.order_id)
	left join t_members on t_members.member_id=t_orders.member_id
	left join t_pam_account on t_pam_account.account_id=t_members.account_id
	left join t_products on t_order_items.product_id = t_products.product_id
	left join t_goods goods on t_products.goods_id = goods.goods_id
	left join t_order_log on t_order_log.order_id=t_orders.order_id
	where
		t_orders.order_id = #{orderId,jdbcType=BIGINT}
  </select>
  
  	<!-- 查询主单和子单集合 -->
 <select id="getAllOrderInfoList" parameterType="java.util.Map" resultMap="BaseResultMap">
 	 SELECT 
	   <include refid="Order_Column_List" />,t_orders.parent_order_id,1 as parentorder_flag
	from
	t_orders where t_orders.order_id =  #{orderId}

	UNION ALL
	SELECT 
	   <include refid="Order_Column_List" />,t_orders.parent_order_id,0 as parentorder_flag
	from
	t_orders where t_orders.parent_order_id = #{orderId}
 </select>
  
  
 <select id="selectOrderTips" parameterType="java.util.Map" resultType="com.cnit.yoyo.model.trade.dto.OrderTipsDTO">
		SELECT 
	  		unpay,
			unconfirm,
	  		confirm,
			finish,
			selling,
			putaway,
			refunds,
			aftersales,
			report,
			complain
	  	FROM 
	  	(
			(SELECT COUNT(1) AS unpay from t_orders t WHERE t.disabled=0 AND t.pay_status=0 AND t.`status`='create' AND t.store_id=#{storeId}) unpay,
			(SELECT COUNT(1) AS unconfirm from t_orders t WHERE t.disabled=0 AND t.`status`='unconfirm' AND t.store_id=#{storeId}) unconfirm,
			(SELECT COUNT(1) AS confirm from t_orders t WHERE t.disabled=0 AND t.`status`='confirm' AND t.store_id=#{storeId}) confirm,
			(SELECT COUNT(1) AS finish from t_orders t WHERE t.disabled=0 AND t.`status`='finish' AND t.store_id=#{storeId}) finish,
			(SELECT COUNT(1) AS selling FROM t_goods t WHERE t.DISABLED=0 AND t.MARKETABLE=1 AND t.store_id=#{storeId})selling,
			(SELECT COUNT(1) AS putaway FROM t_goods t WHERE t.DISABLED=0 AND t.MARKETABLE=0 AND t.store_id=#{storeId})putaway,
			(SELECT count(1) AS refunds FROM t_aftersales_return_product arp LEFT JOIN t_orders t ON arp.order_id = t.order_id WHERE t.store_id = #{storeId} AND arp.`status`=1 AND arp.is_safeguard = 1) refunds,
			(SELECT count(1) AS aftersales FROM t_aftersales_return_product arp LEFT JOIN t_orders t ON arp.order_id = t.order_id WHERE t.store_id = #{storeId} AND arp.`status`=1 AND arp.is_safeguard = 2) aftersales,
			(SELECT COUNT(0) AS report from t_report report WHERE report.store_id=#{storeId}) report,
			(SELECT COUNT(1) AS complain from t_complain WHERE store_id=#{storeId}) complain
		)
  </select>
  
  <select id="selectShopSellsInfo" parameterType="java.util.Map" resultType="com.cnit.yoyo.model.trade.dto.OrderSellsInfoDTO">
  		SELECT  dayCount,daySumMoney,dayPayCount,dayPayMoney,monthCount,monthSumMoney,monthPayCount,monthPayMoney FROM
  			(
			SELECT
				(SELECT COUNT(0) FROM t_orders t WHERE t.store_id=#{storeId} AND t.createtime BETWEEN (SELECT date_format(now(), '%Y-%m-%d 00:00:00')) AND (SELECT date_format(now(), '%Y-%m-%d 23:59:59'))) dayCount,
				(SELECT SUM(t.final_amount) FROM t_orders t WHERE t.store_id=#{storeId} AND t.createtime BETWEEN (SELECT date_format(now(), '%Y-%m-%d 00:00:00')) AND (SELECT date_format(now(), '%Y-%m-%d 23:59:59'))) daySumMoney,
				(SELECT COUNT(0) FROM t_orders t WHERE t.store_id=#{storeId} AND t.pay_status=1 AND t.createtime BETWEEN (SELECT date_format(now(), '%Y-%m-%d 00:00:00')) AND (SELECT date_format(now(), '%Y-%m-%d 23:59:59'))) dayPayCount,
				(SELECT SUM(t.final_amount) FROM t_orders t WHERE t.store_id=#{storeId} AND t.pay_status=1 AND t.createtime BETWEEN (SELECT date_format(now(), '%Y-%m-%d 00:00:00')) AND (SELECT date_format(now(), '%Y-%m-%d 23:59:59'))) dayPayMoney,
				(SELECT COUNT(0) FROM t_orders t WHERE t.store_id=#{storeId} AND t.createtime BETWEEN (SELECT date_format(DATE_ADD(curdate(),interval -day(curdate())+1 day), '%Y-%m-%d')) AND (SELECT date_format(last_day(curdate()), '%Y-%m-%d'))) monthCount,
				(SELECT SUM(t.final_amount) FROM t_orders t WHERE t.store_id=#{storeId} AND t.createtime BETWEEN (SELECT date_format(DATE_ADD(curdate(),interval -day(curdate())+1 day), '%Y-%m-%d')) AND (SELECT date_format(last_day(curdate()), '%Y-%m-%d'))) monthSumMoney,
				(SELECT COUNT(0) FROM t_orders t WHERE t.store_id=#{storeId} AND t.pay_status=1 AND t.createtime BETWEEN (SELECT date_format(DATE_ADD(curdate(),interval -day(curdate())+1 day), '%Y-%m-%d')) AND (SELECT date_format(last_day(curdate()), '%Y-%m-%d'))) monthPayCount,
				(SELECT SUM(t.final_amount) FROM t_orders t WHERE t.store_id=#{storeId} AND t.pay_status=1 AND t.createtime BETWEEN (SELECT date_format(DATE_ADD(curdate(),interval -day(curdate())+1 day), '%Y-%m-%d')) AND (SELECT date_format(last_day(curdate()), '%Y-%m-%d'))) monthPayMoney
			FROM 
				t_orders orders
			WHERE
				orders.store_id=#{storeId}
			GROUP BY 
				orders.store_id
			) T
  </select>
  
  <update id="updateOrderStatus" parameterType="java.util.Map">
    update t_orders
    <set>
		<if test="status != null">
	       status = #{status,jdbcType=VARCHAR},
	    </if>
		<if test="payStatus != null">
	       pay_status = #{payStatus,jdbcType=VARCHAR},
	    </if>
	    addon=${addon},
	    LAST_MODIFIED =NOW()
    </set>
    where order_id = #{orderId,jdbcType=BIGINT}
  </update>
  
  <update id="updateOrderRemark" parameterType="com.cnit.yoyo.model.order.dto.OrderRemarkDTO">
    update t_orders
    <set>
		<if test="markType != null">
	       mark_type = #{markType,jdbcType=VARCHAR},
	    </if>
		<if test="markText != null">
	       mark_text = #{markText,jdbcType=VARCHAR}
	    </if>
    </set>
    where order_id = #{orderId,jdbcType=BIGINT}
  </update>
  
  <update id="updateOrderStatusToDead">
	<![CDATA[
		UPDATE t_orders SET `status`='dead' WHERE pay_status=0 AND `status` !='dead' AND createtime < (SELECT str_to_date(date_sub(NOW(),interval 1 day),'%Y-%m-%d %H:%i:%s') after_date)
	]]>  	 
  </update>
</mapper>