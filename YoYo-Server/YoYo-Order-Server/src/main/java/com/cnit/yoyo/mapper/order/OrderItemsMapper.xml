<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cnit.yoyo.dao.order.OrderItemsMapper" >
  <resultMap id="BaseResultMap" type="com.cnit.yoyo.model.order.OrderItems" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    <id column="item_id" property="itemId" jdbcType="INTEGER" />
    <result column="order_id" property="orderId" jdbcType="BIGINT" />
    <result column="product_id" property="productId" jdbcType="INTEGER" />
    <result column="bn" property="bn" jdbcType="VARCHAR" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="price" property="price" jdbcType="DECIMAL" />
    <result column="g_pric" property="gPric" jdbcType="DECIMAL" />
    <result column="cost" property="cost" jdbcType="DECIMAL" />
    <result column="amount" property="amount" jdbcType="DECIMAL" />
    <result column="score" property="score" jdbcType="INTEGER" />
    <result column="weight" property="weight" jdbcType="INTEGER" />
    <result column="nums" property="nums" jdbcType="REAL" />
    <result column="sendnum" property="sendnum" jdbcType="REAL" />
    <result column="item_type" property="itemType" jdbcType="VARCHAR" />
    <result column="appointment" property="appointment" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="ResultMapWithBLOBs" type="com.cnit.yoyo.model.order.OrderItems" extends="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    <result column="addon" property="addon" jdbcType="LONGVARCHAR" />
  </resultMap>
     <resultMap id="ResultMapItemDTO" type="com.cnit.yoyo.model.order.dto.OrderItemsQryDTO" extends="BaseResultMap">
  </resultMap>
  <sql id="Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    item_id, order_id, product_id, bn, name, price, g_pric, cost, amount, score, weight, 
    nums, sendnum, item_type,appointment
  </sql>
  <sql id="Blob_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    addon
  </sql>
  <select id="selectByExampleWithBLOBs" resultMap="ResultMapWithBLOBs" parameterType="com.cnit.yoyo.model.order.OrderItemsExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    'false' as QUERYID,
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from t_order_items
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.cnit.yoyo.model.order.OrderItemsExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_order_items
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from t_order_items
    where item_id = #{itemId,jdbcType=INTEGER}
  </select>
  
    <select id="selectByOrderId" resultMap="ResultMapItemDTO" parameterType="java.lang.Long" >
    select 
    product_id,name,sendnum, price, amount, nums
    from t_order_items
    where order_id =  #{orderId,jdbcType=BIGINT}
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    delete from t_order_items
    where item_id = #{itemId,jdbcType=INTEGER}
  </delete>
  <delete id="deleteByExample" parameterType="com.cnit.yoyo.model.order.OrderItemsExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    delete from t_order_items
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.cnit.yoyo.model.order.OrderItems" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    insert into t_order_items (item_id, order_id, product_id, 
      bn, name, price, g_pric, 
      cost, amount, score, 
      weight, nums, sendnum, item_type, 
      addon,appointment)
    values (#{itemId,jdbcType=INTEGER}, #{orderId,jdbcType=BIGINT}, #{productId,jdbcType=INTEGER}, 
      #{bn,jdbcType=VARCHAR}, #{name,jdbcType=VARCHAR}, #{price,jdbcType=DECIMAL}, #{gPric,jdbcType=DECIMAL}, 
      #{cost,jdbcType=DECIMAL}, #{amount,jdbcType=DECIMAL}, #{score,jdbcType=INTEGER}, 
      #{weight,jdbcType=INTEGER}, #{nums,jdbcType=REAL}, #{sendnum,jdbcType=REAL}, #{itemType,jdbcType=VARCHAR}, 
      #{addon,jdbcType=LONGVARCHAR}, #{appointment,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.cnit.yoyo.model.order.OrderItems" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    insert into t_order_items
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="itemId != null" >
        item_id,
      </if>
      <if test="orderId != null" >
        order_id,
      </if>
      <if test="productId != null" >
        product_id,
      </if>
      <if test="bn != null" >
        bn,
      </if>
      <if test="name != null" >
        name,
      </if>
      <if test="price != null" >
        price,
      </if>
      <if test="gPric != null" >
        g_pric,
      </if>
      <if test="cost != null" >
        cost,
      </if>
      <if test="amount != null" >
        amount,
      </if>
      <if test="score != null" >
        score,
      </if>
      <if test="weight != null" >
        weight,
      </if>
      <if test="nums != null" >
        nums,
      </if>
      <if test="sendnum != null" >
        sendnum,
      </if>
      <if test="itemType != null" >
        item_type,
      </if>
      <if test="addon != null" >
        addon,
      </if>
      <if test="addon != null" >
        appointment,
      </if>
      
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="itemId != null" >
        #{itemId,jdbcType=INTEGER},
      </if>
      <if test="orderId != null" >
        #{orderId,jdbcType=BIGINT},
      </if>
      <if test="productId != null" >
        #{productId,jdbcType=INTEGER},
      </if>
      <if test="bn != null" >
        #{bn,jdbcType=VARCHAR},
      </if>
      <if test="name != null" >
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="price != null" >
        #{price,jdbcType=DECIMAL},
      </if>
      <if test="gPric != null" >
        #{gPric,jdbcType=DECIMAL},
      </if>
      <if test="cost != null" >
        #{cost,jdbcType=DECIMAL},
      </if>
      <if test="amount != null" >
        #{amount,jdbcType=DECIMAL},
      </if>
      <if test="score != null" >
        #{score,jdbcType=INTEGER},
      </if>
      <if test="weight != null" >
        #{weight,jdbcType=INTEGER},
      </if>
      <if test="nums != null" >
        #{nums,jdbcType=REAL},
      </if>
      <if test="sendnum != null" >
        #{sendnum,jdbcType=REAL},
      </if>
      <if test="itemType != null" >
        #{itemType,jdbcType=VARCHAR},
      </if>
      <if test="addon != null" >
        #{addon,jdbcType=LONGVARCHAR},
      </if>
      <if test="appointment != null">
      	#{appointment,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByExampleSelective" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    update t_order_items
    <set >
      <if test="record.itemId != null" >
        item_id = #{record.itemId,jdbcType=INTEGER},
      </if>
      <if test="record.orderId != null" >
        order_id = #{record.orderId,jdbcType=BIGINT},
      </if>
      <if test="record.productId != null" >
        product_id = #{record.productId,jdbcType=INTEGER},
      </if>
      <if test="record.bn != null" >
        bn = #{record.bn,jdbcType=VARCHAR},
      </if>
      <if test="record.name != null" >
        name = #{record.name,jdbcType=VARCHAR},
      </if>
      <if test="record.price != null" >
        price = #{record.price,jdbcType=DECIMAL},
      </if>
      <if test="record.gPric != null" >
        g_pric = #{record.gPric,jdbcType=DECIMAL},
      </if>
      <if test="record.cost != null" >
        cost = #{record.cost,jdbcType=DECIMAL},
      </if>
      <if test="record.amount != null" >
        amount = #{record.amount,jdbcType=DECIMAL},
      </if>
      <if test="record.score != null" >
        score = #{record.score,jdbcType=INTEGER},
      </if>
      <if test="record.weight != null" >
        weight = #{record.weight,jdbcType=INTEGER},
      </if>
      <if test="record.nums != null" >
        nums = #{record.nums,jdbcType=REAL},
      </if>
      <if test="record.sendnum != null" >
        sendnum = #{record.sendnum,jdbcType=REAL},
      </if>
      <if test="record.itemType != null" >
        item_type = #{record.itemType,jdbcType=VARCHAR},
      </if>
      <if test="record.addon != null" >
        addon = #{record.addon,jdbcType=LONGVARCHAR},
      </if>
      <if test="test=record.appointment !=null">
      	appointment = #{record.appointment,jdbcType=VARCHAR},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExampleWithBLOBs" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    update t_order_items
    set item_id = #{record.itemId,jdbcType=INTEGER},
      order_id = #{record.orderId,jdbcType=BIGINT},
      product_id = #{record.productId,jdbcType=INTEGER},
      bn = #{record.bn,jdbcType=VARCHAR},
      name = #{record.name,jdbcType=VARCHAR},
      price = #{record.price,jdbcType=DECIMAL},
      g_pric = #{record.gPric,jdbcType=DECIMAL},
      cost = #{record.cost,jdbcType=DECIMAL},
      amount = #{record.amount,jdbcType=DECIMAL},
      score = #{record.score,jdbcType=INTEGER},
      weight = #{record.weight,jdbcType=INTEGER},
      nums = #{record.nums,jdbcType=REAL},
      sendnum = #{record.sendnum,jdbcType=REAL},
      item_type = #{record.itemType,jdbcType=VARCHAR},
      addon = #{record.addon,jdbcType=LONGVARCHAR},
      appointment = #{record.appointment,jdbcType=VARCHAR},
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    update t_order_items
    set item_id = #{record.itemId,jdbcType=INTEGER},
      order_id = #{record.orderId,jdbcType=BIGINT},
      product_id = #{record.productId,jdbcType=INTEGER},
      bn = #{record.bn,jdbcType=VARCHAR},
      name = #{record.name,jdbcType=VARCHAR},
      price = #{record.price,jdbcType=DECIMAL},
      g_pric = #{record.gPric,jdbcType=DECIMAL},
      cost = #{record.cost,jdbcType=DECIMAL},
      amount = #{record.amount,jdbcType=DECIMAL},
      score = #{record.score,jdbcType=INTEGER},
      weight = #{record.weight,jdbcType=INTEGER},
      nums = #{record.nums,jdbcType=REAL},
      sendnum = #{record.sendnum,jdbcType=REAL},
      item_type = #{record.itemType,jdbcType=VARCHAR},
      appointment = #{record.appointment,jdbcType=VARCHAR}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.cnit.yoyo.model.order.OrderItems" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    update t_order_items
    <set >
      <if test="orderId != null" >
        order_id = #{orderId,jdbcType=BIGINT},
      </if>
      <if test="productId != null" >
        product_id = #{productId,jdbcType=INTEGER},
      </if>
      <if test="bn != null" >
        bn = #{bn,jdbcType=VARCHAR},
      </if>
      <if test="name != null" >
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="price != null" >
        price = #{price,jdbcType=DECIMAL},
      </if>
      <if test="gPric != null" >
        g_pric = #{gPric,jdbcType=DECIMAL},
      </if>
      <if test="cost != null" >
        cost = #{cost,jdbcType=DECIMAL},
      </if>
      <if test="amount != null" >
        amount = #{amount,jdbcType=DECIMAL},
      </if>
      <if test="score != null" >
        score = #{score,jdbcType=INTEGER},
      </if>
      <if test="weight != null" >
        weight = #{weight,jdbcType=INTEGER},
      </if>
      <if test="nums != null" >
        nums = #{nums,jdbcType=REAL},
      </if>
      <if test="sendnum != null" >
        sendnum = #{sendnum,jdbcType=REAL},
      </if>
      <if test="itemType != null" >
        item_type = #{itemType,jdbcType=VARCHAR},
      </if>
      <if test="addon != null" >
        addon = #{addon,jdbcType=LONGVARCHAR},
      </if>
      <if test="itemType != null" >
        appointment = #{appointment,jdbcType=VARCHAR},
      </if>
    </set>
    where item_id = #{itemId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.cnit.yoyo.model.order.OrderItems" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    update t_order_items
    set order_id = #{orderId,jdbcType=BIGINT},
      product_id = #{productId,jdbcType=INTEGER},
      bn = #{bn,jdbcType=VARCHAR},
      name = #{name,jdbcType=VARCHAR},
      price = #{price,jdbcType=DECIMAL},
      g_pric = #{gPric,jdbcType=DECIMAL},
      cost = #{cost,jdbcType=DECIMAL},
      amount = #{amount,jdbcType=DECIMAL},
      score = #{score,jdbcType=INTEGER},
      weight = #{weight,jdbcType=INTEGER},
      nums = #{nums,jdbcType=REAL},
      sendnum = #{sendnum,jdbcType=REAL},
      item_type = #{itemType,jdbcType=VARCHAR},
      addon = #{addon,jdbcType=LONGVARCHAR},
      appointment = #{appointment,jdbcType=VARCHAR},
    where item_id = #{itemId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.cnit.yoyo.model.order.OrderItems" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 15 11:23:44 CST 2015.
    -->
    update t_order_items
    set order_id = #{orderId,jdbcType=BIGINT},
      product_id = #{productId,jdbcType=INTEGER},
      bn = #{bn,jdbcType=VARCHAR},
      name = #{name,jdbcType=VARCHAR},
      price = #{price,jdbcType=DECIMAL},
      g_pric = #{gPric,jdbcType=DECIMAL},
      cost = #{cost,jdbcType=DECIMAL},
      amount = #{amount,jdbcType=DECIMAL},
      score = #{score,jdbcType=INTEGER},
      weight = #{weight,jdbcType=INTEGER},
      nums = #{nums,jdbcType=REAL},
      sendnum = #{sendnum,jdbcType=REAL},      
      item_type = #{itemType,jdbcType=VARCHAR},
      appointment = #{appointment,jdbcType=VARCHAR}
    where item_id = #{itemId,jdbcType=INTEGER}
  </update>
  
  
   <resultMap id="ItemsResultMap" type="com.cnit.yoyo.model.order.OrderItems" >
    <id column="item_id" property="itemId" jdbcType="INTEGER" />
    <result column="order_id" property="orderId" jdbcType="BIGINT" />
    <result column="product_id" property="productId" jdbcType="INTEGER" />
    <result column="bn" property="bn" jdbcType="VARCHAR" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="price" property="price" jdbcType="DECIMAL" />
    <result column="g_pric" property="gPric" jdbcType="DECIMAL" />
    <result column="cost" property="cost" jdbcType="DECIMAL" />
    <result column="amount" property="amount" jdbcType="DECIMAL" />
    <result column="score" property="score" jdbcType="INTEGER" />
    <result column="weight" property="weight" jdbcType="INTEGER" />
    <result column="nums" property="nums" jdbcType="REAL" />
    <result column="sendnum" property="sendnum" jdbcType="REAL" />
    <result column="item_type" property="itemType" jdbcType="VARCHAR" />
	
	<result column="product_name" property="product.name" jdbcType="VARCHAR" />
	<result column="product_id" property="product.productId" jdbcType="VARCHAR" />
	<result column="status" property="order.status" jdbcType="INTEGER" />
	<result column="ship_status" property="order.shipStatus" jdbcType="INTEGER" />
	<result column="pay_status" property="order.payStatus" jdbcType="INTEGER" />
	<result column="createtime" property="order.createtime" jdbcType="INTEGER" />
	<result column="ship_name" property="order.shipName" jdbcType="INTEGER" />
	<result column="order_id" property="order.orderId" jdbcType="INTEGER" />
  </resultMap>
  
  <sql id="Items_Column_List" >
    item_id,t_order_items.order_id,t_order_items.product_id,t_order_items.bn,t_order_items.name,t_order_items.price,t_order_items.g_pric,t_order_items.cost,t_order_items.amount,t_order_items.score,t_order_items.weight,t_order_items.nums,t_order_items.sendnum,t_order_items.item_type 
  </sql>
  
  <sql id="Order_Column_List">    
	t_orders.ship_status,t_orders.is_delivery,t_orders.discount_value,t_orders.createtime,t_orders.last_modified,t_orders.payment,t_orders.shipping_id,t_orders.
    shipping,t_orders.status,t_orders.confirm,t_orders.ship_area,t_orders.ship_name,t_orders.weight,t_orders.tostr,t_orders.itemnum,t_orders.ip,t_orders.ship_addr,t_orders.
    ship_zip,t_orders.ship_tel,t_orders.ship_email,t_orders.ship_time,t_orders.ship_mobile,t_orders.cost_item,t_orders.is_coupons,t_orders.cost_tax,t_orders.
    tax_company,t_orders.is_protect,t_orders.cost_protect,t_orders.cost_payment,t_orders.currency,t_orders.cur_rate,t_orders.score_u,t_orders.
    score_g,t_orders.discount,t_orders.pmt_goods,t_orders.pmt_order,t_orders.payed,t_orders.memo,t_orders.disabled,t_orders.mark_type,t_orders.mark_text,t_orders.
    cost_freight,t_orders.extend,t_orders.order_refer,t_orders.addon,t_orders.source,t_orders.confirm_time,t_orders.comments_count,t_orders.refund_status,t_orders.
    act_id,t_orders.order_type,t_orders.is_extend,t_orders.order_kind
  </sql>
  
  <sql id="Product_Column_List">
	  t_products.product_id,t_products.goods_id,t_products.barcode,t_products.title,t_products.bn,t_products.price,t_products.cost,t_products.mktprice,t_products.name as product_name,t_products.weight,t_products.unit,t_products.store,t_products.store_place,t_products.freez,t_products.goods_type,t_products.last_modify,t_products.uptime,t_products.disabled,t_products.marketable
  </sql>
  
  <select id="selectOrderItemsInfo" parameterType="java.util.Map" resultMap="ItemsResultMap">
    select 
	   <include refid="Items_Column_List" />
	   ,
	   <include refid="Order_Column_List" />
	   ,
	   <include refid="Product_Column_List" />
	from 
		t_order_items,
		t_orders,
		t_products
	where
		t_order_items.order_id = t_orders.order_id
	and 
		t_order_items.product_id = t_products.product_id
	<if test="orderId != null and orderId != ''">
		and  t_orders.order_id LIKE CONCAT('%', #{orderId,jdbcType=VARCHAR},'%')
	</if>
		
  </select>
 
  <select id="selectProductIdFromSameOrder" parameterType="java.lang.Integer" resultType="java.lang.Integer">
    	<!-- select DISTINCT ii.product_id
		from t_order_items i
		left join t_order_items ii on i.order_id = ii.order_id and i.product_id != ii.product_id
		where i.product_id = #{productId} and ii.product_id is not null
		order by ii.item_id desc -->
		
		select distinct i.product_id 
		from t_order_items i join t_orders o on i.order_id = o.order_id
		left join t_products p on i.product_id = p.product_id
		left join t_goods g on g.GOODS_ID = p.goods_id
		left join 
			t_business_storemanger s on s.store_id = if(substring_index(p.spec_desc,'|分店:',-1) = p.spec_desc or p.spec_desc is null or p.spec_desc ='', g.store_id, substring_index(substring_index(p.spec_desc,'|分店:',-1),'|',1))
		where (p.disabled!=1 or p.disabled is null) and (g.DISABLED !=1 or g.DISABLED is null) and 
			i.product_id != #{productId} and o.parent_order_id in(
			select distinct o.parent_order_id 
			from t_orders o,t_order_items i 
			where o.order_id=i.order_id and i.product_id =#{productId}
			and o.parent_order_id is not null)
			and (s.limit_store !=1 or s.limit_store is null) and (s.limit_storedown !=1 or s.limit_storedown is null)
			and (s.shopstatus !=1 or s.shopstatus is null) and (s.status !=1 or s.status is null) and (s.disabled !=1 or s.disabled is null)
		<!-- group by p.goods_id -->
		order by i.item_id desc
		
  </select>
  
  <select id="selectSaleCountByGoodsIdAndStatus" resultType="java.lang.Integer" >
    select ifnull(sum(i.nums),0) from t_order_items i 
	left join t_orders o on i.order_id = o.order_id
	left join t_products p on i.product_id =p.product_id
	where o.status = #{status} and p.goods_id = #{goodsId}
  </select>
 
 <select id="selectActivityGoodsCount" resultType="java.lang.Integer" parameterType="java.util.Map">
	 SELECT
		COUNT(items.item_id)
	FROM
		t_order_items items
	LEFT JOIN t_orders orders ON items.order_id = orders.order_id
	WHERE
		item_type = #{itemType}
	AND
		items.product_id=#{productId}
	AND
		orders.MEMBER_ID = #{memberId}
 </select>
 
 
</mapper>