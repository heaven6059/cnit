<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cnit.yoyo.dao.car.CarDataCatalogMapper" >
  <resultMap id="BaseResultMap" type="com.cnit.yoyo.model.car.CarDataCatalog" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Mar 31 11:31:07 CST 2015.
    -->
    <id column="catalog_id" property="catalogId" jdbcType="INTEGER" />
    <result column="order_id" property="orderId" jdbcType="INTEGER" />
    <result column="catalog_name" property="catalogName" jdbcType="VARCHAR" />
    <result column="disabled" property="disabled" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Mar 31 11:31:07 CST 2015.
    -->
    catalog_id, order_id, catalog_name, disabled
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Mar 31 11:31:07 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    from t_car_data_catalog
    where catalog_id = #{catalogId,jdbcType=INTEGER}
  </select>
 
  <insert id="insert" parameterType="com.cnit.yoyo.model.car.CarDataCatalog" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Mar 31 11:31:07 CST 2015.
    -->
    insert into t_car_data_catalog (catalog_id, order_id, catalog_name, 
      disabled)
    values (#{catalogId,jdbcType=INTEGER}, #{orderId,jdbcType=INTEGER}, #{catalogName,jdbcType=VARCHAR}, 
      #{disabled,jdbcType=VARCHAR})
  </insert>
 
 
  <update id="updateByPrimaryKey" parameterType="com.cnit.yoyo.model.car.CarDataCatalog" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Mar 31 11:31:07 CST 2015.
    -->
    update t_car_data_catalog
    set order_id = #{orderId,jdbcType=INTEGER},
      catalog_name = #{catalogName,jdbcType=VARCHAR},
      disabled = #{disabled,jdbcType=VARCHAR}
    where catalog_id = #{catalogId,jdbcType=INTEGER}
  </update>
  
  <resultMap id="CarDataCatalogDTOResultMap" type="com.cnit.yoyo.model.car.dto.CarDataCatalogDTO" extends="BaseResultMap">
  		<collection property="carDatas" ofType="com.cnit.yoyo.model.car.CarData">
	  		<result column="data_id" property="dataId"/>
  			<result column="display_name" property="displayName"/>
  		</collection>
  </resultMap>
  
  <select id="selectCarDataCatalog" resultMap="CarDataCatalogDTOResultMap">
  	SELECT
		catalog.catalog_id,
		catalog.catalog_name,
		data_index.display_name,	
		data_index.data_id
	FROM
		t_car_data_catalog catalog
	INNER JOIN t_car_data_index data_index ON catalog.catalog_id = data_index.catalog_id
	WHERE catalog.disabled=0 AND data_index.disabled=0
	ORDER BY catalog.order_id,data_index.order_id DESC
  </select>
  
  <resultMap id="CarDataDTOResultMap" type="com.cnit.yoyo.model.car.dto.CarDataCatalogDTO" extends="BaseResultMap">
  		<collection property="carDataDTOs" ofType="com.cnit.yoyo.model.car.dto.CarDataDTO">
  			<result column="data_id" jdbcType="INTEGER" property="dataId" />
    		<result column="data_type" jdbcType="VARCHAR" property="dataType" />
    		<result column="order_id" jdbcType="INTEGER" property="orderId" />
    		<result column="dataformat" jdbcType="VARCHAR" property="dataformat" />
    		<result column="display_name" jdbcType="VARCHAR" property="displayName" />
    		<result column="list_id" jdbcType="INTEGER" property="listId" />
    		<result column="catalog_id" jdbcType="INTEGER" property="catalogId" />
    		<result column="disabled" jdbcType="VARCHAR" property="disabled" />
    		<result column="createtime" jdbcType="TIMESTAMP" property="createtime" />
	  		<result column="catalog_name" jdbcType="VARCHAR" property="catalogName" />
     		<result column="data" jdbcType="VARCHAR" property="listValue" />
     		<result column="list_name" jdbcType="VARCHAR" property="listName" />
  		</collection>
  </resultMap>
  
  <select id="findEditList" resultMap="CarDataDTOResultMap">
  SELECT
		catalog.catalog_id,
		catalog.catalog_name,
		data_index.data_id,
		data_index.display_name,	
		data_index.data_type,
		data_index.order_id,
		data_index.createtime,
		data_index.dataformat,
		data_index.disabled,
		data_index.list_id,
		data_list.list_name,
		data_list.data
	FROM
		t_car_data_catalog catalog
	JOIN t_car_data_index data_index ON catalog.catalog_id = data_index.catalog_id
	left join t_car_data_list data_list on data_index.list_id = data_list.list_id
	WHERE catalog.disabled=0 AND data_index.disabled=0
	ORDER BY catalog.order_id,data_index.order_id DESC
        <!-- select 
       data_id, data_type, tcd.order_id,tcd.createtime, dataformat, display_name, tcd.list_id, tcd.catalog_id, tcd.disabled,
       tcdc.catalog_name,data, tcdl.list_name
        from t_car_data_index tcd join t_car_data_catalog tcdc on tcd.catalog_id = tcdc.catalog_id
        left join t_car_data_list tcdl on tcd.list_id = tcdl.list_id
        where  tcd.disabled='0' 
        ORDER BY tcdc.order_id,tcd.order_id DESC -->
  </select>
  
   <!-- 查询所有 -->
  <select id="findList" resultMap="BaseResultMap" parameterType="com.cnit.yoyo.model.car.CarDataCatalog">
     select 
    <include refid="Base_Column_List" />
    from t_car_data_catalog
    where disabled = '0'
    <if test="catalogName!=null and catalogName!='' "> 
    and   catalog_name LIKE CONCAT('%', #{catalogName,jdbcType=VARCHAR},'%')
    </if>
    <if test="orderStmt != null">
		ORDER BY ${orderStmt}
	</if>
  </select>
  
  
   <!-- 查找是否有同名的 -->
  <select id="findByName" resultType="java.lang.Integer" parameterType="com.cnit.yoyo.model.car.CarDataCatalog">
        select count(catalog_id) from t_car_data_catalog 
        where disabled='0' and  catalog_name = #{catalogName,jdbcType=VARCHAR}
        <if test="catalogId !=null and catalogId !=0 ">
             and catalog_id != #{catalogId,jdbcType=INTEGER}
        </if>
  </select>
  
  <!-- 插入 -->
   <insert id="insertSelective" parameterType="com.cnit.yoyo.model.car.CarDataCatalog" >
   
    insert into t_car_data_catalog
    <trim prefix="(" suffix=")" suffixOverrides="," >
     
      <if test="orderId != null and orderId!=0" >
        order_id,
      </if>
      <if test="catalogName != null and catalogName!='' " >
        catalog_name,
      </if>
      <if test="disabled != null and disabled!='' " >
        disabled,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
     
      <if test="orderId != null and orderId!=0" >
        #{orderId,jdbcType=INTEGER},
      </if>
      <if test="catalogName != null  and catalogName!=''" >
        #{catalogName,jdbcType=VARCHAR},
      </if>
      <if test="disabled != null and disabled!=''" >
        #{disabled,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  
  <!-- 逻辑删除 -->
   <update id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
   
    update  t_car_data_catalog set disabled='1' 
    where catalog_id = #{catalogId,jdbcType=INTEGER}
  </update>
  
  
   <update id="updateByPrimaryKeySelective" parameterType="com.cnit.yoyo.model.car.CarDataCatalog" >
 
    update t_car_data_catalog
    <set >
      <if test="orderId != null and orderId!=0" >
        order_id = #{orderId,jdbcType=INTEGER},
      </if>
      <if test="catalogName != null  and catalogName!=''" >
        catalog_name = #{catalogName,jdbcType=VARCHAR},
      </if>
      <if test="disabled != null and disabled!=''" >
        disabled = #{disabled,jdbcType=VARCHAR},
      </if>
    </set>
    where catalog_id = #{catalogId,jdbcType=INTEGER}
  </update>
</mapper>