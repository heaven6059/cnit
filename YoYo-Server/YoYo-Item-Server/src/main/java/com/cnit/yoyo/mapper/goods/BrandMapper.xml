<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cnit.yoyo.dao.goods.BrandMapper">
  <resultMap id="BaseResultMap" type="com.cnit.yoyo.model.goods.Brand">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Mar 21 17:41:17 CST 2015.
    -->
    <id column="brand_id" jdbcType="INTEGER" property="brandId" />
    <result column="brand_name" jdbcType="VARCHAR" property="brandName" />
    <result column="brand_type" jdbcType="INTEGER" property="brandType" />
    <result column="brand_url" jdbcType="VARCHAR" property="brandUrl" />
    <result column="brand_desc" jdbcType="VARCHAR" property="brandDesc" />
    <result column="brand_logo" jdbcType="VARCHAR" property="brandLogo" />
    <result column="brand_aptitude" jdbcType="VARCHAR" property="brandAptitude" />
    <result column="brand_keywords" jdbcType="VARCHAR" property="brandKeywords" />
    <result column="brand_setting" jdbcType="VARCHAR" property="brandSetting" />
    <result column="disabled" jdbcType="VARCHAR" property="disabled" />
    <result column="ordernum" jdbcType="INTEGER" property="ordernum" />
    <result column="fav_count" jdbcType="INTEGER" property="favCount" />
    <result column="title" jdbcType="VARCHAR" property="title" />
    <result column="meta_keywords" jdbcType="VARCHAR" property="metaKeywords" />
    <result column="meta_desc" jdbcType="VARCHAR" property="metaDesc" />
    <result column="brand_pinyin" jdbcType="VARCHAR" property="brandPinyin" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Mar 21 17:41:17 CST 2015.
    -->
    brand_id, brand_name,brand_type, brand_url, brand_desc, brand_logo, brand_aptitude, brand_keywords, 
    brand_setting, disabled, ordernum, fav_count, title, meta_keywords, meta_desc,brand_pinyin
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Mar 21 17:41:17 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    from t_brand
    where brand_id = #{brandId,jdbcType=INTEGER}
  </select>
 
  <insert id="insert" parameterType="com.cnit.yoyo.model.goods.Brand">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Mar 21 17:41:17 CST 2015.
    -->
    insert into t_brand (brand_id, brand_name,brand_type, brand_url, 
      brand_desc, brand_logo, brand_aptitude, 
      brand_keywords, brand_setting, disabled, 
      ordernum, fav_count, title, 
      meta_keywords, meta_desc,brand_pinyin)
    values (#{brandId,jdbcType=INTEGER}, #{brandName,jdbcType=VARCHAR},#{brandType,jdbcType=INTEGER}, #{brandUrl,jdbcType=VARCHAR}, 
      #{brandDesc,jdbcType=VARCHAR}, #{brandLogo,jdbcType=VARCHAR}, #{brandAptitude,jdbcType=VARCHAR}, 
      #{brandKeywords,jdbcType=VARCHAR}, #{brandSetting,jdbcType=VARCHAR}, #{disabled,jdbcType=VARCHAR}, 
      #{ordernum,jdbcType=INTEGER}, #{favCount,jdbcType=INTEGER}, #{title,jdbcType=VARCHAR}, 
      #{metaKeywords,jdbcType=VARCHAR}, #{metaDesc,jdbcType=VARCHAR},#{brandPinyin,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.cnit.yoyo.model.goods.Brand" useGeneratedKeys="true" keyProperty="brandId">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Mar 21 17:41:17 CST 2015.
    -->
    insert into t_brand
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="brandId != null">
        brand_id,
      </if>
      <if test="brandName != null">
        brand_name,
      </if>
      <if test="brandType != null">
        brand_type,
      </if>
      <if test="brandUrl != null">
        brand_url,
      </if>
      <if test="brandDesc != null">
        brand_desc,
      </if>
      <if test="brandLogo != null">
        brand_logo,
      </if>
      <if test="brandAptitude != null">
        brand_aptitude,
      </if>
      <if test="brandKeywords != null">
        brand_keywords,
      </if>
      <if test="brandSetting != null">
        brand_setting,
      </if>
      <if test="disabled != null">
        disabled,
      </if>
      <if test="ordernum != null">
        ordernum,
      </if>
      <if test="favCount != null">
        fav_count,
      </if>
      <if test="title != null">
        title,
      </if>
      <if test="metaKeywords != null">
        meta_keywords,
      </if>
      <if test="metaDesc != null">
        meta_desc,
      </if>
      <if test="brandPinyin != null">
        brand_pinyin,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="brandId != null">
        #{brandId,jdbcType=INTEGER},
      </if>
      <if test="brandName != null">
        #{brandName,jdbcType=VARCHAR},
      </if>
       <if test="brandType != null">
        #{brandType,jdbcType=INTEGER},
      </if>
      <if test="brandUrl != null">
        #{brandUrl,jdbcType=VARCHAR},
      </if>
      <if test="brandDesc != null">
        #{brandDesc,jdbcType=VARCHAR},
      </if>
      <if test="brandLogo != null">
        #{brandLogo,jdbcType=VARCHAR},
      </if>
      <if test="brandAptitude != null">
        #{brandAptitude,jdbcType=VARCHAR},
      </if>
      <if test="brandKeywords != null">
        #{brandKeywords,jdbcType=VARCHAR},
      </if>
      <if test="brandSetting != null">
        #{brandSetting,jdbcType=VARCHAR},
      </if>
      <if test="disabled != null">
        #{disabled,jdbcType=VARCHAR},
      </if>
      <if test="ordernum != null">
        #{ordernum,jdbcType=INTEGER},
      </if>
      <if test="favCount != null">
        #{favCount,jdbcType=INTEGER},
      </if>
      <if test="title != null">
        #{title,jdbcType=VARCHAR},
      </if>
      <if test="metaKeywords != null">
        #{metaKeywords,jdbcType=VARCHAR},
      </if>
      <if test="metaDesc != null">
        #{metaDesc,jdbcType=VARCHAR},
      </if>
      <if test="brandPinyin != null">
        #{brandPinyin,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.cnit.yoyo.model.goods.Brand">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Mar 21 17:41:17 CST 2015.
    -->
    update t_brand
    <set>
      <if test="brandName != null">
        brand_name = #{brandName,jdbcType=VARCHAR},
      </if>
       <if test="brandType != null">
        brand_type = #{brandType,jdbcType=INTEGER},
      </if>
      <if test="brandUrl != null">
        brand_url = #{brandUrl,jdbcType=VARCHAR},
      </if>
      <if test="brandDesc != null">
        brand_desc = #{brandDesc,jdbcType=VARCHAR},
      </if>
      <if test="brandLogo != null">
        brand_logo = #{brandLogo,jdbcType=VARCHAR},
      </if>
      <if test="brandAptitude != null">
        brand_aptitude = #{brandAptitude,jdbcType=VARCHAR},
      </if>
      <if test="brandKeywords != null">
        brand_keywords = #{brandKeywords,jdbcType=VARCHAR},
      </if>
      <if test="brandSetting != null">
        brand_setting = #{brandSetting,jdbcType=VARCHAR},
      </if>
      <if test="disabled != null and disabled !='' ">
        disabled = #{disabled,jdbcType=VARCHAR},
      </if>
      <if test="ordernum != null">
        ordernum = #{ordernum,jdbcType=INTEGER},
      </if>
      <if test="favCount != null">
        fav_count = #{favCount,jdbcType=INTEGER},
      </if>
      <if test="title != null">
        title = #{title,jdbcType=VARCHAR},
      </if>
      <if test="metaKeywords != null">
        meta_keywords = #{metaKeywords,jdbcType=VARCHAR},
      </if>
      <if test="metaDesc != null">
        meta_desc = #{metaDesc,jdbcType=VARCHAR},
      </if>
      <if test="brandPinyin != null">
        brand_pinyin = #{brandPinyin,jdbcType=VARCHAR},
      </if>
    </set>
    where brand_id = #{brandId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.cnit.yoyo.model.goods.Brand">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Mar 21 17:41:17 CST 2015.
    -->
    update t_brand
    set brand_name = #{brandName,jdbcType=VARCHAR},
     brand_type = #{brandType,jdbcType=INTEGER},
      brand_url = #{brandUrl,jdbcType=VARCHAR},
      brand_desc = #{brandDesc,jdbcType=VARCHAR},
      brand_logo = #{brandLogo,jdbcType=VARCHAR},
      brand_aptitude = #{brandAptitude,jdbcType=VARCHAR},
      brand_keywords = #{brandKeywords,jdbcType=VARCHAR},
      brand_setting = #{brandSetting,jdbcType=VARCHAR},
      disabled = #{disabled,jdbcType=VARCHAR},
      ordernum = #{ordernum,jdbcType=INTEGER},
      fav_count = #{favCount,jdbcType=INTEGER},
      title = #{title,jdbcType=VARCHAR},
      meta_keywords = #{metaKeywords,jdbcType=VARCHAR},
      meta_desc = #{metaDesc,jdbcType=VARCHAR},
      brand_pinyin = #{brandPinyin,jdbcType=VARCHAR}      
    where brand_id = #{brandId,jdbcType=INTEGER}
  </update>

  
   <update id="deleteByPrimaryKey" >
 
    update t_brand set disabled='1' 
    where brand_id in
        <foreach collection="array" item="brandId" index="index"
            open="(" close=")" separator=",">
            #{brandId}
        </foreach>
  </update>
  <!-- 按名称，别名，网址模糊查询商品品牌 -->
  <select id="findBrandList" resultMap="BaseResultMap" parameterType="com.cnit.yoyo.model.goods.Brand" >
    select 
    <include refid="Base_Column_List" />
    from t_brand where disabled='0' 
   	<if test="brandName != null and brandName!=''" >
       and  brand_name LIKE CONCAT('%', #{brandName,jdbcType=VARCHAR},'%') 
    </if>
    <if test="brandType != null and brandType!=-1" >
       and  brand_type=#{brandType}
    </if>
    <if test="brandUrl != null and brandUrl!=''" >
        and  brand_url LIKE CONCAT('%', #{brandUrl,jdbcType=VARCHAR},'%') 
    </if>
     <if test="brandKeywords != null and brandKeywords!='' " >
        and  brand_keywords LIKE CONCAT('%', #{brandKeywords,jdbcType=VARCHAR},'%') 
    </if>
    
    <if test="brandId != null and brandId!=0" >
        and  brand_id=#{brandId,jdbcType=INTEGER}
    </if>
    <if test="orderStmt != null and orderStmt!=''">
		ORDER BY ${orderStmt}
	</if>
  </select>
  
  
  <!-- 通过品牌名称查找品牌是否存在 ,如果有id，则是修改判断同名-->
  <select id="findBrandByName" resultType="java.lang.Integer" parameterType="com.cnit.yoyo.model.goods.Brand">
  	select count(brand_id) from t_brand where brand_name = #{brandName,jdbcType=VARCHAR} and disabled='0' 
  	<trim prefix="and ">
  	 	<if test="brandType!=null">
  	         brand_type = #{brandType,jdbcType=INTEGER}
  	     </if>
  	    
  	</trim>
  	 <if test="brandId!=0 and brandId!=null">
  	       and  brand_id != #{brandId,jdbcType=INTEGER}
  	  </if>
  </select>
  
  <!-- 根据分类ID查询品牌信息-->
  <select id="findBrandByCatId" resultMap="BaseResultMap" parameterType="com.cnit.yoyo.model.goods.Brand">
  	select <include refid="Base_Column_List" /> 
  	from t_brand brand where brand_id in (select brand_id from t_type_brand_ship where cat_id = #{catId,jdbcType=INTEGER})
  </select>
  
  <select id="selectCarBrand" parameterType="java.util.Map" resultMap="BaseResultMap">
  		SELECT
			 b.brand_id, b.brand_name,b.brand_type, b.brand_url, b.brand_desc, b.brand_logo, b.brand_aptitude, b.brand_keywords, 
    		 b.brand_setting, b.disabled, b.ordernum, b.fav_count, b.title, b.meta_keywords,b.meta_desc,b.brand_pinyin
		FROM
			t_brand b JOIN t_type_brand_ship t ON b.brand_id = t.brand_id
		AND 
			t.identifier = #{identifier,jdbcType=VARCHAR}
		WHERE b.disabled=0
		<if test="pinyin!=null and pinyin!=''">			
			and b.brand_pinyin LIKE CONCAT(#{pinyin,jdbcType=VARCHAR},'%')
		</if>
		GROUP BY b.brand_id
		ORDER BY b.ordernum ASC
  </select> 
  
  <select id="selectAllBrand" resultMap="BaseResultMap"  >
    select *  
    from t_brand where disabled='0' 
  </select>
  
  <select id="selectCarBrandHasGoods" parameterType="java.util.Map" resultMap="BaseResultMap">
  	SELECT
		b.brand_id, b.brand_name,b.brand_type, b.brand_url, b.brand_desc, b.brand_logo, b.brand_aptitude, b.brand_keywords, 
   		b.brand_setting, b.disabled, b.ordernum, b.fav_count, b.title, b.meta_keywords,b.meta_desc,b.brand_pinyin
	FROM
		t_brand b
	INNER JOIN 
		t_goods goods ON goods.BRAND_ID = b.brand_id
	WHERE
		goods.CAR_ID > 0
	AND goods.DISABLED = 0
	AND goods.MARKETABLE = 1
	GROUP BY b.brand_id
  </select>
  
  <!-- 查询id集合的品牌 -->
  <select id="selectByIds" resultMap="BaseResultMap" >
      select * from  t_brand where disabled='0' and brand_id in 
      <foreach collection="array" index="index" item="item" open="(" close=")" separator=",">
      		#{item}
      </foreach>
  </select>
  <select id="selectCarBrandSpiderDataList" resultMap="BaseResultMap">
		SELECT
		b.brand_id, b.brand_name,b.brand_type, b.brand_url, b.brand_desc, b.brand_logo, b.brand_aptitude, b.brand_keywords, 
   		b.brand_setting, b.disabled, b.ordernum, b.fav_count, b.title, b.meta_keywords,b.meta_desc,b.brand_pinyin
		from t_brand_autohome ta INNER JOIN t_brand b on ta.brand_id = b.brand_id
		where ta.brand_id in
	    <foreach collection="list" item="item" index="index" open="(" close=")" separator=",">
			#{item.relationId}
		</foreach>
  </select>
  
  <select id="selectCarBrandSpiderData" parameterType="com.cnit.yoyo.autohome.model.AutohomeCarInfoDTO" resultMap="BaseResultMap">
		SELECT
		b.brand_id, b.brand_name,b.brand_type, b.brand_url, b.brand_desc, b.brand_logo, b.brand_aptitude, b.brand_keywords, 
   		b.brand_setting, b.disabled, b.ordernum, b.fav_count, b.title, b.meta_keywords,b.meta_desc,b.brand_pinyin
		from t_brand_autohome ta INNER JOIN t_brand b on ta.brand_id = b.brand_id
		<if test="relationId !=null and relationId !=0 ">
			where ta.brand_id = #{relationId,jdbcType=INTEGER}
        </if>
  </select>
</mapper>