<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cnit.yoyo.dao.shop.ShopGradeMapper" >
  <resultMap id="BaseResultMap" type="com.cnit.yoyo.model.shop.ShopGrade" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Mar 11 09:58:34 CST 2015.
    -->
    <id column="grade_id" property="gradeId" jdbcType="BIGINT" />
    <result column="shop_nums" property="shopNums" jdbcType="INTEGER" />
    <result column="goods_num" property="goodsNum" jdbcType="VARCHAR" />
    <result column="coupons_num" property="couponsNum" jdbcType="VARCHAR" />
    <result column="theme_num" property="themeNum" jdbcType="VARCHAR" />
    <result column="grade_money" property="gradeMoney" jdbcType="VARCHAR" />
    <result column="grade_name" property="gradeName" jdbcType="VARCHAR" />
    <result column="issue_money" property="issueMoney" jdbcType="VARCHAR" />
    <result column="issue_type" property="issueType" jdbcType="VARCHAR" />
    <result column="experience" property="experience" jdbcType="INTEGER" />
    <result column="default_lv" property="defaultLv" jdbcType="VARCHAR" />
    <result column="certification" property="certification" jdbcType="VARCHAR" />
    <result column="disabled" property="disabled" jdbcType="VARCHAR" />
    <result column="last_modify" property="lastModify" jdbcType="TIMESTAMP" />
    <result column="d_order" property="dOrder" jdbcType="INTEGER" />
  </resultMap>
  <resultMap id="ResultMapWithBLOBs" type="com.cnit.yoyo.model.shop.ShopGrade" extends="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Mar 11 09:58:34 CST 2015.
    -->
    <result column="remark" property="remark" jdbcType="LONGVARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Mar 11 09:58:34 CST 2015.
    -->
    grade_id, shop_nums, goods_num, coupons_num, theme_num, grade_money, grade_name, 
    issue_money, issue_type, experience, default_lv, certification, disabled, last_modify, 
    d_order
  </sql>
  <sql id="Blob_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Mar 11 09:58:34 CST 2015.
    -->
    remark
  </sql>
  <select id="selectByPrimaryKey" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Mar 11 09:58:34 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from t_company_storegrade
    where grade_id = #{gradeId,jdbcType=BIGINT}
  </select>
  <update id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    
    update   t_company_storegrade set disabled = '1'
    where grade_id = #{gradeId,jdbcType=BIGINT}
  </update>
  <insert id="insert" parameterType="com.cnit.yoyo.model.shop.ShopGrade" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Mar 11 09:58:34 CST 2015.
    -->
    insert into t_company_storegrade (grade_id, shop_nums, goods_num, 
      coupons_num, theme_num, grade_money, 
      grade_name, issue_money, issue_type, 
      experience, default_lv, certification, 
      disabled, last_modify, d_order, 
      remark)
    values (#{gradeId,jdbcType=BIGINT}, #{shopNums,jdbcType=INTEGER}, #{goodsNum,jdbcType=VARCHAR}, 
      #{couponsNum,jdbcType=VARCHAR}, #{themeNum,jdbcType=VARCHAR}, #{gradeMoney,jdbcType=VARCHAR}, 
      #{gradeName,jdbcType=VARCHAR}, #{issueMoney,jdbcType=VARCHAR}, #{issueType,jdbcType=VARCHAR}, 
      #{experience,jdbcType=INTEGER}, #{defaultLv,jdbcType=VARCHAR}, #{certification,jdbcType=VARCHAR}, 
      #{disabled,jdbcType=VARCHAR}, #{lastModify,jdbcType=VARCHAR}, #{dOrder,jdbcType=INTEGER}, 
      #{remark,jdbcType=LONGVARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.cnit.yoyo.model.shop.ShopGrade" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Mar 11 09:58:34 CST 2015.
    -->
    insert into t_company_storegrade
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="shopNums != null" >
        shop_nums,
      </if>
      <if test="goodsNum != null" >
        goods_num,
      </if>
      <if test="couponsNum != null" >
        coupons_num,
      </if>
      <if test="themeNum != null" >
        theme_num,
      </if>
      <if test="gradeMoney != null" >
        grade_money,
      </if>
      <if test="gradeName != null" >
        grade_name,
      </if>
      <if test="issueMoney != null" >
        issue_money,
      </if>
      <if test="issueType != null" >
        issue_type,
      </if>
      <if test="experience != null" >
        experience,
      </if>
      <if test="defaultLv != null" >
        default_lv,
      </if>
      <if test="certification != null" >
        certification,
      </if>
      <if test="disabled != null" >
        disabled,
      </if>
      <if test="lastModify != null" >
        last_modify,
      </if>
      <if test="dOrder != null" >
        d_order,
      </if>
      <if test="remark != null" >
        remark,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="shopNums != null" >
        #{shopNums,jdbcType=INTEGER},
      </if>
      <if test="goodsNum != null" >
        #{goodsNum,jdbcType=VARCHAR},
      </if>
      <if test="couponsNum != null" >
        #{couponsNum,jdbcType=VARCHAR},
      </if>
      <if test="themeNum != null" >
        #{themeNum,jdbcType=VARCHAR},
      </if>
      <if test="gradeMoney != null" >
        #{gradeMoney,jdbcType=VARCHAR},
      </if>
      <if test="gradeName != null" >
        #{gradeName,jdbcType=VARCHAR},
      </if>
      <if test="issueMoney != null" >
        #{issueMoney,jdbcType=VARCHAR},
      </if>
      <if test="issueType != null" >
        #{issueType,jdbcType=VARCHAR},
      </if>
      <if test="experience != null" >
        #{experience,jdbcType=INTEGER},
      </if>
      <if test="defaultLv != null" >
        #{defaultLv,jdbcType=VARCHAR},
      </if>
      <if test="certification != null" >
        #{certification,jdbcType=VARCHAR},
      </if>
      <if test="disabled != null" >
        #{disabled,jdbcType=VARCHAR},
      </if>
      <if test="lastModify != null" >
        #{lastModify,jdbcType=VARCHAR},
      </if>
      <if test="dOrder != null" >
        #{dOrder,jdbcType=INTEGER},
      </if>
      <if test="remark != null" >
        #{remark,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.cnit.yoyo.model.shop.ShopGrade" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Mar 11 09:58:34 CST 2015.
    -->
    update t_company_storegrade
    <set >
      <if test="shopNums != null" >
        shop_nums = #{shopNums,jdbcType=INTEGER},
      </if>
      <if test="goodsNum != null" >
        goods_num = #{goodsNum,jdbcType=VARCHAR},
      </if>
      <if test="couponsNum != null" >
        coupons_num = #{couponsNum,jdbcType=VARCHAR},
      </if>
      <if test="themeNum != null" >
        theme_num = #{themeNum,jdbcType=VARCHAR},
      </if>
      <if test="gradeMoney != null" >
        grade_money = #{gradeMoney,jdbcType=VARCHAR},
      </if>
      <if test="gradeName != null" >
        grade_name = #{gradeName,jdbcType=VARCHAR},
      </if>
      <if test="issueMoney != null" >
        issue_money = #{issueMoney,jdbcType=VARCHAR},
      </if>
      <if test="issueType != null" >
        issue_type = #{issueType,jdbcType=VARCHAR},
      </if>
      <if test="experience != null" >
        experience = #{experience,jdbcType=INTEGER},
      </if>
      <if test="defaultLv != null" >
        default_lv = #{defaultLv,jdbcType=VARCHAR},
      </if>
      <if test="certification != null" >
        certification = #{certification,jdbcType=VARCHAR},
      </if>
      <if test="disabled != null" >
        disabled = #{disabled,jdbcType=VARCHAR},
      </if>
      <if test="lastModify != null" >
        last_modify = #{lastModify,jdbcType=TIMESTAMP},
      </if>
      <if test="dOrder != null" >
        d_order = #{dOrder,jdbcType=INTEGER},
      </if>
      <if test="remark != null" >
        remark = #{remark,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where grade_id = #{gradeId,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.cnit.yoyo.model.shop.ShopGrade" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Mar 11 09:58:34 CST 2015.
    -->
    update t_company_storegrade
    set shop_nums = #{shopNums,jdbcType=INTEGER},
      goods_num = #{goodsNum,jdbcType=VARCHAR},
      coupons_num = #{couponsNum,jdbcType=VARCHAR},
      theme_num = #{themeNum,jdbcType=VARCHAR},
      grade_money = #{gradeMoney,jdbcType=VARCHAR},
      grade_name = #{gradeName,jdbcType=VARCHAR},
      issue_money = #{issueMoney,jdbcType=VARCHAR},
      issue_type = #{issueType,jdbcType=VARCHAR},
      experience = #{experience,jdbcType=INTEGER},
      default_lv = #{defaultLv,jdbcType=VARCHAR},
      certification = #{certification,jdbcType=VARCHAR},
      disabled = #{disabled,jdbcType=VARCHAR},
      last_modify = #{lastModify,jdbcType=TIMESTAMP},
      d_order = #{dOrder,jdbcType=INTEGER},
      remark = #{remark,jdbcType=LONGVARCHAR}
    where grade_id = #{gradeId,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.cnit.yoyo.model.shop.ShopGrade" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Mar 11 09:58:34 CST 2015.
    -->
    update t_company_storegrade
    set shop_nums = #{shopNums,jdbcType=INTEGER},
      goods_num = #{goodsNum,jdbcType=VARCHAR},
      coupons_num = #{couponsNum,jdbcType=VARCHAR},
      theme_num = #{themeNum,jdbcType=VARCHAR},
      grade_money = #{gradeMoney,jdbcType=VARCHAR},
      grade_name = #{gradeName,jdbcType=VARCHAR},
      issue_money = #{issueMoney,jdbcType=VARCHAR},
      issue_type = #{issueType,jdbcType=VARCHAR},
      experience = #{experience,jdbcType=INTEGER},
      default_lv = #{defaultLv,jdbcType=VARCHAR},
      certification = #{certification,jdbcType=VARCHAR},
      disabled = #{disabled,jdbcType=VARCHAR},
      last_modify = #{lastModify,jdbcType=TIMESTAMP},
      d_order = #{dOrder,jdbcType=INTEGER}
    where grade_id = #{gradeId,jdbcType=BIGINT}
  </update>
  
  
  <select id="findByType" parameterType="java.lang.String" resultMap="BaseResultMap">
  	select 
    <include refid="Base_Column_List" />
    from t_company_storegrade
    where issue_type = #{issueType,jdbcType=VARCHAR}
  
  </select>
  
  
   <select id="findByCompanyId" parameterType="java.lang.Long" resultMap="BaseResultMap">
  	select 
    <include refid="Base_Column_List" />
    from t_company_storegrade
    where grade_id = (select DISTINCT grade_id from t_company where company_id=#{companyId,jdbcType=VARCHAR})
  
  </select>
  
  <!-- 根据条件查询所有店铺等级 -->
  <select id="findShopGradeByParam" parameterType="com.cnit.yoyo.model.shop.dto.ShopGradeDTO" resultMap="BaseResultMap">
  	select 
    <include refid="Base_Column_List" />
    from t_company_storegrade
    where disabled ='0'
    <if test="shopNums!=null and shopNums!=0"> and <![CDATA[ shop_nums >= #{shopNums,jdbcType=INTEGER}]]></if>
    <if test="maxShopNums!=null and maxShopNums!=0"> and <![CDATA[ shop_nums <= #{maxShopNums,jdbcType=INTEGER}]]></if>
    <if test="shopNums!=null and shopNums!=0"> and <![CDATA[ shop_nums >= #{shopNums,jdbcType=INTEGER}]]></if>
    <if test="maxShopNums!=null and maxShopNums!=0"> and <![CDATA[ shop_nums <= #{maxShopNums,jdbcType=INTEGER}]]></if>
    <if test="experience!=null and experience!=0"> and <![CDATA[ experience >= #{experience,jdbcType=INTEGER}]]></if>
    <if test="maxEexperience!=null and maxEexperience!=0"> and <![CDATA[ experience <= #{maxEexperience,jdbcType=INTEGER}]]></if>
    <if test="issueMoney!=null and issueMoney!=0"> and <![CDATA[ issue_money >= #{issueMoney,jdbcType=INTEGER}]]></if>
    <if test="maxIssueMoney!=null and maxIssueMoney!=0"> and <![CDATA[ issue_money <= #{maxIssueMoney,jdbcType=INTEGER}]]></if>
    <if test="goodsNum!=null and goodsNum!=0"> and <![CDATA[ goods_num >= #{goodsNum,jdbcType=INTEGER}]]></if>
    <if test="maxGoodsNum!=null and maxGoodsNum!=0"> and <![CDATA[ goods_num <= #{maxGoodsNum,jdbcType=INTEGER}]]></if>
    <if test="couponsNum!=null and couponsNum!=0"> and <![CDATA[ coupons_num >= #{couponsNum,jdbcType=INTEGER}]]></if>
    <if test="maxCouponsNum!=null and maxCouponsNum!=0"> and <![CDATA[ coupons_num <= #{maxCouponsNum,jdbcType=INTEGER}]]></if>
    <if test="themeNum!=null and themeNum!=0"> and <![CDATA[ theme_num >= #{themeNum,jdbcType=INTEGER}]]></if>
    <if test="maxThemeNum!=null and maxThemeNum!=0"> and <![CDATA[ theme_num <= #{maxThemeNum,jdbcType=INTEGER}]]></if>
    <if test="gradeMoney!=null and gradeMoney!=0"> and <![CDATA[ grade_money >= #{gradeMoney,jdbcType=INTEGER}]]></if>
    <if test="maxGradeMoney!=null and maxGradeMoney!=0"> and <![CDATA[ grade_money <= #{maxGradeMoney,jdbcType=INTEGER}]]></if>
    
    <if test="gradeName != null and gradeName!=''" >
       and  grade_name LIKE CONCAT('%', #{gradeName,jdbcType=VARCHAR},'%') 
    </if>
    
    <if test="defaultLv != null and defaultLv!=''" >
       and  default_lv =#{defaultLv,jdbcType=VARCHAR} 
    </if>
    <if test="issueType != null and issueType!=''" >
       and  issue_type =#{issueType,jdbcType=VARCHAR} 
    </if>
    order by last_modify desc
  
  </select>
  
   
  <!-- 通过等级名称查找是否存在 ,如果有id，则是修改判断同名-->
  <select id="findByName" resultType="java.lang.Integer" parameterType="com.cnit.yoyo.model.shop.ShopGrade">
  	select count(grade_id) from t_company_storegrade where grade_name = #{gradeName,jdbcType=VARCHAR} and disabled='0' 
  	<trim prefix="and ">
  	     <if test=" gradeId!=null and gradeId!=0 ">
  	         grade_id != #{gradeId,jdbcType=INTEGER}
  	     </if>
  	</trim>
  </select>
</mapper>