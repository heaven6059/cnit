/* @update: 2015-5-28 17:30:30 */ 
function setCardSelectHide(){$("body").bind("click",function(){$(".j_baitiaoList, .j_usedBankList").hide()})}function showErrorMsg(a){$("#showErrMsgSpan").show(),$("#showErrMsgSpan").html(a)}function showActivatPayPwdTip(){$.jdThickBox({type:"text",width:490,height:158,_box:"many02",source:'<div class="mflex"><div class="mc"><s class="icon-warn03"></s><div class="fore"><h3 class="ftx-04">\u5c0a\u656c\u7684\u7528\u6237\u60a8\u597d\uff0c\u4e3a\u4e86\u4fdd\u969c\u60a8\u7684\u8d26\u6237\u8d44\u4ea7\u5b89\u5168\uff0c\u652f\u4ed8\u524d\u8bf7\u60a8\u5f00\u542f\u652f\u4ed8\u5bc6\u7801</h3><p class="ftx-03">\u652f\u4ed8\u5bc6\u7801\u5f00\u542f\u540e\uff0c\u4f7f\u7528\u8d26\u6237\u4e2d\u4f59\u989d\u3001\u793c\u54c1\u5361\u3001\u4f18\u60e0\u5238\u65f6\uff0c\u9700\u8981\u8f93\u5165\u652f\u4ed8\u5bc6\u7801\uff0c\u4e3a\u60a8\u7684\u8d26\u6237\u8d44\u91d1\u52a0\u628a\u9501</p></div><div class="btns"><a href="http://safe.jd.com/user/paymentpassword/safetyCenter.action" class="btn-h2 btn-c2">\u7acb\u5373\u5f00\u542f\u652f\u4ed8\u5bc6\u7801</a></div><div class="extra"></div></div></div>',title:"\u8bf7\u5f00\u901a\u652f\u4ed8\u5bc6\u7801",_close_val:"\xd7",_titleOn:!0})}function isOpenPayPwd(){var a=isCheckedVirtualPay(),e=globalVar.payPwd;0==e.isSearchPayPwd?(e.isOpenPayPwd=!0,$.ajax({type:"GET",url:"userSafePwd.action",data:"",dataType:"json",async:!1,success:function(n){e.isSearchPayPwd=!0,1==n.usedFlag||1==n.dynamicUsedFlag?(1==a&&$("#pv-line-password").show(),e.isOpenPayPwd=!0,e.isSearchPayPwd=!0):(1==a&&$("#noOpenPwdDiv").show(),globalVar.canBeSubmit=!1,e.isOpenPayPwd=!1)},error:function(){1==a&&$("#pv-line-password").show(),e.isOpenPayPwd=!0,e.isSearchPayPwd=!0}})):1==a?1==e.isOpenPayPwd?$("#pv-line-password").show():($("#pv-line-password").hide(),$("#noOpenPwdDiv").show()):($("#pv-line-password").hide(),$("#noOpenPwdDiv").hide())}function reckonOtherCountPay(a){var e=Number($("#virtualPayCountStrong").text());e=a+e,$("#virtualPayCountStrong").html(e.toFixed(2))}function subOtherPay(a){if("checked"!=$("#virtualPayYue").attr("checked")&&"checked"!=$("#virtualPayJingBean").attr("checked")&&"checked"!=$("#virtualPayGangbeng").attr("checked"))$("#virtualPayCountStrong").html("0.00");else{var e=Number($("#virtualPayCountStrong").text());e-=a,$("#virtualPayCountStrong").html(e.toFixed(2))}}function clearCheckBox(a){"bankCard"!=a?bankCard.bankListHide():(payBankcard.emptyErrorTips(),payBankcard.setInputBlur(),paymentUI.setPlaceholder()),"blank_note"!=a&&baiTiao.hide(),"jr_jrb"!=a&&xiaoJinKu.hide(),"balance_com"!=a&&yue.hide(),"jingbean"!=a&&jingBean.hide(),"gangbeng"!=a&&gangBeng.hide(),"wyQianBao"!=a&&wyQianBao.hide(),"balance_com"!=a&&"jingbean"!=a&&"gangbeng"!=a&&"wyQianBao"!=a&&otherPay.hide()}function showRemainTip(){}function getCanPay(a){var e=Number($("#remainShouldPayAmount").val()),n=e-a;return $("#remainShouldPayAmount").val(n.toFixed(2)),$("#remainShouldPayAmountSpan").html(n.toFixed(2)),n>0?n=a:(n=e,$("#remainShouldPayAmount").val("0"),$("#remainShouldPayAmountSpan").html("0")),n}function getCanBackMoney(a){if(""!=a){var e=Number($("#remainShouldPayAmount").val());return e=Number(a)+e,$("#remainShouldPayAmount").val(e.toFixed(2)),$("#remainShouldPayAmountSpan").html(e.toFixed(2)),e}return""}function isCheckedVirtualPay(){var a=!1;return $("input[name=virtualPayType]").each(function(){"checked"==$(this).attr("checked")&&(a=!0,globalVar.payPwd.isValidPayPwd=!0)}),a}function isCombPay(){var a=0;return $("input[name=virtualPayType]").each(function(){"checked"==$(this).attr("checked")&&(a+=1)}),a>=2}function submitPay(){confirmSubmitPay()}function confirmSubmitPay(){try{if(1==globalVar.canBeSubmit){var a=isCheckedVirtualPay();if(1==globalVar.bankCardIsChecked)if(1==globalVar.quickPayIsChecked){if(""==$("#quickpayToken").val())return void $("#submitPayError").html("\u8bf7\u83b7\u53d6\u624b\u673a\u9a8c\u8bc1\u7801");if(!quickValidate.quickpayConfirmValidate())return;$("#cardPayType").val("quick"),$("#cardPayAmountHide").val($("#cardPayAmountStrong").html())}else 0==globalVar.quickPayIsChecked&&($("#cardPayType").val("normal"),$("#cardPayAmountHide").val($("#cardPayAmountStrong").html()));if(submitButton.disable(),1==a){if("checked"==$("#virtualPayBlankNote").attr("checked")&&(""==$("#fenQiPlanHidden").val()||"0"==$("#fenQiPlanHidden").val()))return $("#showErrMsgSpan").html("\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u60a8\u597d\u50cf\u6ca1\u6709\u9009\u62e9\u6b63\u786e\u7684\u767d\u6761\u5206\u671f\u54df^_^\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u65b0\u9009\u62e9\uff01"),void submitButton.enable();""==$("#payPwd").val()?($("#showErrMsgSpan").html("\u8bf7\u8f93\u5165\u652f\u4ed8\u5bc6\u7801"),submitButton.enable()):virtualPay()}else cardPay()}}catch(e){$("#submitPayError").html("\u60a8\u7684\u7f51\u7edc\u597d\u50cf\u4e0d\u7ed9\u529b\u54df\uff01\u8bf7\u5c1d\u8bd5\u5237\u65b0\u540e\u70b9\u51fb\u652f\u4ed8^_^"),$("#submitPayError").fadeOut(5e3,function(){$("#submitPayError").html(""),$("#submitPayError").show("")});var n=$("#paySign").val(),t={quickType:"\u7acb\u5373\u652f\u4ed8",paySign:n,exception:e.name+":"+e.message},i="/quick/jsErrorCatch.action";$.post(i,t,"json")}}function isIE6(){var a=/msie 6/i.test(navigator.userAgent);return a}function virtualPay(){var a="combinationVirtualPay.action",e=$("#payPwd").val().replace(/%/g,"%25").replace(/\+/g,"%2B").replace(/\&/g,"%26"),n=$("#virtualPayForm").serialize()+"&payPwd="+e+"&baiTiaoRepayDate="+$("#baiTiaoRepayDateHide").val()+"&creditVersion="+$("#creditVersion").val(),t=!0;1==globalVar.bankCardIsChecked&&0==globalVar.quickPayIsChecked&&(t=!1),n+=1==globalVar.bankCardIsChecked&&1==globalVar.quickPayIsChecked?"&haveQuickPay=1":"&haveQuickPay=0",$.ajax({type:"post",url:a,data:n,async:t,timeout:25e3,success:function(a){var e=a.result;"success"==e?"quick"==a.cardPayType?(buildVirtualPayList(a),cardPay()):"normal"==a.cardPayType?cardPay():location.href=a.redirectUrl:"failure"==e&&("00100"==a.resultCode?fkGetPhontVerifyCode("1"):"00300"==a.resultCode?showErrorForFK("\u8be5\u8ba2\u5355\u4e0d\u652f\u6301\u6253\u767d\u6761\uff0c\u8bf7\u9009\u62e9\u5176\u4ed6\u652f\u4ed8\u65b9\u5f0f\u3002"):"ECV0101"==a.resultCode?showErrorForFK("\u77ed\u4fe1\u9a8c\u8bc1\u7801\u9519\u8bef\uff0c\u8bf7\u60a8\u6838\u5bf9\u6216\u91cd\u65b0\u83b7\u53d6\u3002"):"E10002"==a.resultCode?showErrorForFK("\u652f\u4ed8\u5bc6\u7801\u9519\u8bef"):"E10003"==a.resultCode?showErrorForFK("\u60a8\u7684\u652f\u4ed8\u5bc6\u7801\u88ab\u9501\u5b9a\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"):"E10004"==a.resultCode?showErrorForFK("\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5"):"L84000"==a.resultCode?showErrorForFK("\u8bf7\u8f93\u5165\u652f\u4ed8\u5bc6\u7801"):"L85000"==a.resultCode?showErrorForFK("\u4eac\u8c46\u5df2\u7ecf\u652f\u4ed8\u8fc7\uff0c\u4e0d\u5141\u8bb8\u518d\u6b21\u4f7f\u7528"):"L85100"==a.resultCode?showErrorForFK("\u4eac\u8c46\u53ea\u80fd\u652f\u4ed8\u5e94\u4ed8\u91d1\u989d\u7684\u4e00\u534a"):"L81001"==a.resultCode?showErrorForFK("\u5f53\u524d\u7528\u6237\u548c\u4e0b\u5355\u7528\u6237\u4e0d\u4e00\u81f4\uff0c\u8bf7\u767b\u9646\u4e0b\u5355\u7528\u6237\u652f\u4ed8"):"L81002"==a.resultCode?showErrorForFK("\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u60a8\u597d\u50cf\u6ca1\u6709\u9009\u62e9\u6b63\u786e\u7684\u767d\u6761\u5206\u671f\u54df^_^\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u65b0\u9009\u62e9\uff01"):"L86000"==a.resultCode?showErrorForFK("\u652f\u4ed8\u8ba2\u5355\u4fe1\u606f\u6821\u9a8c\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"):"L81000"==a.resultCode?showErrorForFK("\u8ba2\u5355\u4e2d\u542b\u6709\u53d7\u9650\u5236\u5546\u54c1\u4e0d\u652f\u6301\u6253\u767d\u6761,\u6216\u8005\u5df2\u8d85\u8fc7\u767d\u6761\u5141\u8bb8\u9650\u989d\uff0c\u8bf7\u9009\u62e9\u5176\u4ed6\u652f\u4ed8\u65b9\u5f0f"):"L80000"==a.resultCode?(buildVirtualPayList(a),paymentUI.showModal("#virtualResultDiv",function(){}),modalAuth.hide(),submitButton.enable()):showErrorForFK("L82000"==a.resultCode?"\u7cfb\u7edf\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5":"L83000"==a.resultCode?"\u8bf7\u9009\u62e9\u865a\u62df\u652f\u4ed8\u65b9\u5f0f\u63d0\u4ea4":"L87000"==a.resultCode?"\u767d\u6761\u652f\u4ed8\u91d1\u989d\u5c0f\u4e8e10\u5143\u65f6\u4e0d\u80fd\u5206\u671f\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u767d\u6761\u5206\u671f":"\u4e0d\u597d\u610f\u601d\uff0c\u7cfb\u7edf\u51fa\u4e86\u70b9\u5c0f\u7455\u75b5\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5^_^"))},error:function(){submitButton.enable()}})}function showErrorForFK(a){fkAuthModal.hideLoading(),$("#messageError_fk").html(a),fkAuthModal.showError(),showErrorMsg(a),submitButton.enable()}function buildVirtualPayList(resultData,quickPayInfo){var html_="";if(null!=resultData&&""!=resultData){var payResList=resultData.virtualPayResList,resList=eval("("+payResList+")"),remainAmount=resultData.remainAmount,cardPayType=resultData.cardPayType,cardPayAmount=resultData.cardPayAmount;if(null!=resList&&""!=resList)for(var i=0;i<resList.length;i++)html_+="<li>",html_+='<span class="p-name">',"jingbean"==resList[i].virtualPayType?html_+="\u4eac\u8c46\u652f\u4ed8":"balance_order"==resList[i].virtualPayType?html_+="\u4f59\u989d\u652f\u4ed8":"blank_note"==resList[i].virtualPayType?html_+="\u767d\u6761\u652f\u4ed8":"jr_jrb"==resList[i].virtualPayType?html_+="\u4eac\u4e1c\u5c0f\u91d1\u5e93\u652f\u4ed8":"GANGBENG"==resList[i].virtualPayType&&(html_+="\u94a2\u955a\u652f\u4ed8"),html_+="</span>",html_+="jingbean"==resList[i].virtualPayType?'<span class="p-money">\u652f\u4ed8 <span>'+resList[i].payAmount/100+"</span> \u5143</span>":'<span class="p-money">\u652f\u4ed8 <span>'+resList[i].payAmount+"</span> \u5143</span>",resList[i].isSuccess&&0==resList[i].isRepeatSubmit?html_+='<span class="p-flag p-success">\u652f\u4ed8\u6210\u529f</span>':(html_+='<span class="p-flag p-failure">\u652f\u4ed8\u5931\u8d25',1==resList[i].isRepeatSubmit&&(html_+=",\u91cd\u590d\u652f\u4ed8"),html_+="</span>"),html_+="</li>";html_+='<span id="quickPayResultInfo">',html_+="</span>"}if($("#quickPayResultInfo"),"quick"==cardPayType||null!=quickPayInfo){var html_1="";html_1+="<li>",html_1+='<span class="p-name">',html_1+="\u5feb\u6377\u652f\u4ed8",html_1+="</span>",(null==cardPayAmount||"undefined"==cardPayAmount)&&(cardPayAmount=$("#cardPayAmountStrong").html()),html_1+='<span class="p-money">\u652f\u4ed8 <span>'+cardPayAmount+"</span> \u5143</span>";var str="\u672a\u6267\u884c";null!=quickPayInfo&&""!=quickPayInfo&&(str=quickPayInfo),html_1+='<span class="p-flag p-failure">'+str+"</span>",html_1+="</li>",$("#quickPayResultInfo").html(html_1)}null==quickPayInfo&&($("#remainAmountSpan").html(remainAmount),$("#virtualPayResultUl").html(html_))}function cardPay(){if(1==globalVar.bankCardIsChecked){if(1==globalVar.quickPayIsChecked)return void quickConfirm.quickpayConfirm();if(0==globalVar.quickPayIsChecked)return void normalBankPaymentConfirm()}}function toQuickPayForm(){$("#wangyinPaySuccess").hide(),$(".ui-modal-mask").remove();var a=$("input[name='bankCode']").val();bankCard.quickCardShow(),payBankcard.selectedQuickBank(a),$(".fast-bank").remove(),$(".main").removeClass("ui-modal-mask-blur")}function combinSubmitPay(){modalAuth.resetInput(),validateSubmitPay()}function quickGetPhontVerifyCode(){if(!$("#ui-button-gray-phoneVerifyCode").hasClass("disable"))if(modalAuth.hideError(),modalAuth.resetInput(),0==globalVar.quickBoundPayFlag){if(modalAuth.setCountdown())return void submitButton.enable();quickConfirm.unboundGetVerifyCode()}else{if(modalAuth.setCountdown())return void submitButton.enable();quickConfirm.boundGetVerifyCode()}}function fkReGetPhontVerifyCode(){if(!$("#ui-button-gray-phoneVerifyCode_fk").hasClass("disable")){if(fkAuthModal.hideError(),fkAuthModal.resetInput(),fkAuthModal.setCountdown())return void submitButton.enable();fkGetPhontVerifyCode("2")}}function fkGetPhontVerifyCode(a){function e(e){if(1==a)if(e.success)fkAuthModal.resetModal(),$("#m15_openBindPhone_fk").html("\uff08\u5df2\u53d1\u9001\u81f3"+e.result.phone+")"),$("#messageError_fk").html(Constants.phoneSendSuccess),fkAuthModal.show(),fkAuthModal.showError();else{submitButton.enable();var n=e.resultCode,t="";t="ECS0104"==n?"\u8be5\u8ba2\u5355\u4e0d\u652f\u6301\u6253\u767d\u6761\uff0c\u8bf7\u9009\u62e9\u5176\u4ed6\u652f\u4ed8\u65b9\u5f0f\u3002":"\u7cfb\u7edf\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002",$("#submitPayError").html(t)}else if(2==a)if(e.success)fkAuthModal.resetInput(),$("#messageError_fk").html(Constants.phoneSendSuccess),fkAuthModal.show(),fkAuthModal.showError();else{var n=e.resultCode,t="";"1231"==n||(t="\u7cfb\u7edf\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002"),$("#messageError_fk").html(t),fkAuthModal.hideLoading(),fkAuthModal.showError(),submitButton.enable()}}var n={amount:$("#baiTiaoCanPay").val(),orderId:$("#orderIdHide").val()},t="/sendMsg.action";$.post(t,n,e,"json")}function validateSubmitPay(){function a(a){null!=a?"0"==a.state?1==globalVar.bankCardIsChecked&&1==globalVar.quickPayIsChecked?(submitButton.disable(),0==globalVar.quickBoundPayFlag?quickConfirm.unboundGetVerifyCode():quickConfirm.boundGetVerifyCode()):virtualPay():"1"==a.state?(submitButton.enable(),$("#showErrMsgSpan").html("\u652f\u4ed8\u5bc6\u7801\u9519\u8bef\u3002")):"2"==a.state?(submitButton.enable(),$("#showErrMsgSpan").html("\u652f\u4ed8\u5bc6\u7801\u88ab\u9501\u5b9a\u3002")):"3"==a.state&&(submitButton.enable(),$("#showErrMsgSpan").html("\u60a8\u7684\u7f51\u7edc\u597d\u50cf\u4e0d\u7ed9\u529b\u54df\uff01\u8bf7\u5c1d\u8bd5\u5237\u65b0\u540e\u70b9\u51fb\u652f\u4ed8^_^")):(submitButton.enable(),$("#submitPayError").html("\u60a8\u7684\u7f51\u7edc\u597d\u50cf\u4e0d\u7ed9\u529b\u54df\uff01\u8bf7\u5c1d\u8bd5\u5237\u65b0\u540e\u70b9\u51fb\u652f\u4ed8^_^"))}try{if(1==globalVar.canBeSubmit){var e=isCheckedVirtualPay();if(1==globalVar.bankCardIsChecked&&(1==globalVar.quickPayIsChecked?($("#cardPayType").val("quick"),$("#cardPayAmountHide").val($("#cardPayAmountStrong").html())):0==globalVar.quickPayIsChecked&&($("#cardPayType").val("normal"),$("#cardPayAmountHide").val($("#cardPayAmountStrong").html()))),submitButton.disable(),1==e){if("checked"==$("#virtualPayBlankNote").attr("checked")&&(""==$("#fenQiPlanHidden").val()||"0"==$("#fenQiPlanHidden").val()))return $("#showErrMsgSpan").html("\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u60a8\u597d\u50cf\u6ca1\u6709\u9009\u62e9\u6b63\u786e\u7684\u767d\u6761\u5206\u671f\u54df^_^\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u65b0\u9009\u62e9\uff01"),void submitButton.enable();if(""==$("#payPwd").val())$("#showErrMsgSpan").html("\u8bf7\u8f93\u5165\u652f\u4ed8\u5bc6\u7801"),submitButton.enable();else{var n=globalVar.contextPath+"/lazy/checkPassword.action",t=$("#payPwd").val(),i={pwd:t};$.post(n,i,a,"json")}}else 1==globalVar.bankCardIsChecked&&(1==globalVar.quickPayIsChecked?(submitButton.disable(),0==globalVar.quickBoundPayFlag?quickConfirm.unboundGetVerifyCode():quickConfirm.boundGetVerifyCode()):cardPay())}}catch(o){$("#submitPayError").html("\u60a8\u7684\u7f51\u7edc\u597d\u50cf\u4e0d\u7ed9\u529b\u54df\uff01\u8bf7\u5c1d\u8bd5\u5237\u65b0\u540e\u70b9\u51fb\u652f\u4ed8^_^"),$("#submitPayError").fadeOut(5e3,function(){$("#submitPayError").html(""),$("#submitPayError").show("")});var r=$("#paySign").val(),i={quickType:"\u7acb\u5373\u652f\u4ed8",paySign:r,exception:o.name+":"+o.message},n="/quick/jsErrorCatch.action";$.post(n,i,"json")}}var payOrder={toggleDetail:function(ele,orderId){var $orderList=$(".j_orderList");$(ele).hasClass("opened")?($orderList.slideUp(300),$(ele).removeClass("opened").html("\u8ba2\u5355\u8be6\u60c5<i></i>")):$.ajax({url:"payOrderInfo.action?orderId="+orderId,type:"get",dataType:"html",error:function(){$("#listPayOrderInfo").html("")},success:function(data){if(null!=data&&""!=data){var obj=eval("("+data+")"),orderAdress=obj.orderAdress,wareName=obj.wareName,receiver=obj.receiver,mobile=obj.mobile;if("undefined"!=orderAdress&&void 0!=orderAdress&&"null"!=orderAdress&&null!=orderAdress&&$("#shdz").text("\u6536\u8d27\u5730\u5740\uff1a"+orderAdress),"undefined"!=wareName&&void 0!=wareName&&"null"!=wareName&&null!=wareName)if(wareName.length>80){var subWareName=wareName.substring(0,80)+"...";$("#spmc").text("\u5546\u54c1\u540d\u79f0\uff1a"+subWareName)}else $("#spmc").text("\u5546\u54c1\u540d\u79f0\uff1a"+wareName);"undefined"!=receiver&&void 0!=receiver&&"null"!=receiver&&null!=receiver&&$("#shr").text("\u6536\u8d27\u4eba\uff1a"+receiver),"undefined"!=mobile&&void 0!=mobile&&"null"!=mobile&&null!=mobile&&$("#mobile").text(mobile),$orderList.slideDown(300),$(ele).addClass("opened").html("\u6536\u8d77\u8be6\u60c5<i></i>")}}})}},bankCard={quickCardShow:function(){globalVar.quickPayIsChecked=!0,$("#quickPayCardMenuLi").hasClass("curr")||(exchangeOtherBankPay(2),$("#normalPayCardDiv").hide(),$("#quickPayCardDiv").show(),$("#normalPayCardMenuLi").removeClass("curr"),$("#quickPayCardMenuLi").addClass("curr"),$("#paySubmit").val("\u7acb\u5373\u652f\u4ed8"),$("#submitPayError").html("\u8bf7\u9009\u62e9\u94f6\u884c\u652f\u4ed8"))},normalPayCardShow:function(){$("#normalPayCardMenuLi").hasClass("curr")||(payBankcard.quickToOther(),$("#normalPayCardDiv").show(),$("#quickPayCardDiv").hide(),$("#quickPayCardMenuLi").removeClass("curr"),$("#normalPayCardMenuLi").addClass("curr"),$("#paySubmit").val("\u7acb\u5373\u652f\u4ed8"),$("#submitPayError").html("\u8bf7\u9009\u62e9\u94f6\u884c\u652f\u4ed8"),globalVar.canBeSubmit=!1,globalVar.quickPayIsChecked=!1)},normalPayCardHide:function(){$("#normalPayCardDiv").hide()},normalPayCardSelected:function(){},bankListHide:function(){$("#ui-checkbox-L-payCard").find("em").removeClass("selected"),$("#payCardBoxDiv").removeClass("paybox-selected"),$("#payCardCheckBoxHidden").val("false"),1==globalVar.quickBoundUserFlag&&($("#pv-line-cvv2").hide(),$("#pay-verify-typeCredit").removeClass("type-credit"),$("#boundPhoneVerifyCode").val(""),$(".j_returnBankUsed").hide(),$(".j_bankUsed").show()),$(".j_bankArea").slideUp(300),globalVar.bankCardIsChecked=!1},checked:function(a){null!=a&&(globalVar.bankCardIsChecked=a),1==globalVar.bankCardIsChecked?(this.bankListHide(),globalVar.bankCardIsChecked=!1):($("#ui-checkbox-L-payCard").find("em").addClass("selected"),$("#payCardBoxDiv").addClass("paybox-selected"),$("#payCardCheckBoxHidden").val("true"),globalVar.bankCardIsChecked=!0),(""==$("#remainShouldPayAmount").val()||"0"==$("#remainShouldPayAmount").val()||"0.00"==$("#remainShouldPayAmount").val())&&(clearCheckBox("bankCard"),isOpenPayPwd()),showTip.remainTip(),null==a&&checkUsedCardVaild()}},reckonVirtual={backBalanceTobaiTiao:function(a){if("checked"==$("#virtualPayBlankNote").attr("checked")&&""!=a){a=Number(a);var e=Number($("#baiTiaoBalanceHide").val()),n=Number($("#baiTiaoCanPay").val());if(e!=n){var t=n+a;if(e>t)n=t,$("#remainShouldPayAmount").val("0"),$("#remainShouldPayAmountSpan").html("0");else{n=e;var i=t-e;$("#remainShouldPayAmount").val(i),$("#remainShouldPayAmountSpan").html(i)}$("#baiTiaoCanPay").val(n.toFixed(2)),$("#baiTiaoCanPayText").html(n.toFixed(2)),baiTiao.fenQi.reckonFee()}baiTiao.fenQi.reloadReckonFenQiPay(!0),baiTiao.baiTiaoManjianChecked($("#fenQiPlanHidden").val()),fenQiShu=baiTiaoInstallmentLimited($("#baiTiaoCanPay").val(),$("#fenQiPlanHidden").val()),$("#fenQiPlanHidden").val(fenQiShu)}},subtractRemain:function(a){var e=a.split(",");for(i=0;i<e.length;i++){if("blank_note"==e[i]&&""==$("#baiTiaoCanPay").val()){var n=Number($("#baiTiaoBalanceHide").val()),t=getCanPay(n);t=t.toFixed(2),$("#baiTiaoCanPayText").html(t),$("#baiTiaoCanPay").val(t)}if("jr_jrb"==e[i]&&""==$("#jrbCanPay").val()){var o=Number($("#jrbBalanceHide").val()),r="";r=getCanPay(o),$("#xjkCanPayStrong").html(r.toFixed(2)),$("#jrbCanPay").val(r.toFixed(2))}if("balance_com"==e[i]){var l=$("#yueCanPay").val();if(""==l||"0"==l||"0.00"==l){var s=Number($("#yueBalanceHide").val()),u=getCanPay(s);$("#yueCanPayStrong").html(u.toFixed(2)),$("#yueCanPay").val(u.toFixed(2));var d=Number($("#virtualPayCountStrong").text());d=u+d,$("#virtualPayCountStrong").html(d.toFixed(2))}}if("gangbeng"==e[i]){var c=$("#gangbengCanPay").val();if(""==c||"0"==c||"0.00"==c){var h=Number($("#coinsBalanceHide").val()),m=getCanPay(h);$("#coinsCanPayStrong").html(m.toFixed(2)),$("#gangbengCanPay").val(m.toFixed(2));var d=Number($("#virtualPayCountStrong").text());d=m+d,$("#virtualPayCountStrong").html(d.toFixed(2))}}if("wyQianBao"==e[i]){var y=$("#wyQianBaoCanPay").val();if(""==y||"0"==y||"0.00"==y){var b=Number($("#wyQianBaoBalanceHide").val()),v=getCanPay(b);$("#wyQianBaoCanPayStrong").html(v.toFixed(2)),$("#wyQianBaoCanPay").val(v.toFixed(2));var d=Number($("#virtualPayCountStrong").text());d=v+d,$("#virtualPayCountStrong").html(d.toFixed(2))}}if("jingbean"==e[i]){var f=$("#jingBeanCanPay").val();if(""==f||"0"==f||"0.00"==f){var p=Number($("#orderShouldPayHide").val()),P=Number(jbToRmb($("#jingbeanBalanceHide").val())),C=p/2;P>C&&(P=C);var k=getCanPay(P);$("#jingBeanCanPayStrong").html(k.toFixed(2)),$("#jingBeanCanPaySpan").html(rmbToJb(k)),$("#jingBeanCanPay").val(k);var d=Number($("#virtualPayCountStrong").text());d=k+d,$("#virtualPayCountStrong").html(d.toFixed(2))}}}},backRemain:function(a){var e=a.split(",");for(i=0;i<e.length;i++){if("blank_note"==e[i]){var n=$("#baiTiaoCanPay").val();""!=n&&(getCanBackMoney(n),$("#baiTiaoCanPay").val(""))}if("jr_jrb"==e[i]){var t=$("#jrbCanPay").val();""!=t&&(getCanBackMoney(t),$("#jrbCanPay").val(""))}if("balance_com"==e[i]){var o=$("#yueCanPay").val();""!=o&&(getCanBackMoney(o),subOtherPay(o),$("#yueCanPay").val(""))}if("gangbeng"==e[i]){var r=$("#gangbengCanPay").val();""!=r&&(getCanBackMoney(r),subOtherPay(r),$("#gangbengCanPay").val(""))}if("wyQianBao"==e[i]){var l=$("#wyQianBaoCanPay").val();""!=l&&(getCanBackMoney(l),subOtherPay(l),$("#wyQianBaoCanPay").val(""))}if("jingbean"==e[i]){var s=$("#jingBeanCanPay").val();""!=s&&(getCanBackMoney(s),subOtherPay(s),$("#jingBeanCanPay").val(""))}}},virtualCanPay:function(a){var e=this;$("input[name=virtualPayType]").each(function(){if("checked"==$(this).attr("checked")){var n=Number($("#remainShouldPayAmount").val());a==$(this).val()&&("0"==n||"0.00"==n)&&clearCheckBox(a),e.subtractRemain($(this).val())}else e.backRemain($(this).val())}),showTip.quickPayCodeTip(),showTip.remainTip(),isOpenPayPwd()}},showTip={quickPayCodeTip:function(){1==globalVar.bankCardIsChecked&&1==globalVar.quickPayIsChecked&&null!=$("#quickpayToken").val()&&""!=$("#quickpayToken").val()&&($("#submitPayError").html("\u94f6\u884c\u5361\u652f\u4ed8\u91d1\u989d\u8c03\u6574\uff0c\u8bf7\u91cd\u65b0\u83b7\u53d6\u624b\u673a\u9a8c\u8bc1\u7801"),$("#quickpayToken").val(""))},userErrTip:function(a,e){null==e||"yes"==e?$("#userTipSpanDiv").show():$("#userTipSpanDiv").hide(),$("#userTipSpan").html(a)},remainTip:function(){var a=$("#remainShouldPayAmount").val();null!=a&&$("#cardPayAmountStrong").text(Number(a).toFixed(2)),"0"==$("#remainShouldPayAmount").val()||"0.00"==$("#remainShouldPayAmount").val()?(this.hide(),bankCard.bankListHide()):0==globalVar.bankCardIsChecked?($("#remainShouldPayMsgDiv").show(),$("#paySubmit").addClass("disable"),globalVar.canBeSubmit=!1):($("#remainShouldPayMsgDiv").hide(),1==globalVar.quickBoundUserFlag?($("#paySubmit").removeClass("disable"),globalVar.canBeSubmit=!0):($("#paySubmit").addClass("disable"),globalVar.canBeSubmit=!1))},show:function(){$("#paySubmit").val("\u7acb\u5373\u652f\u4ed8").addClass("disable"),$("#submitPayError").html("\u8bf7\u9009\u62e9\u94f6\u884c\u652f\u4ed8"),globalVar.canBeSubmit=!1},hide:function(){$("#remainShouldPayMsgDiv").hide(),$("#paySubmit").val("\u7acb\u5373\u652f\u4ed8").removeClass("disable"),$("#submitPayError").html(""),globalVar.canBeSubmit=!0},submitHide:function(){$("#paySubmit").val("\u7acb\u5373\u652f\u4ed8").addClass("disable"),$("#submitPayError").html("\u8be5\u94f6\u884c\u901a\u9053\u6682\u65f6\u4e0d\u80fd\u652f\u4ed8\uff0c\u8bf7\u5c1d\u8bd5\u4f7f\u7528\u5176\u4ed6\u94f6\u884c\u5361\u5b8c\u6210\u652f\u4ed8\u3002"),$("#font-red-cvv2-bound").html(""),globalVar.canBeSubmit=!1},submitShow:function(){$("#paySubmit").val("\u7acb\u5373\u652f\u4ed8").removeClass("disable"),$("#submitPayError").html(""),$("#errorReBind").html(""),globalVar.canBeSubmit=!0}},wangyin={success:function(){paymentUI.showModal("#wangyinPaySuccess",function(){var a=$("input[name='bankCode']").val(),e=$("input[name='commonBankType']").val(),n=$("#quickDebit_"+a).val(),t=$("#quickCredit_"+a).val();if("1"==e)if("undefined"==typeof n||""==n)$("#quickBankPaySpan").hide(),$("#options").hide();else{var i=$("#success-"+a.toLowerCase()).val();"undefined"==i||""==i?($("#quickBankPaySpan").hide(),$("#options").hide()):($("#quickBankPaySpan").text(i+"\u5feb\u6377\u652f\u4ed8"),$("#quickBankPaySpan").show(),$("#options").show())}else if("2"==e)if("undefined"==typeof t||""==t)$("#quickBankPaySpan").hide(),$("#options").hide();else{var i=$("#success-"+a.toLowerCase()).val();"undefined"==i||""==i?($("#quickBankPaySpan").hide(),$("#options").hide()):($("#quickBankPaySpan").text(i+"\u5feb\u6377\u652f\u4ed8"),$("#quickBankPaySpan").show(),$("#options").show())}else $("#quickBankPaySpan").hide(),$("#options").hide()})},error:function(){paymentUI.showModal("#wangyinPayError",function(){})}},submitButton={disable:function(){globalVar.canBeSubmit=!1,$("#loadingDiv").show(),$("#pv-button-submitPay").hide(),$("#showErrMsgSpan").html("")},enable:function(){$("#loadingDiv").hide(),$("#pv-button-submitPay").show(),globalVar.canBeSubmit=!0,$("#cardPayType").val("")}};$(function(){if($(".j_orderTime").length>0){var a=60*$(".j_orderTime").attr("data-time");paymentUI.setOrderCountdown(".j_orderTime",a,function(){})}paymentUI.setPaidPop(function(a){var e=a.find(".ui-pop-content"),n=$(".j_uiPaidPop").attr("data-content");if("undefined"==typeof n){if("undefined"!=e&&void 0!=e&&null!=e){var t=$("input[name='orderId']").val(),i="halfPayList.action?orderId="+t;$.ajax({type:"GET",url:i,dataType:"html",cache:!1,success:function(a){null!=a&&""!=a&&(e.removeClass("loading"),e.html(a),$(".j_uiPaidPop").attr("data-content",a))},error:function(){}})}}else e.removeClass("loading"),e.html(n)})});var modalAuth={modalId:"#verificationModal",show:function(){var a=this;paymentUI.showModal(this.modalId,function(){a.setCountdown(".j_verificationCount"),$(a.modalId).find(".j_modalAuthInput").focus()},function(){a.resetCountdown(),a.resetInput()})},hide:function(){paymentUI.hideModal(this.modalId),this.resetCountdown()},setCountdown:function(){var a=$("#ui-button-gray-phoneVerifyCode");return a.hasClass("disable")?!0:(a.html('<em class="j_authCountdown">60</em>'+Constants.phoneCodeSending),a.addClass("disable"),paymentUI.setAuthCountdown(".j_authCountdown",60,function(){a.html(Constants.phoneCodeResend),a.removeClass("disable")}),!1)},resetCountdown:function(){$(".j_verificationCount").html(Constants.phoneCodeResend),$(".j_verificationCount").removeClass("disable")},showError:function(){$(this.modalId).find(".vc-n-error").show(),$("#clearMessage").show()},hideError:function(){$(this.modalId).find(".vc-n-error").hide(),$("#clearMessage").hide()},showLoading:function(){$(this.modalId).find(".vc-number").addClass("vc-loading")},hideLoading:function(){$(this.modalId).find(".vc-number").removeClass("vc-loading")},resetInput:function(){$(this.modalId).find(".j_modalAuthInput").val("")}};$(function(){var a="keyup",e=navigator.userAgent.toLowerCase();/iphone|ipad|ipod/.test(e)&&(a="input propertychange"),$(".j_modalAuthInput").live(a,function(){var a=$.trim($(this).val());a.length>=6&&(0==globalVar.quickBoundPayFlag?$("#ui-input-unboundPhoneVerifyCode").val(a):$("#ui-input-boundPhoneVerifyCode").val(a),globalVar.canBeSubmit=!0,confirmSubmitPay(),modalAuth.hideError(),modalAuth.showLoading())})}),$("#clearMessage").live("click",function(){modalAuth.resetInput()}),$("#phoneJ_modalClose").live("click",function(){$(".ui-modal-mask").remove(),$("#submitPayError").html(""),$("#errorReBind").hide();var a=$.trim($("#phoneVer_modalAuthInput").val());a.length<6&&submitButton.enable()}),$("#messageClose").live("click",function(){$(".ui-modal-mask").remove(),$("#submitPayError").html(""),$("#errorReBind").hide();var a=$.trim($("#phoneVer_modalAuthInput").val());a.length<6&&submitButton.enable()});var fkAuthModal={modalId:"#MsgModal",show:function(){var a=this;paymentUI.showModal(this.modalId,function(){a.setCountdown("#ui-button-gray-phoneVerifyCode_fk"),$(a.modalId).find("#phoneVer_modalAuthInput_fk").focus()},function(){a.resetCountdown(),a.resetInput()})},hide:function(){paymentUI.hideModal(this.modalId),this.resetCountdown()},setCountdown:function(){var a=$("#ui-button-gray-phoneVerifyCode_fk");return a.hasClass("disable")?!0:(a.html('<em class="j_authCountdown">60</em>'+Constants.phoneCodeSending),a.addClass("disable"),paymentUI.setAuthCountdown(".j_authCountdown",60,function(){a.html(Constants.phoneCodeResend),a.removeClass("disable")}),!1)},resetCountdown:function(){$("#ui-button-gray-phoneVerifyCode_fk").html(Constants.phoneCodeResend),$("#ui-button-gray-phoneVerifyCode_fk").removeClass("disable")},showError:function(){$(this.modalId).find(".vc-n-error").show(),$("#clearMessage_fk").show()},hideError:function(){$(this.modalId).find(".vc-n-error").hide(),$("#clearMessage_fk").hide()},showLoading:function(){$(this.modalId).find(".vc-number").addClass("vc-loading")},hideLoading:function(){$(this.modalId).find(".vc-number").removeClass("vc-loading")},resetInput:function(){$(this.modalId).find("#phoneVer_modalAuthInput_fk").val("")},resetModal:function(){$("#m15_openBindPhone_fk").html(""),$("#messageError_fk").html(""),this.resetInput(),this.resetCountdown(),this.hideError(),this.hideLoading()}};$(function(){var a="keyup",e=navigator.userAgent.toLowerCase();/iphone|ipad|ipod/.test(e)&&(a="input propertychange"),$("#phoneVer_modalAuthInput_fk").live(a,function(){var a=$.trim($(this).val());a.length>=6&&($("#verifCode").val(a),globalVar.canBeSubmit=!0,fkAuthModal.hideError(),fkAuthModal.showLoading(),virtualPay())})}),$("#clearMessage_fk").live("click",function(){fkAuthModal.resetInput()}),$("#phoneJ_modalClose_fk").live("click",function(){$(".ui-modal-mask").remove(),fkAuthModal.resetModal(),$("#submitPayError").html(""),$("#verifCode").val("");var a=$.trim($("#phoneVer_modalAuthInput_fk").val());a.length<6&&submitButton.enable()}),$("#messageClose_fk").live("click",function(){$(".ui-modal-mask").remove(),fkAuthModal.resetModal(),$("#submitPayError").html(""),$("#verifCode").val("");var a=$.trim($("#phoneVer_modalAuthInput_fk").val());a.length<6&&submitButton.enable()});
/* @update: 2015-5-28 17:30:30 */ 
function fenQiDefaultSelected(a,e){1==e?baiTiao.checked(!1,!1,"yes"):(baiTiao.checked(!1,!1,"no"),$("#noFenQiCheckBox").addClass("selected"),$("#fenQiPlanHidden").val(globalVar.defaultFenqiPlan),$("#fenQiFeeInfoDiv").hide())}function initBaiTiao(a){var e="showBaitiao.action",i=globalVar.decryptPaysession;return"1"!=a?("true"==$("#baiTiaoIsEnable").val()?(payBaitiao.setBaitiaoSelect(),fenQiDefaultSelected(globalVar.defaultFenqiPlan,globalVar.fenQiIsChecked),isOpenPayPwd(),baiTiao.checked(!1)):baiTiao.checked(!0),fenQiShu=baiTiaoInstallmentLimited($("#baiTiaoCanPay").val(),$("#fenQiPlanHidden").val()),void $("#fenQiPlanHidden").val(fenQiShu)):((""==i||null==i)&&(i=$("#decryptPaysession").val()),$.ajax({type:"post",url:e,data:{payInfoStr:i},timeout:1e4,success:function(a){if(""!=a)if($("#baiTiaoDivContainer").html(a),"true"==$("#baiTiaoIsEnable").val()){payBaitiao.setBaitiaoSelect(),fenQiDefaultSelected(globalVar.defaultFenqiPlan,globalVar.fenQiIsChecked),baiTiao.checked(!1),isOpenPayPwd();{Number($("#remainShouldPayAmount").val())}}else baiTiao.checked(!0)},error:function(){}}),fenQiShu=baiTiaoInstallmentLimited($("#baiTiaoCanPay").val(),$("#fenQiPlanHidden").val()),$("#fenQiPlanHidden").val(fenQiShu),void 0)}function baiTiaoDeadUser(){var a="/lazy/baiTiaoDeadUserTip.action",e=$("#creditVersion").val();$.ajax({type:"post",url:a,dataType:"json",data:{creditVersion:e},timeout:1e4,async:!1,success:function(a){try{1==a.is30DayConsumer&&(globalVar.isBaiTiaoDeadUser=!0)}catch(e){}},error:function(){}})}function initBalance(){var url="/quick/balanceQueryRequest.action",paySign=$("#paySign").val();$.ajax({type:"post",url:url,data:{paySign:paySign},timeout:5e3,success:function(result){var isSuccess="";try{result=eval("("+result+")"),isSuccess=result.result}catch(e){}"false"==isSuccess?$("#payBalancePayboxDiv").removeClass("paybox"):""!=result&&($("#payBalancePayboxDiv").html(result),$("#payBalancePayboxDiv").show())},error:function(a){$("#payBalancePayboxDiv").removeClass("paybox")}})}function chenshuiyonghuFun(a,e,i){$("#shengshuiUserTips").html(1==a&&""==e&&""==i?" <span style='font-weight:900;color:#FF5D5B;font-size:18px;font-family: Microsoft Yahei;'>\u6253\u767d\u6761 \u8fd4<span style=';font-size:24px'>5</span>\u5143</span>\uff08\u79fb\u52a8\u7aef\u4eac\u5238,30\u65e5\u5185\u5230\u8d26\uff09":"")}function baiTiaoInstallmentLimited(a,e){var i=Number(a);return 10>i?($("[id^='fenQi']").removeClass("selected"),$("[id^='fenQi']").addClass("disable"),$("#noFenQiCheckBox").addClass("selected"),$("#fenQiPlanHidden").val("1"),$("#fenQiFeeInfoDiv").hide(),1):($("[id^='fenQi']").removeClass("disable"),e)}var payBaitiao={setBaitiaoSelect:function(){$(".j_baitiaoSelect").bind("click",function(a){a.stopPropagation(),payBaitiao.showBaitiaoList()})},selectBaitiaoFenqi:function(ele,fenQiShu){try{$("#fenQiPlanHidden").val(fenQiShu),baiTiao.baiTiaoManjianChecked(fenQiShu),fenQiShu=baiTiaoInstallmentLimited($("#baiTiaoCanPay").val(),fenQiShu),$("#fenQiPlanHidden").val(fenQiShu),baiTiao.baiTiaoManjianChecked(fenQiShu);var $pbox=$(ele).parents(".paybox");$(ele).parents().find("li").removeClass("selected"),$pbox.addClass("selected"),$pbox.find(".j_paymentCheck").addClass("selected"),$(".j_baitiaoFenqiCheck").addClass("selected");var isFenqi=!0;if("1"==fenQiShu&&(isFenqi=!1,$("#noFenQiCheckBox").addClass("selected"),$("#fenQiPlanHidden").val("1"),$("#fenQiFeeInfoDiv").hide()),isFenqi){globalVar.fenQiIsChecked=!0;var fenQiFeiJson=$("#fenQiInfoHide"+fenQiShu).val();fenQiFeiJson=eval("("+fenQiFeiJson+")"),baiTiao.fenQi.reckonFee(),$("#selectedFenQiB").html(fenQiShu+"\u671f"),$("#span_em_fenqi").html("\u5206"+fenQiShu+"\u671f"),$("#firstPayAmountSpan").html(fenQiFeiJson.firstPay),$("#feilvSpan").html(fenQiFeiJson.rate+"%"),$("#fenQiFeeInfoDiv").show(),$("#noFenQiFeeInfoDiv").hide(),$("#fenQi"+fenQiShu).addClass("selected")}else $("#span_em_fenqi").html(""),$("#fenQiFeeInfoDiv").hide()}catch(e){$("#submitPayError").html("\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u60a8\u6ca1\u6709\u9009\u62e9\u6b63\u786e\u7684\u5206\u671f\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5!"),$("#submitPayError").fadeOut(5e3,function(){$("#submitPayError").html("").show()});var paySign=$("#paySign").val(),data={quickType:"\u767d\u6761\u9009\u5206\u671f\u51fa\u9519",paySign:paySign,baiTiaoFenQiShu:fenQiShu,exception:e.name+":"+e.message},url="/quick/jsErrorCatch.action";$.post(url,data,"json")}},showBaitiaoList:function(){$(".j_baitiaoList").show()}},baiTiao={hide:function(){$("#baiTiaoCheckBox").find("em").removeClass("selected"),$("#baiTiaoDivContainer").removeClass("paybox-selected"),$("#virtualPayBlankNote").attr("checked",!1),$("#baiTiaoCanPay").attr("name",""),$("#baitiao-selector-fenqi-check").slideUp(300),reckonVirtual.backRemain("blank_note"),globalVar.baiTiaoIsChecked=!1,$("#baiTiaoPayAmountDiv").hide(),$("span[name=baiTiaoHuanKuanRi]").hide(),baiTiao.fenQi.noFenQiChecked(),this.baiTiaoManJianUnChecked()},show:function(){$("#baiTiaoCheckBox").find("em").addClass("selected"),$("#baiTiaoDivContainer").addClass("paybox-selected"),$("#virtualPayBlankNote").attr("checked",!0),$("#baiTiaoCanPay").attr("name","balance"),$("#paybox").addClass("selected"),"1"==globalVar.userType&&$("#baitiao-selector-fenqi-check").slideDown(300),globalVar.baiTiaoIsChecked=!0,"1"==globalVar.userType&&$("span[name=baiTiaoHuanKuanRi]").show(),$("#baiTiaoPayAmountDiv").show()},fenQi:{hover:function(a){$(a).addClass("hover")},removeHover:function(a){$(a).removeClass("hover")},getRealFenQiFee:function(fenQiShu){var fenQiFeiJson=$("#fenQiInfoHide"+fenQiShu).val();fenQiFeiJson=eval("("+fenQiFeiJson+")");var baiTiaoCanPay=$("#baiTiaoCanPay").val(),orderShouldPay=$("#orderShouldPayHide").val(),isYn=Number($("#baiTiaoBalanceHide").val())>Number(orderShouldPay);return $("#baiTiaoCouponCode"+fenQiShu)&&""!=$("#baiTiaoCouponCode"+fenQiShu).val()&&isYn&&(baiTiaoCanPay=Number(orderShouldPay)-Number($("#baiTiaoDiscountAmount"+fenQiShu).val())),baiTiaoFenQiFuWuFei=(baiTiaoCanPay*fenQiFeiJson.rate/100).toFixed(2)},reloadReckonFenQiPay:function(a){var e=Number($("#baiTiaoCanPayText").text()),i=$("#orderShouldPayHide").val(),n=Number($("#baiTiaoBalanceHide").val())>Number(i);($("#orderShouldPayHide").val()!=e||a)&&$("input[name=fenqiindexhidden]").each(function(){var a=$(this).val(),i=baiTiao.fenQi.getRealFenQiFee(a);""!=$("#baiTiaoCouponCode"+a).val()&&n&&(isCombPay()||(e=Number($("#orderShouldPayHide").val())-Number($("#baiTiaoDiscountAmount"+a).val())));var o=(Number(e)/Number(a)+Number(i)).toFixed(2);$("#pl-i-fenqi"+a).html(o+"\u5143/\u671f")})},reckonFee:function(){if(1==globalVar.fenQiIsChecked){if("3.0"==$("#creditVersion").val()){var a=$("#fenQiPlanHidden").val(),e=this.getRealFenQiFee(a);$("#fenQiFuWuFei").html(e)}}},fenQiChecked:function(){$("#baiTiaoCheckBox").find("em").addClass("selected"),$("#baiTiaoDivContainer").addClass("paybox-selected"),$("#fenQiCheckBox").find("em").addClass("selected"),$("#baitiao-selector-fenqi-check").addClass("fenqi-check"),$("#noFenQiCheckBox").find("em").removeClass("selected"),globalVar.fenQiIsChecked=!0},noFenQiChecked:function(){$("#baitiao-selector-fenqi-check").find(".pl-item").removeClass("selected"),$("#noFenQiCheckBox").addClass("selected"),$("#baitiao-selector-fenqi-check").removeClass("fenqi-check"),$("#fenQiPlanHidden").val(globalVar.defaultFenqiPlan),$("#fenQiFeeInfoDiv").hide(),globalVar.fenQiIsChecked=!1},select:function(a){null!=a&&(globalVar.fenQiIsChecked=a),1==globalVar.fenQiIsChecked?this.noFenQiChecked():this.fenQiChecked()}},checked:function(a,e,i){null!=a&&(globalVar.baiTiaoIsChecked=a),1==globalVar.baiTiaoIsChecked?this.hide():("true"==$("#baiTiaoIsEnable").val()&&("yes"==i&&(baiTiao.fenQi.fenQiChecked(),0==globalVar.fenQiIsChecked&&$("#fenQi"+globalVar.defaultFenqiPlan).addClass("selected")),"no"==i&&baiTiao.fenQi.noFenQiChecked(),this.show()),virtualPayCheckedState()),(null==e||1==e)&&reckonVirtual.virtualCanPay("blank_note"),1==globalVar.baiTiaoIsChecked?(baiTiao.baiTiaoManjianChecked("1"),fenQiShu=baiTiaoInstallmentLimited($("#baiTiaoCanPay").val(),$("#fenQiPlanHidden").val()),$("#fenQiPlanHidden").val(fenQiShu)):baiTiao.baiTiaoManJianUnChecked(),this.fenQi.reloadReckonFenQiPay(!0),checkUsedCardVaild()},baiTiaoManJianUnChecked:function(){if(globalVar.baiTiaoMjed&&""!=$("#baiTiaoActivityCode").val()){$("#shengshuiUserTips").html($("#unCheckBaiTiaoCouponInfo").val());var a=Number($("#remainShouldPayAmount").val())+Number($("#baiTiaoDiscountAmount"+globalVar.baiTiaoMjPreFenQiShu).val());$("#remainShouldPayAmount").val(a.toFixed(2)),$("#remainShouldPayAmountSpan").html(a.toFixed(2)),$("#baiTiaoActivityCode").val(""),$("#baiTiaoCouponCode").val(""),$("#baiTiaoDiscountAmount").val(""),globalVar.baiTiaoMjed=!1}},baiTiaoManjianChecked:function(a){var e=$("#baiTiaoActivityType"+a).val(),i=$("#baiTiaoActivityCode"+a).val(),n=$("#baiTiaoCouponCode"+a).val();if("1"!=e&&"2"!=e&&(chenshuiyonghuFun(globalVar.isBaiTiaoDeadUser,n,i),$("#baiTiaoActivityCode").val(""),$("#baiTiaoCouponCode").val(""),$("#baiTiaoDiscountAmount").val("")),(globalVar.baiTiaoMjPreFenQiShu!=a||!globalVar.baiTiaoMjed)&&""!=i||"1"!=e){var o=0;if(o=globalVar.baiTiaoMjed?Number($("#baiTiaoCanPay").val())+Number($("#baiTiaoDiscountAmount"+globalVar.baiTiaoMjPreFenQiShu).val()):$("#baiTiaoCanPay").val(),o==$("#orderShouldPayHide").val()||"1"==e){"1"==e||"2"==e?$("#shengshuiUserTips").html($("#baiTiaoCouponInfo"+a).val()):chenshuiyonghuFun(globalVar.isBaiTiaoDeadUser,n,i);var l=Number(o)-Number($("#baiTiaoDiscountAmount"+a).val());$("#baiTiaoCanPay").val(l.toFixed(2)),$("#baiTiaoCanPayText").html(l.toFixed(2)),$("#baiTiaoActivityCode").val($("#baiTiaoActivityCode"+a).val()),$("#baiTiaoCouponCode").val($("#baiTiaoCouponCode"+a).val()),$("#baiTiaoDiscountAmount").val($("#baiTiaoDiscountAmount"+a).val()),globalVar.baiTiaoMjed=!0,globalVar.baiTiaoMjPreFenQiShu=a}else globalVar.baiTiaoMjed=!1,"2"==e&&(chenshuiyonghuFun(globalVar.isBaiTiaoDeadUser,n,i),$("#baiTiaoActivityCode").val(""),$("#baiTiaoCouponCode").val(""),$("#baiTiaoDiscountAmount").val("")),"1"!=e&&(chenshuiyonghuFun(globalVar.isBaiTiaoDeadUser,n,i),$("#baiTiaoActivityCode").val(""),$("#baiTiaoCouponCode").val(""),$("#baiTiaoDiscountAmount").val(""))}}};
/* @update: 2015-5-28 17:30:30 */ 
function checkUsedCardVaild(){if(1==globalVar.bankCardIsChecked){var e=$("#ub-item-firstBank").children("input[name='payCard-valid']").attr("value");"0"==e?showTip.submitHide():showTip.submitShow()}}var Constants={unSupportCardType:"\u6682\u4e0d\u652f\u6301\u8be5\u94f6\u884c ",cardCheckError:"\u94f6\u884c\u5361\u6821\u9a8c\u6709\u8bef",phoneSendSuccess:"\u77ed\u4fe1\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\uff0c\u8bf7\u6ce8\u610f\u67e5\u6536",phoneCodeResend:"\u91cd\u65b0\u83b7\u53d6\u9a8c\u8bc1\u7801",phoneCodeSending:"\u79d2\u540e\u91cd\u65b0\u83b7\u53d6\u9a8c\u8bc1\u7801",inputCardNo:"\u8bf7\u8f93\u5165\u94f6\u884c\u5361\u53f7",CardNoLengthLess:"\u5361\u53f7\u957f\u5ea6\u4f4d\u6570\u4e0d\u8db3",cardNoFormatError:"\u5361\u53f7\u683c\u5f0f\u4e0d\u6b63\u786e",selectMonth:"\u8bf7\u9009\u62e9\u6709\u6548\u671f\u6708\u4efd",selectYear:"\u8bf7\u9009\u62e9\u6709\u6548\u671f\u5e74\u4efd",inputCVV2:"\u8bf7\u8f93\u5165\u5361\u9a8c\u8bc1\u7801",CVV2LengthLess:"\u5361\u9a8c\u8bc1\u7801\u5fc5\u987b\u4e3a3\u4f4d\u6570\u5b57",CVV2FormatError:"\u5361\u9a8c\u8bc1\u7801\u683c\u5f0f\u4e0d\u6b63\u786e",inputHolderName:"\u8bf7\u8f93\u5165\u59d3\u540d",holderNameFormatError:"\u59d3\u540d\u683c\u5f0f\u4e0d\u6b63\u786e",inputHolderId:"\u8bf7\u8f93\u5165\u8eab\u4efd\u8bc1",holderIdError:"\u8eab\u4efd\u8bc1\u4e0d\u6b63\u786e",inputPhone:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7",phoneLengthLess:"\u624b\u673a\u53f7\u5fc5\u987b\u4e3a11\u4f4d\u6570\u5b57",phoneFormatError:"\u624b\u673a\u53f7\u683c\u5f0f\u4e0d\u6b63\u786e",inputVerifyCode:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",verifyCodeLengthLess:"\u77ed\u4fe1\u9a8c\u8bc1\u7801\u957f\u5ea6\u5fc5\u987b\u4e3a6\u4f4d",verifyCodeFormatError:"\u77ed\u4fe1\u9a8c\u8bc1\u7801\u683c\u5f0f\u4e0d\u6b63\u786e"},nameDate="",payBankcard={setBankSelect:function(){$(".j_usedBankSelect").bind("click",function(e){e.stopPropagation(),$(".j_usedBankList").show()})},exchangeBindCardOrder:function(e){bankCard.checked(!1),globalVar.quickPayIsChecked=!0;var i=$(".ub-list");i.prepend(e),$("#ub-item-firstBank").html(e.innerHTML),$(e).addClass("selected").siblings().removeClass("selected"),$(".j_usedBankList").hide();var a=$(e).find(".bank-logo").attr("id").split("-")[1],t=$("input[name='payCard-cardType']").val();$("#payCard-cardType-bound").val(t),payBankcard.amountLimit(a,t,"bound");var r=$("input[name='phone']").val();$("#m15_openBindPhone").html("\uff08\u5df2\u53d1\u9001\u81f3"+r+")"),globalVar.canBeSubmit&&(1==t?($("#pv-line-cvv2").hide(),$("#pay-verify-typeCredit").removeClass("type-credit"),$("#debit-radio").children("i").attr("id","radio-cardType-1")):($("#pv-line-cvv2").show(),$("#pay-verify-typeCredit").addClass("type-credit"),$("#debit-radio").children("i").attr("id","radio-cardType-2"))),checkUsedCardVaild()},showAllBankList:function(){bankCard.checked(!1),bankCard.quickCardShow(),$(".j_quickBankList").show(),$(".j_quickBankEdit").hide(),globalVar.quickBoundPayFlag=!1,$(".j_bankArea").slideDown(300),$(".j_returnBankUsed").show(),$(".j_bankUsed").hide(),$("#pay-verify-typeCredit").removeClass("type-credit"),$("#pv-line-cvv2").hide(),$("#boundPhoneVerifyCode").val(""),$("#font-red-cvv2-bound").html(""),$("#font-red-verifyCode-bound").html(""),$("#paySubmit").addClass("disable"),$("#submitPayError").html("\u8bf7\u9009\u62e9\u94f6\u884c\u652f\u4ed8"),$("#ui-button-gray-boundPhoneVerifyCode").html("\u83b7\u53d6\u9a8c\u8bc1\u7801").removeClass("disable"),globalVar.canBeSubmit=!1},returnBankUsed:function(){payBankcard.setInputBlur(),payBankcard.quickToOther(),exchangeOtherBankPay(1),globalVar.quickBoundPayFlag=!0,$(".j_bankArea").slideUp(300),$(".j_bankUsed").show(),$(".j_returnBankUsed").hide();var e=$("input[name='payCard-cardType']").val();e&&2==e&&($("#pv-line-cvv2").show(),$("#pay-verify-typeCredit").addClass("type-credit")),$("#paySubmit").val("\u7acb\u5373\u652f\u4ed8").removeClass("disable"),$("#submitPayError").html(""),$("#errorReBind").html(""),checkUsedCardVaild()},cardVerifySuccess:function(e){var i=$("#cardVerifyShort").val().split("-"),a=i[0],t=i[1],r=i[2],n=i[3];1==e?($("#ui-input-cardNo").val(a).cardNoSplitter(),$(".j_bankIdentific").find(".ui-button").removeClass("disable"),$("#bi-i-result-bank").show().html(r),$("#font-red-cardError").html(""),$("#noCardReadminSpan").html("")):($("#font-red-cardNo").html(""),$("#ui-input-cardNo").removeClass("ui-input-error"),$("#input-cardNo-verify").val("true")),$("#bank-selected-quickpay").children(".bank-logo").attr("id","bank-"+t.toLowerCase()),payBankcard.changeCardType(n),payBankcard.amountLimit(t,n,"unbound");var d=$("#quickDebit_"+t).val(),o=$("#quickCredit_"+t).val();""==d?($("#debit-radio").addClass("ui-check-disable j_uiTips"),$("#debit-radio").attr("data-tips","\u8be5\u884c\u6682\u4e0d\u652f\u6301\u50a8\u84c4\u5361\uff0c\u53ef\u4f7f\u7528<a href='javascript:void(0);' onclick='unionPaySubmit();' data-bank='"+t+"'>\u94f6\u8054\u5728\u7ebf</a>\u652f\u4ed8"),$("#credit-radio").removeClass("ui-check-disable")):""==o?($("#credit-radio").addClass("ui-check-disable j_uiTips"),$("#credit-radio").attr("data-tips","\u8be5\u884c\u6682\u4e0d\u652f\u6301\u4fe1\u7528\u5361\uff0c\u53ef\u4f7f\u7528<a href='javascript:void(0);' onclick='unionPaySubmit();' data-bank='"+t+"'>\u94f6\u8054\u5728\u7ebf</a>\u652f\u4ed8"),$("#debit-radio").removeClass("ui-check-disable")):($("#debit-radio").removeClass("ui-check-disable j_uiTips"),$("#credit-radio").removeClass("ui-check-disable j_uiTips"),$("#debit-radio").removeAttr("data-tips"),$("#credit-radio").removeAttr("data-tips"))},editedQuickBank:function(){$(".j_bankIdentific").find(".ui-button").hasClass("disable")||(payBankcard.setInputBlur(),bankCard.quickCardShow(),$(".j_quickBankList").slideUp(300),$(".j_quickBankEdit").slideDown(300),$(".bank-identific").hide(),$(".j_bankEdit").stop(!0).animate({opacity:1},300),$(".j_bankIdentific").stop(!0).animate({opacity:.3},300),$("#paySubmit").val("\u540c\u610f\u5f00\u901a\u5e76\u652f\u4ed8").removeClass("disable"),$("#submitPayError").html(""),$(".ui-magnifying").remove(),globalVar.canBeSubmit=!0)},selectedQuickBank:function(e){function i(e){for(var i=new Object,a=0;a<e.length;a++)i[a]={name:e[a].holderName,value:e[a].holderNameV,idV:e[a].holderId,identity:e[a].holderIdV},nameDate=i;0!=e.length&&(paymentUI.autoComplete({targetClass:".j_name_list",data:i,callback:function(e,i){e.val(i.value),$("#ui-input-holderId").val(i.identity)}}),paymentUI.autoComplete({targetClass:".j_id_list",data:i,callback:function(e,i){e.val(i.identity),$("#ui-input-holderName").val(i.value)}}))}var a=$("#ordeTypeHide").val(),t=1,r=$("#quickDebit_"+e).val(),n=$("#quickCredit_"+e).val();if(""==r?($("#debit-radio").addClass("ui-check-disable j_uiTips"),"84"!=a&&"85"!=a&&$("#debit-radio").attr("data-tips","\u8be5\u884c\u6682\u4e0d\u652f\u6301\u50a8\u84c4\u5361\uff0c\u53ef\u4f7f\u7528<a href='javascript:void(0);' target='_blank' onclick='unionPaySubmit();' data-bank='"+e+"'>\u94f6\u8054\u5728\u7ebf</a>\u652f\u4ed8"),$("#credit-radio").removeClass("ui-check-disable"),t=2):""==n?($("#credit-radio").addClass("ui-check-disable"),"84"!=a&&"85"!=a&&$("#credit-radio").attr("data-tips","\u8be5\u884c\u6682\u4e0d\u652f\u6301\u4fe1\u7528\u5361\uff0c\u53ef\u4f7f\u7528<a href='javascript:void(0);' target='_blank'onclick='unionPaySubmit();' data-bank='"+e+"'>\u94f6\u8054\u5728\u7ebf</a>\u652f\u4ed8"),$("#debit-radio").removeClass("ui-check-disable")):($("#debit-radio").removeClass("ui-check-disable j_uiTips"),$("#credit-radio").removeClass("ui-check-disable j_uiTips"),$("#debit-radio").removeAttr("data-tips"),$("#credit-radio").removeAttr("data-tips")),1==t?($("#debit-radio").children("i").find("em").addClass("selected"),$("#credit-radio").children("i").find("em").removeClass("selected"),$("#quick-form-validity").hide(),$("#quick-form-cvv2").hide(),$("#bw-quick-cardType").removeClass("type-credit")):($("#debit-radio").children("i").find("em").removeClass("selected"),$("#credit-radio").children("i").find("em").addClass("selected"),$("#quick-form-validity").show(),$("#quick-form-cvv2").show(),$("#bw-quick-cardType").addClass("type-credit")),$("#bank-selected-quickpay").children(".bank-logo").attr("id","bank-"+e.toLowerCase()),$("#debit-radio").children("i").attr("id","radio-cardType-"+t),$(".j_quickBankList").slideUp(300),$(".j_quickBankEdit").slideDown(300),$(".bank-identific").hide(),$(".j_bankEdit").stop(!0).animate({opacity:1},300),$(".j_bankIdentific").stop(!0).animate({opacity:.3},300),$("#paySubmit").val("\u540c\u610f\u5f00\u901a\u5e76\u652f\u4ed8").removeClass("disable"),$("#submitPayError").html(""),payBankcard.setInputBlur(),payBankcard.amountLimit(e,t,"unbound"),globalVar.canBeSubmit=!0,1==globalVar.nameListState&&""==nameDate){var d={},o="/quick/nameList.action";$.post(o,d,i,"json")}var u="#promptInfo_"+e;$("#quickBank_promptInfo").html($(u).val())},quickToOther:function(){$(".j_quickBankList").slideDown(300),$(".j_quickBankEdit").slideUp(300),$(".bank-identific").show(),$("#paySubmit").val("\u7acb\u5373\u652f\u4ed8").addClass("disable"),$("#submitPayError").html("\u8bf7\u9009\u62e9\u94f6\u884c\u652f\u4ed8"),payBankcard.ableEditor(),payBankcard.emptyErrorTips(),globalVar.canBeSubmit=!1},amountLimit:function(e,i,a){var t=$("#ub-item-firstBank").children("input[name='payCard-valid']").attr("value");if("0"!=t){var r,n,d=$("#amountLimit_"+e.toUpperCase()).val().split("/");if(1==i?(r=""!=d[0]?"\u5355\u7b14\u9650\u989d "+d[0]:"",n=""!=d[1]?"\u5355\u65e5\u9650\u989d "+d[1]:""):(r=""!=d[2]?"\u5355\u7b14\u9650\u989d "+d[2]:"",n=""!=d[3]?"\u5355\u65e5\u9650\u989d "+d[3]:""),"unbound"==a)$("#amountLimit-single").html(r),$("#amountLimit-day").html(n);else{for(var o=!0,u=1==i?0:2,l=1==i?d.length-2:d.length,s=u;l>s;s++)""!=d[s]&&(o=!1);o?$("#bl-title-amountLimit .j_uiTips").hide():$("#bl-title-amountLimit .j_uiTips").show().attr("data-tips",r+" "+n)}}},changeCardType:function(e){$("#debit-radio").children("i").attr("id","radio-cardType-"+e),1==e?($("#bw-quick-cardType").removeClass("type-credit"),$("#debit-radio").children("i").find("em").addClass("selected"),$("#credit-radio").children("i").find("em").removeClass("selected"),$("#quick-form-validity").hide(),$("#quick-form-cvv2").hide()):($("#bw-quick-cardType").addClass("type-credit"),$("#debit-radio").children("i").find("em").removeClass("selected"),$("#credit-radio").children("i").find("em").addClass("selected"),$("#quick-form-validity").show(),$("#quick-form-cvv2").show())},unableEditor:function(){$("#debit-radio").hide(),$("#credit-radio").hide();var e=1==$("#debit-radio").children("i").attr("id").split("cardType-")[1]?"\u50a8\u84c4\u5361":"\u4fe1\u7528\u5361";$("#unEditor-cardType").html(e),$("#ui-input-cardNo").hide(),$("#unEditor-cardNo").html($("#ui-input-cardNo").val()),$("#ui-input-holderName").hide(),$("#unEditor-holderName").html($("#ui-input-holderName").val()),$("#ui-input-holderId").hide(),$("#unEditor-holderId").html($("#ui-input-holderId").val()),$("#ui-input-phone").hide(),$("#unEditor-phone").html($("#ui-input-phone").val()),2==$("#debit-radio").children("i").attr("id").split("cardType-")[1]&&($("#ui-select-validity").hide(),$("#unEditor-validity").html($("#ui-select-month").val()+"/"+$("#ui-select-year").val()),$("#ui-input-cvv2").hide(),$("#unEditor-cvv2").html("***"))},ableEditor:function(){$("#debit-radio").show(),$("#credit-radio").show(),$("#unEditor-cardType").html(""),$("#ui-input-cardNo").show().val(""),$("#unEditor-cardNo").html(""),$("#ui-input-holderName").show().val(""),$("#unEditor-holderName").html(""),$("#ui-input-holderId").show().val(""),$("#unEditor-holderId").html(""),$("#ui-input-phone").show().val(""),$("#unEditor-phone").html(""),$("#ui-input-unboundPhoneVerifyCode").val(""),2==$("#debit-radio").children("i").attr("id").split("cardType-")[1]&&($("#ui-select-validity").show(),$("#unEditor-validity").html(""),$("#ui-select-month").val("\u9009\u62e9"),$("#ui-select-year").val("\u9009\u62e9"),$("#ui-input-cvv2").show().val(""),$("#unEditor-cvv2").html("")),$("#submitPayError").html(""),paymentUI.setPlaceholder()},emptyErrorTips:function(){$("#font-red-cardNo").html(""),$("#ui-input-cardNo").removeClass("ui-input-error"),$("#font-red-validity").html(""),$("#ui-select-month").removeClass("ui-input-error"),$("#ui-select-year").removeClass("ui-input-error"),$("#font-red-cvv2").html(""),$("#ui-input-cvv2").removeClass("ui-input-error"),$("#font-red-holderName").html(""),$("#ui-input-holderName").removeClass("ui-input-error"),$("#font-red-holderId").html(""),$("#ui-input-holderId").removeClass("ui-input-error"),$("#font-red-phone").html(""),$("#ui-input-phone").removeClass("ui-input-error"),$("#font-red-verifyCode").html(""),$("#ui-input-unboundPhoneVerifyCode").removeClass("ui-input-error"),$("#font-red-cvv2-bound").html(""),$("#pv-input-cvv2").removeClass("ui-input-error"),$("#font-red-verifyCode-bound").html(""),$("#ui-input-boundPhoneVerifyCode").removeClass("ui-input-error")},selectedEBank:function(e,i,a){globalVar.quickPayIsChecked=!1,2==a&&(payBankcard.showAllBankList(),bankCard.normalPayCardShow());$("input[name='payCard-modeType']").val();$("#normalCardPay").val(""),$(".j_eBankList").slideUp(300),$(".j_eBankEdit").slideDown(300),$(".j_eBankEdit").find("span").first().attr("id","bank-"+i.toLowerCase()),$("input[name='seletedAgencyCode']").val(e);var t=$("#normalDebit_"+i).val(),r=$("#normalCredit_"+i).val(),n=1;""==t?($("#nordebit-radio").addClass("ui-check-disable disable"),$("#norcredit-radio").removeClass("ui-check-disable disable"),n=2):""==r?($("#norcredit-radio").addClass("ui-check-disable disable"),$("#nordebit-radio").removeClass("ui-check-disable disable")):($("#nordebit-radio").removeClass("ui-check-disable disable"),$("#norcredit-radio").removeClass("ui-check-disable disable")),1==n?($("#nordebit-radio").children("i").find("em").addClass("selected"),$("#norcredit-radio").children("i").find("em").removeClass("selected")):($("#nordebit-radio").children("i").find("em").removeClass("selected"),$("#norcredit-radio").children("i").find("em").addClass("selected")),virtualPayCheckedState(),setValueBankPayment(i,e),$("#paySubmit").val("\u8df3\u8f6c\u7f51\u94f6\u5e76\u652f\u4ed8").removeClass("disable"),$("#submitPayError").html(""),globalVar.canBeSubmit=!0},setToggleEdit:function(){var e=$(".j_bankIdentific"),i=$(".j_bankEdit");e.bind("mouseenter",function(){i.stop(!0).animate({opacity:.3},300)}).bind("mouseleave",function(){i.stop(!0).animate({opacity:1},300)}),i.bind("mouseenter",function(){e.stop(!0).animate({opacity:.3},300)}).bind("mouseleave",function(){e.stop(!0).animate({opacity:1},300)})},setInputFocus:function(){var e=$(".j_bankIdentific");e.find(".ui-icon-pen").hide(),e.find(".ui-button").show()},setInputBlur:function(){$(".j_bankIdentific").find(".ui-icon-pen").show(),$(".j_bankIdentific").find(".ui-button").addClass("disable").hide(),$("#bi-i-result-bank").html(""),$("#bi-i-text-cardNo").val(""),$("#font-red-cardError").html(""),$("#noCardReadminSpan").html("")},reBind:function(){var e=$(".ub-list .ub-item").find("span").attr("id");(""!=e||"undefined"!=e)&&(e=e.split("-")[1].toUpperCase()),$(".ui-tips").remove(),payBankcard.showAllBankList(),payBankcard.selectedQuickBank(e),modalAuth.hide()}},quickConfirm={verifyCardBinConfirm:function(e){function i(i){if(i.success){var t=i.result.bankCode,r=i.result.bankName,n=i.result.cardType;if(1==n&&$("#quickDebit_"+t).val()||2==n&&$("#quickCredit_"+t).val())$("#cardVerifyShort").val(a+"-"+t+"-"+r+"-"+n),payBankcard.cardVerifySuccess(e);else if(1==e){var d=1==n?"\u50a8\u84c4\u5361":"\u4fe1\u7528\u5361";$("#font-red-cardError").html(Constants.unSupportCardType+d),$(".j_bankIdentific").find(".ui-button").addClass("disable"),$("#bi-i-result-bank").show().html(r);var o=$("#ordeTypeHide").val();"84"!=o&&"85"!=o&&$("#noCardReadminSpan").html("\u6682\u4e0d\u652f\u6301\u8be5\u884c"+d+"\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528<a href='javascript:void(0);' target='_blank' onclick='unionPaySubmit();'>\u94f6\u8054\u5728\u7ebf</a>\u652f\u4ed8")}}else 1==e?($("#bi-i-text-cardNo").addClass("ui-input-error"),$(".j_bankIdentific .bi-i-result").hide(),$(".j_bankIdentific").find(".ui-button").addClass("disable")):($("#font-red-cardNo").html(Constants.cardCheckError),$("#ui-input-cardNo").addClass("ui-input-error"),$("#input-cardNo-verify").val("false"),$("#noCardReadminSpan").html(""))}var a=quickConfirm.cardNoTrim(1==e?$("#bi-i-text-cardNo").val():$("#ui-input-cardNo").val()),t={cardNo:a},r=globalVar.contextPath+"/quick/verifyCardBin.action";$.post(r,t,i,"json")},verifyBankCodeBinConfirm:function(){function e(e){if(e.success){var i=e.result.bankCode,a=e.result.bankName,t=0;$("#debit-radio").addClass("ui-check-disable"),$("#credit-radio").addClass("ui-check-disable"),$("#quickCredit_"+i).val()&&(t=2,$("#credit-radio").removeClass("ui-check-disable")),$("#quickDebit_"+i).val()&&(t=1,$("#debit-radio").removeClass("ui-check-disable")),0!=t?($("#cardVerifyShort").val("-"+i+"-"+a+"-"+t),payBankcard.cardVerifySuccess(1)):($("#font-red-cardError").html(Constants.unSupportCardType),$(".j_bankIdentific").find(".ui-button").addClass("disable"),$("#bi-i-result-bank").show().html(a),$("#noCardReadminSpan").html(""))}else $("#bi-i-text-cardNo").val().length>=3&&($("#font-red-cardError").html(Constants.cardCheckError),$(".j_bankIdentific .bi-i-result").hide(),$(".j_bankIdentific").find(".ui-button").addClass("disable"),$("#noCardReadminSpan").html(""))}var i,a,t=quickConfirm.cardNoTrim($("#bi-i-text-cardNo").val());if(quickValidate.bankCodeVerifyRule.test(t))i=t.toUpperCase();else{if(!quickValidate.bankNameVerifyRule.test(t))return;a=t}var r={bankCode:i,bankName:a},n="/quick/verifyBankCodeBin.action";$.post(n,r,e,"json")},unboundGetVerifyCode:function(){function e(e){if(3==e.result.txnStatus){var i={asyncTxnSequenceId:e.result.asyncTxnSequenceId,paySign:h,queryType:1,quickPayType:1,bankCode:s,payAgencyCode:e.result.payAgencyCode};asyncWait.count=0,asyncWait.setTimer(i,0)}else $("#submitPayError").html(e.result.messageText),submitButton.enable()}try{if(!quickValidate.unboundGetVerifyCodeValidate())return void submitButton.enable();$("#submitPayError").html("");var i=quickConfirm.cardNoTrim($("#ui-input-cardNo").val()),a=$("#ui-input-holderName").val(),t=$("#ui-input-holderId").val(),r=$("#ui-select-month").find("option:selected").text(),n=$("#ui-select-year").find("option:selected").text().substr(2,4),d=n+r,o=$("#ui-input-cvv2").val(),u=$("#ui-input-phone").val(),l=$("#debit-radio").children("i").attr("id").split("cardType-")[1];1==l&&(o="");var s=$("#bank-selected-quickpay").children(".bank-logo").attr("id").split("-")[1].toUpperCase(),c=quickConfirm.getAgencyCode(l,s),p=$("#remainShouldPayAmount").val(),h=$("#paySign").val(),m={cardNo:i,holderName:a,holderId:t,validDate:d,cvv2:o,phone:u,cardType:l,bankCode:s,agencyCode:c,amount:p,paySign:h,quickPayType:"1"},v=globalVar.contextPath+"/quick/asyncGetVerifyCode.action";$.post(v,m,e,"json")}catch(y){$("#submitPayError").html("\u60a8\u7684\u7f51\u7edc\u597d\u50cf\u4e0d\u7ed9\u529b\u54df\uff01\u8bf7\u5c1d\u8bd5\u5237\u65b0\u540e\u83b7\u53d6\u77ed\u4fe1^_^"),$("#submitPayError").fadeOut(5e3,function(){$("#submitPayError").html("").show()});var h=$("#paySign").val(),m={quickType:"\u4e00\u6b21\u77ed\u4fe1",paySign:h,exception:y.name+":"+y.message},v="/quick/jsErrorCatch.action";$.post(v,m,"json")}},boundGetVerifyCode:function(){function e(e){if(3==e.result.txnStatus){var i={asyncTxnSequenceId:e.result.asyncTxnSequenceId,paySign:o,queryType:1,quickPayType:2,bankCode:r,payAgencyCode:e.result.payAgencyCode};asyncWait.count=0,asyncWait.setTimer(i,0)}else $("#submitPayError").html(20568==e.result.messageCode?"\u60a8\u7684\u4fe1\u7528\u5361\u5df2\u8fc7\u671f\uff0c\u8bf7<a href='javascript:;' onclick='payBankcard.reBind()'>\u91cd\u65b0\u7ed1\u5b9a</a>":e.result.messageText),submitButton.enable()}try{if(!quickValidate.boundGetVerifyCodeValidate())return void submitButton.enable();$("#submitPayError").html("");var i=$("#pv-input-cvv2").val();1==$("#payCard-cardType-bound").val()&&(i="");var a=$("input[name='payCard-cardId']").val(),t=$("input[name='payCard-agencyCode']").val(),r=$("#ub-item-firstBank").children(".bank-logo").attr("id").split("-")[1].toUpperCase(),n=$("#ub-item-firstBank").children("input[name='payCard-cardType']").attr("value"),d=$("#remainShouldPayAmount").val(),o=$("#paySign").val(),u={cvv2:i,cardId:a,agencyCode:t,amount:d,paySign:o,quickPayType:"2",bankCode:r,cardType:n},l=globalVar.contextPath+"/quick/asyncGetVerifyCode.action";$.post(l,u,e,"json")}catch(s){$("#submitPayError").html("\u60a8\u7684\u7f51\u7edc\u597d\u50cf\u4e0d\u7ed9\u529b\u54df\uff01\u8bf7\u5c1d\u8bd5\u5237\u65b0\u540e\u83b7\u53d6\u77ed\u4fe1^_^"),$("#submitPayError").fadeOut(5e3,function(){$("#submitPayError").html("").show("")});var o=$("#paySign").val(),u={quickType:"\u4e8c\u6b21\u77ed\u4fe1",paySign:o,exception:s.name+":"+s.message},l="/quick/jsErrorCatch.action";$.post(l,u,"json")}},quickpayConfirm:function(){0==globalVar.quickBoundPayFlag?quickConfirm.unboundQuickpayConfirm():quickConfirm.boundQuickpayConfirm()},unboundQuickpayConfirm:function(){try{if(!quickValidate.unboundQuickpayConfirmValidate())return;var e=quickConfirm.cardNoTrim($("#ui-input-cardNo").val()),i=$("#ui-input-holderName").val(),a=$("#ui-input-holderId").val(),t=$("#ui-select-month").find("option:selected").text(),r=$("#ui-select-year").find("option:selected").text().substr(2,4),n=r+t,d=$("#ui-input-cvv2").val(),o=$("#ui-input-phone").val(),u=$("#ui-input-unboundPhoneVerifyCode").val(),l=$("#debit-radio").children("i").attr("id").split("cardType-")[1];1==l&&(d="");var s,c,p=$("#bank-selected-quickpay").children(".bank-logo").attr("id").split("-")[1].toUpperCase(),h=$("#payAgencyCode").val(),m=$("#quickpayToken").val(),v=$("#remainShouldPayAmount").val(),y=$("#paySign").val();1==$("#virtualPayBlankNote").attr("checked")&&(s=$("#fenQiPlanHidden").val(),c=$("#baiTiaoRepayDateHide").val());var f={cardNo:e,holderName:i,holderId:a,validDate:n,cvv2:d,phone:o,phoneVerifyCode:u,cardType:l,bankCode:p,agencyCode:h,token:m,amount:v,paySign:y,fenQiPlanHidden:s,baiTiaoRepayDateHide:c,quickPayType:"1"},b=globalVar.contextPath+"/quick/asyncQuickpayConfirm.action",C=function(e){if(3==e.result.txnStatus){var i={asyncTxnSequenceId:e.result.asyncTxnSequenceId,paySign:y,fenQiPlanHidden:s,baiTiaoRepayDateHide:c,queryType:2,quickPayType:1,bankCode:p,payAgencyCode:h};asyncWait.count=0,asyncWait.setTimer(i,0)}else 1==e.result.txnStatus?($("#submitPayError").html(""),window.location.href=e.result.resultUrl):isCheckedVirtualPay()?(buildVirtualPayList("",e.result.messageText),paymentUI.showModal("#virtualResultDiv",function(){}),submitButton.enable()):1==e.result.showError?($("#submitPayError").html(e.result.messageText),submitButton.enable()):2==e.result.showError&&(window.location.href=e.result.resultUrl)};$.post(b,f,C,"json")}catch(k){$("#submitPayError").html("\u60a8\u7684\u7f51\u7edc\u597d\u50cf\u4e0d\u7ed9\u529b\u54df\uff01\u8bf7\u5c1d\u8bd5\u5237\u65b0\u540e\u70b9\u51fb\u652f\u4ed8^_^"),$("#submitPayError").fadeOut(5e3,function(){$("#submitPayError").html("").show("")});var y=$("#paySign").val(),f={quickType:"\u4e00\u6b21\u652f\u4ed8",paySign:y,exception:k.name+":"+k.message},b="/quick/jsErrorCatch.action";$.post(b,f,"json")}},boundQuickpayConfirm:function(){function e(e){if(3==e.result.txnStatus){var i={asyncTxnSequenceId:e.result.asyncTxnSequenceId,paySign:l,fenQiPlanHidden:a,baiTiaoRepayDateHide:t,queryType:2,quickPayType:2,payAgencyCode:d,bankCode:s,cardId:n};asyncWait.count=0,asyncWait.setTimer(i,1)}else 1==e.result.txnStatus?($("#submitPayError").html(""),window.location.href=e.result.resultUrl):isCheckedVirtualPay()?(buildVirtualPayList("",e.result.messageText),paymentUI.showModal("#virtualResultDiv",function(){}),submitButton.enable()):1==e.result.showError?(modalAuth.hideLoading(),modalAuth.showError(),$("#messageError").html(e.result.messageText),submitButton.enable()):2==e.result.showError&&(window.location.href=e.result.resultUrl)}try{if(!quickValidate.boundQuickpayConfirmValidate())return;var i=$("#pv-input-cvv2").val();1==$("#payCard-cardType-bound").val()&&(i="");var a,t,r=$("#ui-input-boundPhoneVerifyCode").val(),n=$("input[name='payCard-cardId']").val(),d=$("#payAgencyCode").val(),o=$("#quickpayToken").val(),u=$("#remainShouldPayAmount").val(),l=$("#paySign").val(),s=$("#ub-item-firstBank").children(".bank-logo").attr("id").split("-")[1].toUpperCase();1==$("#virtualPayBlankNote").attr("checked")&&(a=$("#fenQiPlanHidden").val(),t=$("#baiTiaoRepayDateHide").val());var c={cvv2:i,phoneVerifyCode:r,cardId:n,agencyCode:d,token:o,amount:u,paySign:l,fenQiPlanHidden:a,baiTiaoRepayDateHide:t,bankCode:s,quickPayType:"2"},p=globalVar.contextPath+"/quick/asyncQuickpayConfirm.action";$.post(p,c,e,"json")}catch(h){$("#submitPayError").html("\u60a8\u7684\u7f51\u7edc\u597d\u50cf\u4e0d\u7ed9\u529b\u54df\uff01\u8bf7\u5c1d\u8bd5\u5237\u65b0\u540e\u70b9\u51fb\u652f\u4ed8^_^"),$("#submitPayError").fadeOut(5e3,function(){$("#submitPayError").html("").show("")});var l=$("#paySign").val(),c={quickType:"\u4e8c\u6b21\u652f\u4ed8",paySign:l,exception:h.name+":"+h.message},p="/quick/jsErrorCatch.action";$.post(p,c,"json")}},getAgencyCode:function(cardType,bankCode){if(1==cardType){var quickDebit=$("#quickDebit_"+bankCode).val(),quickDebitJson=eval("("+quickDebit+")");agencyCode=quickDebitJson.agencyCode}else{var quickCredit=$("#quickCredit_"+bankCode).val(),quickCreditJson=eval("("+quickCredit+")");agencyCode=quickCreditJson.agencyCode}return agencyCode},cardNoTrim:function(e){var i=e.replace(/(^\s+)|(\s+$)/g,"");return i.replace(/\s/g,"")},setCountdown:function(e){var i;return i=$(1==e?"#ui-button-gray-unboundPhoneVerifyCode":"#ui-button-gray-boundPhoneVerifyCode"),i.hasClass("disable")?!0:(i.html('<em class="j_authCountdown">60</em> '+Constants.phoneCodeSending),i.addClass("disable"),paymentUI.setAuthCountdown(".j_authCountdown",60,function(){i.html(Constants.phoneCodeResend),i.removeClass("disable")}),!1)},resetCountdown:function(){var e;e=$(0==globalVar.quickBoundPayFlag?"#ui-button-gray-unboundPhoneVerifyCode":"#ui-button-gray-boundPhoneVerifyCode"),e.html(Constants.phoneCodeResend),e.removeClass("disable")}},quickValidate={cardNoRule:/^[0-9]*$/,cvv2Rule:/^[0-9]*$/,holderNameRule:/^[a-zA-Z]+([\s]?[a-zA-Z]+)*$|^[\u4e00-\u9fa5]+([\xb7]?[\u4e00-\u9fa5]+)*$/,phoneRule:/^[0-9]*$/,phoneVerifyCodeRule:/^[A-Za-z0-9]*$/,bankCodeVerifyRule:/^[A-Za-z]*$/,bankNameVerifyRule:/^[\u4e00-\u9fa5]+([\xb7]?[\u4e00-\u9fa5]+)*$/,keyCode:[8,35,36,37,39,46],unboundGetVerifyCodeValidate:function(){if(!quickValidate.cardNoValidate())return!1;if(!quickValidate.holderNameValidate())return!1;if(!quickValidate.holderIdValidate())return!1;var e=$("#debit-radio").children("i").attr("id").split("cardType-")[1];if(2==e){if(!quickValidate.validDateValidate())return!1;if(!quickValidate.cvv2Validate())return!1}return quickValidate.phoneValidate()?!0:!1},boundGetVerifyCodeValidate:function(){var e=$("#debit-radio").children("i").attr("id").split("cardType-")[1];return 2==e?quickValidate.cvv2Validate():!0},quickpayConfirmValidate:function(){return 0==globalVar.quickBoundPayFlag?quickValidate.unboundQuickpayConfirmValidate():quickValidate.boundQuickpayConfirmValidate()},unboundQuickpayConfirmValidate:function(){return quickValidate.unboundGetVerifyCodeValidate()&&quickValidate.phoneVerifyCodeValidate()?!0:!1},boundQuickpayConfirmValidate:function(){return quickValidate.boundGetVerifyCodeValidate()&&quickValidate.phoneVerifyCodeValidate()?!0:!1},cardNoValidate:function(){var e=quickConfirm.cardNoTrim($("#ui-input-cardNo").val());if(""==e)return $("#font-red-cardNo").html(Constants.inputCardNo),$("#ui-input-cardNo").addClass("ui-input-error"),!1;if(!quickValidate.cardNoRule.test(e))return $("#font-red-cardNo").html(Constants.cardNoFormatError),$("#ui-input-cardNo").addClass("ui-input-error"),!1;$("#debit-radio").children("i").attr("id").split("cardType-")[1];return e.length<12?($("#font-red-cardNo").html(Constants.CardNoLengthLess),$("#ui-input-cardNo").addClass("ui-input-error"),!1):(e==$("#cardVerifyShort").val().split("-")[0]?payBankcard.cardVerifySuccess(2):quickConfirm.verifyCardBinConfirm(2),$("#font-red-cardNo").html(""),$("#ui-input-cardNo").removeClass("ui-input-error"),!0)},validDateValidate:function(){return quickValidate.monthsValidate()&&quickValidate.yearsValidate()?($("#font-red-validity").html(""),!0):!1},monthsValidate:function(){return""==$("#ui-select-month").find("option:selected").text()||"\u9009\u62e9"==$("#ui-select-month").find("option:selected").text()?($("#font-red-validity").html(Constants.selectMonth),$("#ui-select-month").addClass("ui-input-error"),!1):($("#ui-select-month").removeClass("ui-input-error"),!0)},yearsValidate:function(){return""==$("#ui-select-year").find("option:selected").text()||"\u9009\u62e9"==$("#ui-select-year").find("option:selected").text()?($("#font-red-validity").html(Constants.selectYear),$("#ui-select-year").addClass("ui-input-error"),!1):($("#ui-select-year").removeClass("ui-input-error"),!0)},cvv2Validate:function(){if(0==globalVar.quickBoundPayFlag){var e=$("#ui-input-cvv2").val();if(""==e)return $("#font-red-cvv2").html(Constants.inputCVV2),$("#ui-input-cvv2").addClass("ui-input-error"),!1;if(!quickValidate.cvv2Rule.test(e))return $("#font-red-cvv2").html(Constants.CVV2FormatError),$("#ui-input-cvv2").addClass("ui-input-error"),!1;if(3!=e.length)return $("#font-red-cvv2").html(Constants.CVV2LengthLess),$("#ui-input-cvv2").addClass("ui-input-error"),!1;$("#font-red-cvv2").html(""),$("#ui-input-cvv2").removeClass("ui-input-error")}else{var e=$("#pv-input-cvv2").val();if(""==e)return $("#font-red-cvv2-bound").html(Constants.inputCVV2),$("#pv-input-cvv2").addClass("ui-input-error"),!1;if(!quickValidate.cvv2Rule.test(e))return $("#font-red-cvv2-bound").html(Constants.CVV2FormatError),$("#pv-input-cvv2").addClass("ui-input-error"),!1;if(3!=e.length)return $("#font-red-cvv2-bound").html(Constants.CVV2LengthLess),$("#pv-input-cvv2").addClass("ui-input-error"),!1;$("#pv-input-cvv2").removeClass("ui-input-error"),$("#font-red-cvv2-bound").html("")}return!0},holderNameValidate:function(){var e=$("#ui-input-holderName").val();return""==e?($("#font-red-holderName").html(Constants.inputHolderName),$("#ui-input-holderName").addClass("ui-input-error"),!1):($("#ui-input-holderName").removeClass("ui-input-error"),$("#font-red-holderName").html(""),!0)},holderIdValidate:function(){var e=$("#ui-input-holderId").val();return""==e?($("#font-red-holderId").html(Constants.inputHolderId),$("#ui-input-holderId").addClass("ui-input-error"),!1):quickValidate.validateHolderId(e)?($("#ui-input-holderId").removeClass("ui-input-error"),$("#font-red-holderId").html(""),!0):($("#font-red-holderId").html(Constants.holderIdError),$("#ui-input-holderId").addClass("ui-input-error"),!1)},phoneValidate:function(){var e=$("#ui-input-phone").val();return""==e?($("#font-red-phone").html(Constants.inputPhone),$("#ui-input-phone").addClass("ui-input-error"),!1):quickValidate.phoneRule.test(e)?11!=e.length?($("#font-red-phone").html(Constants.phoneLengthLess),$("#ui-input-phone").addClass("ui-input-error"),!1):($("#ui-input-phone").removeClass("ui-input-error"),$("#font-red-phone").html(""),!0):($("#font-red-phone").html(Constants.phoneFormatError),$("#ui-input-phone").addClass("ui-input-error"),!1)},phoneVerifyCodeValidate:function(){if(0==globalVar.quickBoundPayFlag){var e=$("#ui-input-unboundPhoneVerifyCode").val();if(""==e)return $("#font-red-verifyCode").html(Constants.inputVerifyCode),$("#ui-input-unboundPhoneVerifyCode").addClass("ui-input-error"),!1;if(!quickValidate.phoneVerifyCodeRule.test(e))return $("#font-red-verifyCode").html(Constants.verifyCodeFormatError),$("#ui-input-unboundPhoneVerifyCode").addClass("ui-input-error"),!1;if(6!=e.length)return $("#font-red-verifyCode").html(Constants.verifyCodeLengthLess),$("#ui-input-unboundPhoneVerifyCode").addClass("ui-input-error"),!1;$("#ui-input-unboundPhoneVerifyCode").removeClass("ui-input-error"),$("#font-red-verifyCode").html("")
}else{var e=$("#ui-input-boundPhoneVerifyCode").val();if(""==e)return $("#font-red-verifyCode-bound").html(Constants.inputVerifyCode),$("#ui-input-boundPhoneVerifyCode").addClass("ui-input-error"),!1;if(!quickValidate.phoneVerifyCodeRule.test(e))return $("#font-red-verifyCode-bound").html(Constants.verifyCodeFormatError),$("#ui-input-boundPhoneVerifyCode").addClass("ui-input-error"),!1;if(6!=e.length)return $("#font-red-verifyCode-bound").html(Constants.verifyCodeLengthLess),$("#ui-input-boundPhoneVerifyCode").addClass("ui-input-error"),!1;$("#ui-input-boundPhoneVerifyCode").removeClass("ui-input-error"),$("#font-red-verifyCode-bound").html("")}return!0},validateHolderId:function(e){if(15==e.length)return!0;if("X"==e.substring(e.length-1,e.length)){var i=/^(\d{6})(19|20)?(\d{2})([01]\d)([0123]\d)(\d{3})(\d|X)?$/;return i.test(e)}if(!/^\d{17}(\d|x)$/i.test(e))return!1;var a=0,t=e.substr(6,4)+"-"+Number(e.substr(10,2))+"-"+Number(e.substr(12,2)),r=new Date(t.replace(/-/g,"/"));if(t!=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate())return!1;for(var n=17;n>=0;n--)a+=Math.pow(2,n)%11*parseInt(e.charAt(17-n),11);return a%11!=1?!1:!0}};$("#p-k-check-payCard").live("click",function(){if($("#ui-checkbox-L-payCard").find("em").hasClass("selected"))if(1==globalVar.quickBoundUserFlag){var e=$("input[name='payCard-cardType']").val();e&&2==e&&($("#pv-line-cvv2").show(),$("#pay-verify-typeCredit").addClass("type-credit"))}else $(".j_bankArea").slideDown(300);else 1==globalVar.quickBoundUserFlag&&($("#pv-line-cvv2").hide(),$("#pay-verify-typeCredit").removeClass("type-credit"),$("#boundPhoneVerifyCode").val(""),$("#submitPayError").html(""),$("#paySubmit").val("\u7acb\u5373\u652f\u4ed8"),$(".j_returnBankUsed").hide(),$(".j_bankUsed").show()),$(".j_bankArea").slideUp(300),payBankcard.emptyErrorTips()}),$("#bi-i-text-cardNo").live("keyup",function(){if(quickValidate.bankCodeVerifyRule.test($(this).val())||quickValidate.bankNameVerifyRule.test($(this).val()))return $("#bi-i-text-cardNo").val($(this).val().toUpperCase()),void quickConfirm.verifyBankCodeBinConfirm();var e=quickConfirm.cardNoTrim($(this).val());e.length>13&&(e==$("#cardVerifyShort").val().split("-")[0]?payBankcard.cardVerifySuccess(1):quickConfirm.verifyCardBinConfirm(1))}).live("focus",function(){payBankcard.setInputFocus(),$("#font-red-cardError").html(""),$("#bi-i-text-cardNo").removeClass("ui-input-error"),$("#noCardReadminSpan").html("")}).live("blur",function(){quickValidate.bankCodeVerifyRule.test($(this).val())||quickConfirm.verifyCardBinConfirm(1),""==$("#bi-i-text-cardNo").val()&&payBankcard.setInputBlur(),$("#bi-i-text-cardNo").hasClass("ui-input-error")&&($("#font-red-cardError").html(Constants.cardCheckError),$("#noCardReadminSpan").html(""))}),$("#debit-radio").live("click",function(){if(!$(this).hasClass("ui-check-disable")&&!$(this).children().find("em").hasClass("selected")){var e=$("#bank-selected-quickpay .bank-logo").attr("id").split("-")[1];payBankcard.amountLimit(e,1,"unbound"),payBankcard.changeCardType(1),payBankcard.ableEditor(),payBankcard.emptyErrorTips()}}),$("#credit-radio").live("click",function(){if(!$(this).hasClass("ui-check-disable")&&!$(this).children().find("em").hasClass("selected")){var e=$("#bank-selected-quickpay .bank-logo").attr("id").split("-")[1];payBankcard.amountLimit(e,2,"unbound"),payBankcard.changeCardType(2),payBankcard.ableEditor(),payBankcard.emptyErrorTips()}}),$("#ui-input-cardNo").live("focus",function(){$("#font-red-cardNo").html(""),$("#ui-input-cardNo").removeClass("ui-input-error")}).live("blur",function(){quickValidate.cardNoValidate()}),$("#ui-select-month").live("focus",function(){$(".j_quickBankEdit").addClass("type-credit-month"),$("#ui-select-month").removeClass("ui-input-error"),$("#font-red-validity").html("")}).live("blur",function(){$(".j_quickBankEdit").removeClass("type-credit-month"),quickValidate.validDateValidate()}),$("#ui-select-year").live("focus",function(){$(".j_quickBankEdit").addClass("type-credit-year"),$("#ui-select-year").removeClass("ui-input-error"),$("#font-red-validity").html("")}).live("blur",function(){$(".j_quickBankEdit").removeClass("type-credit-year"),quickValidate.validDateValidate()}),$("#ui-input-cvv2").live("focus",function(){$(".j_quickBankEdit").addClass("type-credit-code"),$("#font-red-cvv2").html(""),$("#ui-input-cvv2").removeClass("ui-input-error")}).live("blur",function(){$(".j_quickBankEdit").removeClass("type-credit-code"),quickValidate.cvv2Validate()}),$("#pv-input-cvv2").live("focus",function(){$("#pay-verify-typeCredit").addClass("type-credit-verify-code"),$("#pv-input-cvv2").removeClass("ui-input-error"),$("#font-red-cvv2-bound").html("")}).live("blur",function(){$("#pay-verify-typeCredit").removeClass("type-credit-verify-code"),quickValidate.cvv2Validate()}),$("#ui-input-holderName").live("focus",function(){$("#ui-input-holderName").removeClass("ui-input-error"),$("#font-red-holderName").html("")}).live("blur",function(){quickValidate.holderNameValidate()}),$("#ui-input-holderId").live("focus",function(){$("#ui-input-holderId").removeClass("ui-input-error"),$("#font-red-holderId").html("")}).live("blur",function(){$(this).val($(this).val().toUpperCase()),quickValidate.holderIdValidate()}),$("#ui-input-phone").live("focus",function(){$("#ui-input-phone").removeClass("ui-input-error"),$("#font-red-phone").html("")}).live("blur",function(){quickValidate.phoneValidate()}),$("#ui-input-unboundPhoneVerifyCode").live("focus",function(){$("#ui-input-unboundPhoneVerifyCode").removeClass("ui-input-error"),$("#font-red-verifyCode").html("")}).live("blur",function(){quickValidate.phoneVerifyCodeValidate()}),$("#ui-input-boundPhoneVerifyCode").live("focus",function(){$("#ui-input-boundPhoneVerifyCode").removeClass("ui-input-error"),$("#font-red-verifyCode-bound").html("")}).live("blur",function(){quickValidate.phoneVerifyCodeValidate()}),$("#errorReBind").live("click",function(){$(this).attr("style","display:none")}),asyncWait={queryURL:globalVar.contextPath+"/quick/asyncQueryTxnStatus.action",timeArray:[1e3,3e3,6e3,8e3,1e4,12e3],count:0,queryRequest:function(e,i){$.post(this.queryURL,e,function(a){if(3==a.result.txnStatus)asyncWait.setTimer(e,i);else if(1==a.result.txnStatus)if(1==e.queryType){if(1==e.quickPayType){$("#submitPayError").html(Constants.phoneSendSuccess),payBankcard.unableEditor(),modalAuth.show(),modalAuth.showError();var t=$("#unEditor-phone").html();""!=t&&t.length>7&&(t=t.substring(0,t.length-t.substring(3).length)+"****"+t.substring(7)),$("#m15_openBindPhone").html("\uff08\u5df2\u53d1\u9001\u81f3"+t+")");var r=$("#cardPayAmountStrong").html();$("#cardPaySum").html("\u652f\u4ed8&nbsp;"+r+"\u5143"),$("#messageError").html(Constants.phoneSendSuccess)}else{modalAuth.show(),modalAuth.showError();var r=$("#cardPayAmountStrong").html();$("#cardPaySum").html("\u652f\u4ed8&nbsp;"+r+"\u5143"),$("#messageError").html(Constants.phoneSendSuccess)}$("#quickpayToken").attr("value",a.result.token),$("#asyncTxnSequenceId").attr("value",a.result.asyncTxnSequenceId),$("#payAgencyCode").attr("value",e.payAgencyCode)}else 2==e.queryType&&($("#submitPayError").html(""),window.location.href=a.result.resultUrl);else 1==e.queryType?($("#submitPayError").html(a.result.messageText),submitButton.enable(),modalAuth.hideLoading(),modalAuth.showError(),$("#messageError").html(a.result.messageText),1==a.result.errorReBind&&$("#errorReBind").attr("style",""),_jaq.track("SMS_"+a.result.code)):2==e.queryType&&(isCheckedVirtualPay()?(buildVirtualPayList("",a.result.messageText),paymentUI.showModal("#virtualResultDiv",function(){}),submitButton.enable(),$("#submitPayError").html(a.result.messageText),modalAuth.hide(),_jaq.track("PAY_"+a.result.code)):1==a.result.showError?($("#submitPayError").html(a.result.messageText),modalAuth.hideLoading(),modalAuth.showError(),$("#messageError").html(a.result.messageText),submitButton.enable(),_jaq.track("PAY_"+a.result.code)):2==a.result.showError&&(window.location.href=a.result.resultUrl))},"json")},setTimer:function(e,i){this.count<this.timeArray.length&&setTimeout(function(){asyncWait.queryRequest(e,i)},this.timeArray[this.count]),this.count++}},$(function(){$("body").click(function(e){for(var i=e.srcElement||e.target,a=[$(".list-box").filter(":not(.un-list-box)").get(0)];i;){for(var t=0;t<a.length;t++)if(i==a[t])return void $(".list-box dl dd").show();if(i===document.body)return void $(".list-box dl dd").hide();i=i.parentNode}}),$(".list-box dl dd a").click(function(e){e.stopPropagation();var i=$(this).clone().html();$(this).parent().find("a").removeClass("curr").end().prev().html(i),$(this).addClass("curr").parent().hide()}),$(".pay-fenqi .jdcheckbox").click(function(){var e=($(this).val(),$(this).parent().find(".list-box"));$(this).attr("checked")?e.removeClass("un-list-box"):e.addClass("un-list-box")})}),$(function(){$.fn.cardNoSplitter=function(e){var i={min:13,max:25,delimiter:" ",delimiterNumber:4,onlyNumber:!0,copy:!0},a=$.extend({},i,e),t=$(this);""!=t.val()&&"undefined"!=typeof t.val()&&t.val(t.val().replace(/\s/g,"").replace(/(\d{4})(?=\d)/g,"$1"+a.delimiter)),t.bind("keyup",function(e){return 13==e.keyCode||108==e.keyCode?void payBankcard.editedQuickBank():void(quickValidate.bankCodeVerifyRule.test(t.val())||quickValidate.bankNameVerifyRule.test(t.val())||$.inArray(e.keyCode,quickValidate.keyCode)>=0||(a.onlyNumber&&(e.keyCode>=48&&e.keyCode<=57||(this.value=this.value.replace(/\D/g,""))),this.value=this.value.replace(/\s/g,"").replace(/(\d{4})(?=\d)/g,"$1"+a.delimiter)))}).bind("dragenter",function(){return!1}).bind("onpaste",function(){return!clipboardData.getData("text").match(/\D/)}).bind("blur",function(){this.value=this.value.replace(/\s/g,"").replace(/(\d{4})(?=\d)/g,"$1"+a.delimiter)})}});
/* @update: 2015-5-28 17:30:30 */ 
function hideOtherPay(){$("#payOherCheckLi").find("em").removeClass("selected"),$("#payBalancePayboxDiv").removeClass("paybox-selected"),$("#otherPayListDiv").hide(),globalVar.payOtherIsChecked=!1}function isHideOtherPay(){"checked"!=$("#virtualPayJingBean").attr("checked")&&"checked"!=$("#virtualPayYue").attr("checked")&&hideOtherPay()}function jbToRmb(a){return null!=a&&"0"!=a&&""!=a?(a=Number(a),(a/100).toFixed(2)):0}function rmbToJb(a){return jingbean=Number(a),(100*jingbean).toFixed(0)}var xiaoJinKu={hide:function(){$("#xjkCheckBoxLi").find("em").removeClass("selected"),$("#virtualPayJrb").attr("checked",!1),$("#xjkPayAmountDiv").hide(),$("#xjkPayboxDiv").removeClass("paybox-selected"),$("#jrbCanPay").attr("name",""),reckonVirtual.backRemain("jr_jrb"),globalVar.xjkIsChecked=!1,xiaoJinKu.xjkManJianUnChecked()},show:function(){$("#xjkCheckBoxLi").find("em").addClass("selected"),$("#virtualPayJrb").attr("checked",!0),$("#xjkPayAmountDiv").show(),$("#xjkPayboxDiv").addClass("paybox-selected"),$("#jrbCanPay").attr("name","balance"),globalVar.xjkIsChecked=!0},xjkManJianUnChecked:function(){if(globalVar.xjkMjed&&document.getElementById("jrbActivityIdHide")&&document.getElementById("jrbDiscountMoneyHide")){var a=Number($("#remainShouldPayAmount").val())+Number($("#jrbDiscountMoneyHide").val());$("#remainShouldPayAmount").val(a.toFixed(2)),$("#remainShouldPayAmountSpan").html(a.toFixed(2)),$("#xjkActivityId").val(""),$("#xjkRewardAmount").val(""),globalVar.xjkMjed=!1}},xjkManJianChecked:function(){if(document.getElementById("jrbActivityIdHide")&&document.getElementById("jrbDiscountMoneyHide")&&$("#jrbCanPay").val()==$("#orderShouldPayHide").val()){var a=Number($("#jrbCanPay").val())-Number($("#jrbDiscountMoneyHide").val());$("#jrbCanPay").val(a.toFixed(2)),$("#xjkCanPayStrong").html(a.toFixed(2)),$("#xjkActivityId").val($("#jrbActivityIdHide").val()),$("#xjkRewardAmount").val($("#jrbDiscountMoneyHide").val()),globalVar.xjkMjed=!0}},checked:function(a,e){null!=a&&(globalVar.xjkIsChecked=a);var n=$("#jrbCanPay").val();1==globalVar.xjkIsChecked?(this.hide(),reckonVirtual.backBalanceTobaiTiao(n)):this.show(),(null==e||1==e)&&(reckonVirtual.virtualCanPay("jr_jrb"),xiaoJinKu.xjkManJianChecked()),virtualPayCheckedState(),checkUsedCardVaild()}},otherPay={hide:function(){$("#payOherCheckLi").find("em").removeClass("selected"),$("#payBalancePayboxDiv").removeClass("paybox-selected"),$("#otherPayListDiv").hide(),$("#otherPayAmountDiv").hide(),globalVar.payOtherIsChecked=!1},show:function(){$("#payOherCheckLi").find("em").addClass("selected"),$("#payBalancePayboxDiv").addClass("paybox-selected"),$("#otherPayListDiv").show(),$("#otherPayAmountDiv").show(),globalVar.payOtherIsChecked=!0},checked:function(a){reckonVirtual.virtualCanPay(),null!=a&&(globalVar.payOtherIsChecked=a),1==globalVar.payOtherIsChecked?this.hide():this.show(),yue.checked(globalVar.payOtherIsChecked?!1:!0);var e=$("#remainShouldPayAmount").val();("0"!=e&&"0.00"!=e||0==globalVar.yuEIsChecked)&&(1==globalVar.payOtherIsChecked?(jingBean.checked(!1),gangBeng.checked(!1),wyQianBao.checked(!1)):(jingBean.checked(!0),gangBeng.checked(!0),wyQianBao.checked(!0))),checkUsedCardVaild()}},yue={hide:function(){$("#yueCheckBoxLi").find("em").removeClass("selected"),$("#yueCanPaydiv").hide(),$("#virtualPayYue").attr("checked",!1),$("#yueCanPay").attr("name",""),reckonVirtual.backRemain("balance_com"),globalVar.yuEIsChecked=!1},show:function(){$("#yueCheckBoxLi").find("em").addClass("selected"),$("#yueCanPaydiv").show(),$("#virtualPayYue").attr("checked",!0),$("#yueCanPay").attr("name","balance"),globalVar.yuEIsChecked=!0},reckon:function(){reckonVirtual.virtualCanPay("balance_com")},checked:function(a,e){var n=$("#yueCanPay").val();null!=$("#yueBalanceHide").val()&&""!=$("#yueBalanceHide").val()&&(null!=a&&(globalVar.yuEIsChecked=a),1==globalVar.yuEIsChecked?(this.hide(),reckonVirtual.backBalanceTobaiTiao(n)):this.show(),(null==e||1==e)&&this.reckon()),virtualPayCheckedState()}},jingBean={hide:function(){$("#jingBeanCheckBoxLi").find("em").removeClass("selected"),$("#jingBeanCanPayDiv").hide(),$("#virtualPayJingBean").attr("checked",!1),$("#jingBeanCanPay").attr("name",""),reckonVirtual.backRemain("jingbean"),"checked"!=$("#virtualPayYue").attr("checked")&&"checked"!=$("#virtualPayJingBean").attr("checked")&&"checked"!=$("#virtualPayGangbeng").attr("checked")&&$("#virtualPayCountStrong").html("0.00"),globalVar.jingBeanIsChecked=!1},show:function(){$("#jingBeanCheckBoxLi").find("em").addClass("selected"),$("#jingBeanCanPayDiv").show(),$("#virtualPayJingBean").attr("checked",!0),$("#jingBeanCanPay").attr("name","balance"),globalVar.jingBeanIsChecked=!0},reckon:function(){reckonVirtual.virtualCanPay("jingbean")},checked:function(a,e){var n=$("#jingBeanCanPay").val();null!=$("#jingbeanBalanceHide").val()&&""!=$("#jingbeanBalanceHide").val()&&(null!=a&&(globalVar.jingBeanIsChecked=a),1==globalVar.jingBeanIsChecked?(this.hide(),reckonVirtual.backBalanceTobaiTiao(n)):this.show(),(null==e||1==e)&&this.reckon()),virtualPayCheckedState()}},gangBeng={hide:function(){$("#coinsCanPayDiv").hide(),$("#coinsCheckBoxLi").find("em").removeClass("selected"),$("#virtualPayGangbeng").attr("checked",!1),$("#gangbengCanPay").attr("name",""),globalVar.gangbengIsChecked=!1,reckonVirtual.backRemain("gangbeng")},show:function(){$("#coinsCanPayDiv").show(),$("#coinsCheckBoxLi").find("em").addClass("selected"),$("#virtualPayGangbeng").attr("checked",!0),$("#gangbengCanPay").attr("name","balance"),globalVar.gangbengIsChecked=!0},checked:function(a){var e=$("#gangbengCanPay").val();null!=$("#coinsBalanceHide").val()&&""!=$("#coinsBalanceHide").val()&&(null!=a&&(globalVar.gangbengIsChecked=a),1==globalVar.gangbengIsChecked?(this.hide(),reckonVirtual.backBalanceTobaiTiao(e)):this.show(),reckonVirtual.virtualCanPay("gangbeng"),virtualPayCheckedState())}},wyQianBao={hide:function(){$("#wyQianBaoCanPayDiv").hide(),$("#wyQianBaoCheckBoxLi").find("em").removeClass("selected"),$("#virtualPayWyQianBao").attr("checked",!1),$("#wyQianBaoCanPay").attr("name",""),globalVar.wyQianBaoChecked=!1,reckonVirtual.backRemain("wyQianBao")},show:function(){$("#wyQianBaoCanPayDiv").show(),$("#wyQianBaoCheckBoxLi").find("em").addClass("selected"),$("#virtualPayWyQianBao").attr("checked",!0),$("#wyQianBaoCanPay").attr("name","balance"),globalVar.wyQianBaoChecked=!0},checked:function(a){var e=$("#wyQianBaoCanPay").val();null!=$("#wyQianBaoBalanceHide").val()&&""!=$("#wyQianBaoBalanceHide").val()&&(null!=a&&(globalVar.wyQianBaoChecked=a),1==globalVar.wyQianBaoChecked?(this.hide(),reckonVirtual.backBalanceTobaiTiao(e)):this.show(),reckonVirtual.virtualCanPay("wyQianBao"),virtualPayCheckedState())}};
/* @update: 2015-5-28 17:30:30 */ 
function gradedPay(a){"1"==a?($("#onGradedPay").hide(),$("#gradedPayDiv").removeClass("hide"),$("#cancelGradedPay").show(),$("#shouldEbankPay").text($("#cardPayAmountStrong").text()),$("input[name='gradedPayInput']").val(""),$("input[name='gradedPayment']").val("1"),$("#shouldPayError").text("")):"0"==a&&($("#onGradedPay").show(),$("#gradedPayDiv").addClass("hide"),$("#cancelGradedPay").hide(),$("input[name='gradedPayInput']").val(""),$("#shouldEbankPay").text(""),$("input[name='gradedPayment']").val(""))}function virtualPayCheckedState(){var a=isCheckedVirtualPay();if(a)$("#onGradedPay").hide(),$("#gradedPayDiv").addClass("hide"),$("#cancelGradedPay").hide(),$("input[name='gradedPayment']").val("");else{var e=$("input[name='requestInfo']").val(),n=$("input[name='seletedAgencyCode']").val(),t=$("#cardPayAmountStrong").text();$.ajax({url:"gradedPay.action?agencyCode="+n+"&shouldPay="+t+"&paySign="+e,type:"get",dataType:"html",error:function(){},success:function(a){null!=a&&""!=a&&("YES"==a?($("#onGradedPay").show(),$("#gradedPayDiv").addClass("hide"),$("#cancelGradedPay").hide(),$("#shouldEbankPay").text($("#cardPayAmountStrong").text())):"NO"==a&&($("#onGradedPay").hide(),$("#gradedPayDiv").addClass("hide"),$("#cancelGradedPay").hide()))}})}}function exchangeOtherBankPay(a){$("#normalCardPay").val("normalCardPay"),$("#ebankPaymentListDiv").show(),$("#normalPayCardConfirmDiv").hide(),$("#ebankDiv").hide(),$("#gradedPayDiv").addClass("hide"),$("#ebank-cardtype").find("i").eq(0).addClass("selected"),$("input[name='gradedPayInput']").val(""),$("input[name='gradedPayment']").val(""),$("input[name='commonBankType']").val(""),$("input[name='bankCode']").val(""),$("input[name='agencyCode']").val(""),$("#confirmPayAmount").val(""),$("#shouldPaymentAmount").val(""),1==a?showTip.hide():showTip.show()}function validateAmount(){var a=$("input[name='gradedPayInput']"),e=$("#shouldPayError"),n=a.val();if(""!=n){{var t=$("#cardPayAmountStrong").text();parseFloat(t)-parseFloat(n)}return parttenNum.test(n)?parseFloat(n)>0&&parseFloat(n)<=50?(e.text("\u8ba2\u5355\u652f\u4ed8\u91d1\u989d\u5fc5\u987b\u5927\u4e8e50\u5143"),a.focus(),!1):parseFloat(n)<=0?(e.text("\u8ba2\u5355\u652f\u4ed8\u91d1\u989d\u5fc5\u987b\u5927\u4e8e0\u5143"),a.focus(),!1):parseFloat(n)>parseFloat(t)?(e.text("\u60a8\u8f93\u5165\u7684\u91d1\u989d\u8d85\u8fc7\u5269\u4f59\u5e94\u652f\u4ed8\u91d1\u989d"),a.focus(),!1):(e.text(""),!0):(e.text("\u60a8\u8f93\u5165\u7684\u91d1\u989d\u683c\u5f0f\u4e0d\u6b63\u786e"),a.focus(),!1)}return $("#shouldEbankPay").html($("#cardPayAmountStrong").text()),e.text(""),!1}function setValueBankPayment(a,e){$("input[name='bankCode']").val(a),$("input[name='agencyCode']").val(e),$("#submitPayError").text(""),$("#shouldPayError").text("");var n=$("#nordebit-radio").find("i").find("em").hasClass("selected"),t=$("#norcredit-radio").find("i").find("em").hasClass("selected");n?$("input[name='commonBankType']").val("1"):t&&$("input[name='commonBankType']").val("2")}function normalBankPaymentConfirm(){var a=$("#normalCardPay").val();if("normalCardPay"==a){var e=$("input[name='payCard-agencyCode']").val(),n=$("input[name='payCard-payChannelCode']").val();payBankcard.selectedEBank(e,n,"2"),submitNormalBankConfirm()}else submitNormalBankConfirm();submitButton.enable()}function submitNormalBankConfirm(){var a=$("input[name='bankCode']").val(),e=$("#cardPayAmountStrong").text();if(null==a||""==a)$("#submitPayError").text("\u8bf7\u9009\u62e9\u94f6\u884c\u652f\u4ed8"),$("#submitPayError").show();else if("0"==e||"0.00"==e)$("#submitPayError").text("\u94f6\u884c\u5361\u5e94\u4ed8\u91d1\u989d\u4e3a0\uff01"),$("#submitPayError").show();else{var n=$("input[name='gradedPayment']").val();"1"!=n||validateAmount()?($("input[name='shouldPaymentAmount']").val($("#cardPayAmountStrong").text()),$("input[name='confirmPaymentAmount']").val("1"==n?$("input[name='gradedPayInput']").val():$("#cardPayAmountStrong").text()),$("#paymentConfirm").submit(),wangyin.success()):($("#shouldPayError").text("\u672c\u6b21\u652f\u4ed8\u91d1\u989d\u8f93\u5165\u6709\u8bef\uff01"),$("#shouldPayError").show())}}function unionPaySubmit(){$("input[name='payCount']").val(""),$("input[name='agencyCode']").val("021"),$("input[name='bankCode']").val("unionpay"),$("input[name='commonBankType']").val("0");var a=$("input[name='to_type']").val();$("input[name='toType']").val(a),$("#paymentConfirm").submit(),wangyin.success()}$("#nordebit-radio").live("click",function(){$(this).hasClass("disable")||($("#nordebit-radio").children("i").find("em").addClass("selected"),$("#norcredit-radio").children("i").find("em").removeClass("selected"),$("input[name='commonBankType']").val("1"))}),$("#norcredit-radio").live("click",function(){$(this).hasClass("disable")||($("#norcredit-radio").children("i").find("em").addClass("selected"),$("#nordebit-radio").children("i").find("em").removeClass("selected"),$("input[name='commonBankType']").val("2"))});var parttenNum=/^(([1-9]{1}\d*)|([0]{1}))(\.(\d){1,2})?$/;
/* @update: 2015-5-28 17:30:30 */ 
function submitBankorPlatPay(n,a,t,e){confirmSubmitBankPlatPay(n,a,t,e)}function confirmSubmitBankPlatPay(n,a,t,e){"20"!=e&&$("input[name='payCount']").val(""),$("input[name='agencyCode']").val(n),$("input[name='bankCode']").val(a),$("input[name='commonBankType']").val(t),$("input[name='toType']").val(e),"weixin"==a&&(document.paymentConfirm.target="_self"),$("#paymentConfirm").submit(),"weixin"!=a&&wangyinOther.success()}function phoneValidate(n){if(""==n||null==n)return 1;if(""!=n){if(11!=n.length)return 2;if(!telphoneRule.test(n))return 3}return 0}function submitPostalAndEnterPay(n,a){confirmSubmitPostalAndEnterPay(n,a)}function confirmSubmitPostalAndEnterPay(n,a){var t="",e=0;if(0==e){var o=$("input[name='paySign']").val();$.ajax({url:"payHKSBM.action?paySign="+o+"&phone="+t+"&type="+a,type:"get",dataType:"html",error:function(){switch(a){case"0":$("#postalError").text(hksbmError),$("#postalError").show();break;case"1":$("#enterError").text(hksbmError),$("#enterError").show()}},success:function(t){if(null!=t&&""!=t){var e=t.split("||")[0],o=t.split("||")[1];if(null!=o&&""!=o){var i=/(\d{3})\d{4}(\d{4})/;o=o.replace(i,"$1****$2")}"0"==a||"2"==a?(postoffice.getPhoneCode(),$("#postalHksbm1").text(e),$("#postalHksbm2").text(e),$("input[name='postalPhone']").val(""),$("#postPhoneSpan").text(o)):(1==a||3==a)&&(enterprise.getPhoneCode(),$("#enterHksbm1").text(e),$("#enterHksbm2").text(e),$("#enterHksbm3").text(e),$("input[name='enterPhone']").val(""),$("#enterPhoneSpan").text(o)),null!=n&&($(n).hide(),$(n).siblings(".j_phoneCurrent").show(),$(n).siblings(".j_sendToPhone").show(),$(n).siblings(".j_phoneNew").hide(),$(n).siblings(".op-error").hide(),$(n).siblings(".op-error").text(""))}else switch(a){case"0":$("#postalError").text(hksbmError),$("#postalError").show();break;case"1":$("#enterError").text(hksbmError),$("#enterError").show()}}})}}function getInstallmentBank(){$("input[name='payCount']").val("3"),$("#payCount").val("3");var paySign=$("input[name='paySign']").val();$.ajax({url:"payInstallmentBank.action?paySign="+paySign,type:"get",dataType:"html",error:function(){},success:function(data){if(null!=data&&""!=data){var instalmentInfoObj=eval("("+data.split("||")[1]+")");$("#instalmentTotal").text(instalmentInfoObj.instalmentTotal),$("#amount").text(instalmentInfoObj.amount),$("#instalmentFee").text(instalmentInfoObj.instalmentFee),$("#repayAmount").text(instalmentInfoObj.repayAmount),$("#payCount").text(instalmentInfoObj.payCount);var bankList=data.split("||")[0];if(null!=bankList){var obj=eval("("+bankList+")"),bankListUI="";$("#installmentBankList").empty();for(var i=0;i<obj.length;i++){var bankCurr=obj[i],payChannelCode=bankCurr.payChannelCode.toLowerCase(),bankName=bankCurr.bankName.toLowerCase(),payAgencyCode=bankCurr.payAgencyCode,clstagBank="";"cmb"==payChannelCode?clstagBank="jr|keycount|cashier_jd|cashier_jd_zsyh":"cmbc"==payChannelCode?clstagBank="jr|keycount|cashier_jd|cashier_jd_msyh":"ceb"==payChannelCode&&(clstagBank="jr|keycount|cashier_jd|cashier_jd_gdyh"),0==i?(bankListUI=bankListUI+'<li class="pl-item selected" clstag="'+clstagBank+'"><span class="bank-logo" id="bank-'+payChannelCode+'">'+bankName+'</span><i class="pl-i-selected"></i><input type="hidden" value="'+payAgencyCode+'"/><input type="hidden" value="'+payChannelCode+'"/></li>',$("input[name='agencyCode']").val(payAgencyCode),$("input[name='bankCode']").val(payChannelCode)):bankListUI=bankListUI+'<li class="pl-item" clstag="'+clstagBank+'"><span class="bank-logo" id="bank-'+payChannelCode+'">'+bankName+'</span><i class="pl-i-selected"></i><input type="hidden" value="'+payAgencyCode+'"/><input type="hidden" value="'+payChannelCode+'"/></li>'}$("#installmentBankList").append(bankListUI),$("#installmentBankList li").click(function(){$(this).addClass("selected"),$(this).siblings().removeClass("selected"),$("input[name='agencyCode']").val($(this).find("input").first().val()),$("input[name='bankCode']").val($(this).find("input").last().val());var n=$("input[name='payCount']").val(),a=$("input[name='bankCode']").val();showInstallment(a,n)})}}}})}function showInstallment(bankCode,payCount){var paySign=$("input[name='paySign']").val();$.ajax({url:"payInstallmentAmount.action?paySign="+paySign+"&bankCode="+bankCode+"&payCount="+payCount,type:"get",dataType:"html",error:function(){},success:function(data){if(null!=data&&""!=data){var obj=eval("("+data+")"),instalmentTotal=obj.instalmentTotal,amount=obj.amount,instalmentFee=obj.instalmentFee,repayAmount=obj.repayAmount,payCount=obj.payCount;$("#instalmentTotal").text(instalmentTotal),$("#amount").text(amount),$("#instalmentFee").text(instalmentFee),$("#repayAmount").text(repayAmount),$("#payCount").text(payCount)}}})}function submitInstallmentBankPay(){var n=$("input[name='agencyCode']").val(),a=$("input[name='bankCode']").val();submitBankorPlatPay(n,a,"2","20")}function showPayDetail(){var infoJson=$("input[name='payResultDetailInfoJson']").val(),url="payDetailLazy.action?payResultDetailInfoJson="+infoJson;$.ajax({type:"GET",url:url,dataType:"html",cache:!1,success:function(data){if(null!=data&&""!=data){var obj=eval("("+data+")"),payDetailHtml=obj.payDetailHtml,amount=obj.amount,toPayUrl=obj.toPayUrl;$("#showPayDetailMsg").prepend(payDetailHtml),null!=payDetailHtml&&""!=payDetailHtml&&$("input[name='payResultDetailFlag']").val("1"),"0"==amount||"0.00"==amount?($("#goshoping").show(),$("#toPayContinue").hide(),$("#contineShoping").show()):($("#goshoping").hide(),$("#toPayContinue").show(),$("#toPayContinue").find("a").attr("href",toPayUrl))}else $("#toPayContinue").show(),$("#goshoping").hide(),$("#toPayContinue").find("a").attr("href","http://www.jd.com/"),$("#toPayContinue").find("a").text("\u7ee7\u7eed\u901b\u901b")}})}function submitAgentHksbmPay(){var n=$("input[name='paySign']").val();$.ajax({url:"payAgentHKSBM.action?paySign="+n,type:"get",dataType:"html",error:function(){$("#agentError").text(hksbmError),$("#agentError").show()},success:function(n){if(null!=n&&""!=n){var a=n.split("||")[0],t=n.split("||")[1];if(null!=t&&""!=t){var e=/(\d{3})\d{4}(\d{4})/;t=t.replace(e,"$1****$2")}$("#agentHksbm").text(a),$("#agentHksbm2").text(a),$("#agentHksbm3").text(a),$("#agentPhoneSpan").text(t),$("#agentGetPhoneCode").hide(),$("#agentSendPhoneCode").show()}else $("#agentError").text(hksbmError),$("#agentError").show()}})}var telphoneRule=/^[0-9]*$/,phoneIsNull="\u624b\u673a\u53f7\u4e0d\u80fd\u4e3a\u7a7a",phoneIsSmall="\u624b\u673a\u53f7\u5fc5\u987b\u4e3a11\u4f4d\u6570\u5b57",phoneFormatIsError="\u624b\u673a\u53f7\u683c\u5f0f\u4e0d\u6b63\u786e",hksbmError="\u83b7\u53d6\u8bc6\u522b\u7801\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5";$(".type-check li").click(function(){$(this).addClass("selected"),$(this).siblings().removeClass("selected");var n=$(this).find("input").val();$("input[name='payCount']").val(n);var a=$("input[name='bankCode']").val();showInstallment(a,n)}),$(document).ready(function(){var n=$("input[name='toType']").val();"10"==n?$("#plateFormTab").click():"20"==n?$("#installmentTab").click():"40"==n?$("#postalTab").click():"30"==n&&$("#transferTab").click()});var wangyinOther={success:function(){paymentUI.showModal("#wangyinPaySuccessOther",function(){})},error:function(){paymentUI.showModal("#wangyinPayError",function(){})}};